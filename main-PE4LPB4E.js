import{a as A}from"./chunk-7SKATKTI.js";import{h as v,j as h,k as u,m as C,o as f}from"./chunk-ZSGB5YWW.js";import{Ca as m,P as n,Wa as d,pb as g}from"./chunk-YUCVBBHU.js";import"./chunk-LJ5XHLMQ.js";import{h as a}from"./chunk-FK42CRUA.js";var G=()=>n(u),y=()=>n(A),l=()=>a(null,null,function*(){let t=G(),{data:e}=yield y().session();return console.log(!!e.session),e.session||t.navigate(["/auth/log-in"]),!!e.session}),w=()=>a(null,null,function*(){let t=G(),{data:e}=yield y().session();return console.log(!!e.session),e.session&&t.navigate(["/"]),!e.session});var b=(t,e)=>a(null,null,function*(){let o=n(f),r=n(u);try{let s=(yield o.getSession())?.user?.id;if(!s)return r.navigate(["/auth"]),!1;let c=yield o.getUserProfile(s);return c?c.role==="client"?!0:(r.navigate(["/internal"]),!1):(r.navigate(["/"]),!1)}catch(i){return console.error("Error en clientGuard:",i),r.navigate(["/auth"]),!1}}),x=(t,e)=>a(null,null,function*(){let o=n(f),r=n(u);try{let s=(yield o.getSession())?.user?.id;if(!s)return r.navigate(["/auth"]),!1;let c=yield o.getUserProfile(s);return c?["comercial","soporte_tecnico","logistica","admin"].includes(c.role)?!0:(r.navigate(["/client"]),!1):(r.navigate(["/"]),!1)}catch(i){return console.error("Error en internalGuard:",i),r.navigate(["/auth"]),!1}});var F=[{path:"auth",canActivate:[w],loadChildren:()=>import("./chunk-UJF5FWBS.js").then(t=>t.default)},{path:"client",canActivate:[l,b],loadChildren:()=>import("./chunk-HLIMCLHO.js").then(t=>t.default)},{path:"internal",canActivate:[l,x],loadChildren:()=>import("./chunk-JG7GCZ3F.js").then(t=>t.default)},{path:"",canActivate:[l],loadChildren:()=>import("./chunk-R3JSJIOY.js").then(t=>t.default)}];var S={providers:[g({eventCoalescing:!0}),C(F)]};var p=class t{title="smartTrack";static \u0275fac=function(o){return new(o||t)};static \u0275cmp=m({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(o,r){o&1&&d(0,"router-outlet")},dependencies:[h],encapsulation:2})};v(p,S).catch(t=>console.error(t));
