import{a as Q}from"./chunk-PVAB6UKC.js";import{c as L,e as O,f as j,j as F,n as $,p as H}from"./chunk-3OSVPALZ.js";import{$ as f,Ab as u,Bb as v,Cb as A,Ia as a,Nb as V,Ob as z,S as k,Sa as M,Xa as h,Y as w,Z as y,_ as g,cb as E,ib as p,la as b,lb as K,m as C,mb as T,nb as t,ob as e,pb as c,qb as P,tb as S,ub as s,zb as o}from"./chunk-MBDN4FSM.js";import"./chunk-X5YLR3NI.js";import{i as _}from"./chunk-ODN5LVDJ.js";var N=(r,n)=>n.id;function B(r,n){if(r&1&&(t(0,"p",33),o(1),e()),r&2){let i,l=s();a(),A(" ",(i=l.kit())==null?null:i.numero_kit," - ",(i=l.kit())==null||i.cirugia==null?null:i.cirugia.numero_cirugia," ")}}function U(r,n){r&1&&(t(0,"div",31)(1,"div",34)(2,"div",35)(3,"div",36),c(4,"div",37),e(),t(5,"p",38),o(6,"Cargando informaci\xF3n del kit..."),e()()()())}function q(r,n){if(r&1&&(t(0,"div",32)(1,"div",34)(2,"div",39)(3,"div",25),g(),t(4,"svg",40),c(5,"path",41),e(),f(),t(6,"p",42),o(7),e()()()()()),r&2){let i=s();a(7),u(i.error())}}function R(r,n){if(r&1&&(t(0,"div",49)(1,"h3",63),g(),t(2,"svg",64),c(3,"path",65),e(),o(4," Informaci\xF3n de la Cirug\xEDa "),e(),f(),t(5,"div",66)(6,"div")(7,"span",67),o(8,"Cliente:"),e(),t(9,"span",68),o(10),e()(),t(11,"div")(12,"span",67),o(13,"M\xE9dico:"),e(),t(14,"span",68),o(15),e()(),t(16,"div")(17,"span",67),o(18,"Fecha:"),e(),t(19,"span",68),o(20),e()(),t(21,"div")(22,"span",67),o(23,"Hospital:"),e(),t(24,"span",68),o(25),e()()()()),r&2){let i,l,d,x=s(2);a(10),u(x.getClienteNombre()),a(5),u((i=x.kit())==null||i.cirugia==null?null:i.cirugia.medico_cirujano),a(5),u(x.formatearFecha(((l=x.kit())==null||l.cirugia==null?null:l.cirugia.fecha_programada)||"")),a(5),u((d=x.kit())==null||d.cirugia==null||d.cirugia.hospital==null?null:d.cirugia.hospital.nombre)}}function J(r,n){if(r&1&&(t(0,"div",50)(1,"h4",69),o(2,"Observaciones:"),e(),t(3,"p",70),o(4),e()()),r&2){let i,l=s(2);a(4),u((i=l.kit())==null?null:i.observaciones)}}function W(r,n){r&1&&(t(0,"div",55),g(),t(1,"svg",71),c(2,"path",72),e(),f(),t(3,"p",73),o(4,"No hay productos en este kit"),e()())}function X(r,n){if(r&1&&(t(0,"div",80),o(1),e()),r&2){let i=s().$implicit;a(),v(" Entregado: ",i.cantidad_enviada||0," ")}}function Y(r,n){if(r&1&&(t(0,"div",81),o(1),e()),r&2){let i=s().$implicit;a(),v(" ",i.observaciones," ")}}function Z(r,n){if(r&1&&(t(0,"div",74)(1,"div",75)(2,"div",76)(3,"h4",77),o(4),e(),t(5,"p",48),o(6),e()(),t(7,"div",78)(8,"div",79),o(9),e(),h(10,X,2,1,"div",80),e()(),h(11,Y,2,1,"div",81),e()),r&2){let i=n.$implicit;a(4),u(i.producto==null?null:i.producto.nombre),a(2),u(i.producto==null?null:i.producto.codigo),a(3),v(" ",i.cantidad_solicitada," unidades "),a(),p(i.cantidad_enviada!==i.cantidad_solicitada?10:-1),a(),p(i.observaciones?11:-1)}}function ee(r,n){if(r&1&&(t(0,"div",56),K(1,Z,12,5,"div",74,N),e()),r&2){let i=s(2);a(),T(i.productos())}}function te(r,n){if(r&1){let i=P();t(0,"main",31)(1,"div",43)(2,"div",44)(3,"div",45)(4,"div")(5,"h2",46),o(6),e(),t(7,"div",25)(8,"span",47),o(9),V(10,"titlecase"),e(),t(11,"span",48),o(12),e()()()(),h(13,R,26,4,"div",49)(14,J,5,1,"div",50),e(),t(15,"div",44)(16,"h3",51)(17,"div",52),g(),t(18,"svg",53),c(19,"path",54),e()(),f(),t(20,"span"),o(21),e()(),h(22,W,5,0,"div",55)(23,ee,3,0,"div",56),e(),t(24,"div",57)(25,"button",58),S("click",function(){w(i);let d=s();return y(d.volver())}),g(),t(26,"svg",59),c(27,"path",60),e(),o(28," Volver "),e(),f(),t(29,"button",61),S("click",function(){w(i);let d=s();return y(d.onEditarKit())}),g(),t(30,"svg",59),c(31,"path",62),e(),o(32," Editar Kit "),e()()()()}if(r&2){let i,l,d,x,D,I,m=s();a(6),v(" Kit ",((i=m.kit())==null?null:i.numero_kit)||"N/A"," "),a(2),E("ngClass",m.getEstadoColor(((l=m.kit())==null?null:l.estado)||"pendiente")),a(),v(" ",z(10,8,(d=m.kit())==null?null:d.estado)," "),a(3),v(" Creado: ",m.formatearFecha(((x=m.kit())==null?null:x.created_at)||"")," "),a(),p((D=m.kit())!=null&&D.cirugia?13:-1),a(),p((I=m.kit())!=null&&I.observaciones?14:-1),a(7),v("Productos del Kit (",m.productos().length,")"),a(),p(m.productos().length===0?22:23)}}var G=class r{router=k(H);route=k($);kitService=k(Q);loading=b(!0);error=b(null);kit=b(null);productos=b([]);kitId="";ngOnInit(){this.kitId=this.route.snapshot.paramMap.get("id")||"",this.kitId?this.cargarDatos():(this.error.set("ID de kit no v\xE1lido"),this.loading.set(!1))}cargarDatos(){return _(this,null,function*(){try{this.loading.set(!0),this.error.set(null),yield Promise.all([this.cargarKit(),this.cargarProductos()])}catch(n){console.error("Error cargando datos del kit:",n),this.error.set(n.message||"Error cargando la informaci\xF3n del kit")}finally{this.loading.set(!1)}})}cargarKit(){return _(this,null,function*(){try{let n=yield C(this.kitService.getKit(this.kitId));if(!n)throw new Error("Kit no encontrado");this.kit.set(n)}catch(n){throw console.error("Error cargando kit:",n),new Error(`Error al cargar la informaci\xF3n del kit: ${n.message||"Error desconocido"}`)}})}cargarProductos(){return _(this,null,function*(){try{let n=yield C(this.kitService.getKitProductos(this.kitId));this.productos.set(n||[])}catch(n){console.error("Error cargando productos del kit:",n),this.productos.set([])}})}onEditarKit(){this.router.navigate(["/internal/agenda/kit-builder",this.kitId,"edit"])}mostrandoQr=b(!1);onGenerarQr(){this.mostrandoQr.set(!0)}cerrarModalQr(){this.mostrandoQr.set(!1)}imprimirQr(){window.print()}copiarEnlace(){return _(this,null,function*(){let n=`${window.location.origin}/internal/agenda/kit-detail/${this.kitId}`;try{yield navigator.clipboard.writeText(n),console.log("Enlace copiado al portapapeles")}catch(i){console.error("Error al copiar enlace:",i)}})}getQrUrl(){let n=`${window.location.origin}/internal/agenda/kit-detail/${this.kitId}`;return`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(n)}`}volver(){this.router.navigate(["/internal/agenda"])}formatearFecha(n){return n?new Date(n).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}getEstadoColor(n){switch(n){case"pendiente":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"en_preparacion":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300";case"listo":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"entregado":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300";case"devuelto":return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}}getClienteNombre(){let n=this.kit();return n?.cirugia?.cliente?`${n.cirugia.cliente.nombre} ${n.cirugia.cliente.apellido}`.trim():"Sin informaci\xF3n"}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=M({type:r,selectors:[["app-kit-detail"]],decls:37,vars:4,consts:[[1,"min-h-screen","bg-[#10284C]","relative","overflow-hidden"],[1,"absolute","inset-0","overflow-hidden","pointer-events-none"],["xmlns","http://www.w3.org/2000/svg",1,"absolute","w-full","h-full"],["id","grad1","x1","0%","y1","0%","x2","100%","y2","100%"],["offset","0%",2,"stop-color","#0098A8","stop-opacity","0.1"],["offset","100%",2,"stop-color","#C8D900","stop-opacity","0.05"],["points","100,50 125,65 125,95 100,110 75,95 75,65","fill","#0098A8","opacity","0.08"],["points","300,120 330,140 330,180 300,200 270,180 270,140","fill","#C8D900","opacity","0.06"],["cx","80%","cy","15%","r","120","fill","#0098A8","opacity","0.07"],["cx","15%","cy","80%","r","90","fill","#C8D900","opacity","0.08"],["cx","90%","cy","75%","r","60","fill","#0098A8","opacity","0.09"],["cx","50%","cy","50%","r","40","fill","url(#grad1)","opacity","0.1"],["points","85%,10% 95%,30% 75%,30%","fill","#C8D900","opacity","0.07","transform","translate(0, 0)"],["points","10%,85% 20%,95% 5%,95%","fill","#0098A8","opacity","0.08"],["x","60%","y","20%","width","80","height","80","fill","#0098A8","opacity","0.06","transform","rotate(45 65% 25%)"],["x","25%","y","60%","width","60","height","60","fill","#C8D900","opacity","0.07","transform","rotate(45 28% 63%)"],["x1","0%","y1","30%","x2","40%","y2","30%","stroke","#0098A8","stroke-width","2","opacity","0.1"],["x1","60%","y1","70%","x2","100%","y2","70%","stroke","#C8D900","stroke-width","2","opacity","0.1"],["x1","20%","y1","0%","x2","20%","y2","40%","stroke","#0098A8","stroke-width","2","opacity","0.08"],["points","400,300 410,320 430,325 410,330 400,350 390,330 370,325 390,320","fill","#C8D900","opacity","0.09"],["d","M 0 200 Q 100 150 200 200","stroke","#0098A8","stroke-width","3","fill","none","opacity","0.08"],["d","M 300 400 Q 400 350 500 400","stroke","#C8D900","stroke-width","3","fill","none","opacity","0.07"],[1,"relative","z-10","bg-gradient-to-br","from-[#10284C]/95","to-[#10284C]/60","backdrop-blur-md","border-b","border-white/10","shadow-2xl"],[1,"px-4","py-4"],[1,"flex","justify-center","items-center","mb-3"],[1,"flex","items-center","space-x-3"],["src","logo.webp","alt","Implameq",1,"h-8","brightness-0","invert"],[1,"text-lg","font-semibold","text-white"],[1,"text-center"],[1,"text-2xl","font-bold","mb-1","text-white"],["class","text-[#C8D900] text-sm",4,"ngIf"],[1,"relative","z-10","px-4","py-6"],[1,"relative","z-10","px-4","py-4"],[1,"text-[#C8D900]","text-sm"],[1,"max-w-lg","mx-auto"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","shadow-xl","p-6","text-center"],[1,"flex","justify-center","mb-4"],[1,"w-12","h-12","border-4","border-[#C8D900]","border-t-transparent","rounded-full","animate-spin"],[1,"text-sm","text-white/90","mt-4"],[1,"bg-red-500/20","backdrop-blur-md","border","border-red-400/30","rounded-2xl","shadow-xl","px-4","py-3"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-red-300","flex-shrink-0"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"text-sm","text-red-200"],[1,"max-w-lg","mx-auto","space-y-6"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","shadow-xl","p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"kit-status-badge",3,"ngClass"],[1,"text-sm","text-white/70"],[1,"bg-[#10284C]/50","backdrop-blur-sm","rounded-lg","border","border-white/10","p-4","mb-6"],[1,"mt-4","p-4","bg-[#0098A8]/30","backdrop-blur-sm","rounded-lg","border","border-white/10"],[1,"text-lg","font-semibold","text-white","mb-4","flex","items-center","space-x-2"],[1,"w-8","h-8","bg-[#C8D900]","rounded-lg","flex","items-center","justify-center","flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-[#10284C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"],[1,"text-center","py-8"],[1,"space-y-4"],[1,"flex","gap-2"],[1,"flex-1","bg-white/10","hover:bg-white/20","text-white","border","border-white/20","px-4","py-3","rounded-lg","font-medium","transition-all","backdrop-blur-sm","active:scale-95",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","inline","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"flex-1","bg-[#C8D900]","hover:bg-[#d4e820]","text-[#10284C]","px-4","py-3","rounded-lg","font-bold","transition-all","shadow-xl","active:scale-95",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"font-semibold","text-white","mb-3","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-[#C8D900]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","text-sm"],[1,"font-medium","text-white/70"],[1,"ml-2","text-white"],[1,"font-medium","text-[#C8D900]","mb-2"],[1,"text-sm","text-white/90"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-[#C8D900]/50","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"],[1,"text-white/70"],[1,"border","border-white/20","rounded-lg","p-4","bg-[#10284C]/40","backdrop-blur-sm"],[1,"flex","justify-between","items-start","mb-2"],[1,"flex-1"],[1,"font-medium","text-white"],[1,"text-right"],[1,"text-sm","font-bold","text-[#C8D900]"],[1,"text-xs","text-orange-300"],[1,"text-xs","text-white/80","bg-[#0098A8]/20","p-2","rounded","mt-2","border","border-white/10"]],template:function(i,l){i&1&&(t(0,"div",0)(1,"div",1),g(),t(2,"svg",2)(3,"defs")(4,"linearGradient",3),c(5,"stop",4)(6,"stop",5),e()(),c(7,"polygon",6)(8,"polygon",7)(9,"circle",8)(10,"circle",9)(11,"circle",10)(12,"circle",11)(13,"polygon",12)(14,"polygon",13)(15,"rect",14)(16,"rect",15)(17,"line",16)(18,"line",17)(19,"line",18)(20,"polygon",19)(21,"path",20)(22,"path",21),e()(),f(),t(23,"header",22)(24,"div",23)(25,"div",24)(26,"div",25),c(27,"img",26),t(28,"span",27),o(29,"Detalles del Kit"),e()()(),t(30,"div",28)(31,"h1",29),o(32,"Kit Quir\xFArgico"),e(),h(33,B,2,2,"p",30),e()()(),h(34,U,7,0,"div",31)(35,q,8,1,"div",32)(36,te,33,10,"main",31),e()),i&2&&(a(33),E("ngIf",l.kit()),a(),p(l.loading()?34:-1),a(),p(l.error()?35:-1),a(),p(!l.loading()&&!l.error()?36:-1))},dependencies:[F,L,O,j],styles:['.kit-status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.125rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:500}.trazabilidad-timeline[_ngcontent-%COMP%]{position:relative}.trazabilidad-timeline[_ngcontent-%COMP%]:before{content:"";position:absolute;left:1rem;top:0;bottom:0;width:.125rem;background-color:#e5e7eb}.dark[_ngcontent-%COMP%]   .trazabilidad-timeline[_ngcontent-%COMP%]:before{background-color:#4b5563}.timeline-item[_ngcontent-%COMP%]{position:relative;padding-left:2.5rem;padding-bottom:1.5rem}.timeline-icon[_ngcontent-%COMP%]{position:absolute;left:0;top:.25rem;width:2rem;height:2rem;background-color:#fff;border:2px solid #d1d5db;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.875rem}.dark[_ngcontent-%COMP%]   .timeline-icon[_ngcontent-%COMP%]{background-color:#1f2937;border-color:#6b7280}']})};export{G as KitDetailComponent};
