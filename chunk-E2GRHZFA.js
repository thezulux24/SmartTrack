import{$ as m,Aa as U,E as y,G as l,Ga as W,J as O,Ja as R,N as M,Pa as Y,Q as $,T as _,Ta as J,U as b,W as F,X as C,Y as w,Z as i,_ as n,aa as T,ba as f,c as N,ca as d,ha as c,ia as g,ja as u,ka as P,q as G,qa as V,ta as q,u as H,va as B,w as h,x as v,y as p,z as x}from"./chunk-IAYZCRTW.js";import"./chunk-LJ5XHLMQ.js";import{h as A}from"./chunk-FK42CRUA.js";var j=class o{supabase=H(J);getMyCirugias(){return N(this.getTechnicianCirugias())}getTechnicianCirugias(){return A(this,null,function*(){try{let t=yield this.supabase.getCurrentUserId();if(!t)throw new Error("Usuario no autenticado");let{data:e,error:a}=yield this.supabase.client.from("cirugias").select(`
          *,
          hospital_data:hospital_id(id, nombre, direccion, telefono, contacto_principal),
          tipo_cirugia_data:tipo_cirugia_id(id, nombre, descripcion, duracion_promedio),
          tecnico_asignado:tecnico_asignado_id(id, full_name, email, phone),
          usuario_creador:usuario_creador_id(id, full_name, email)
        `).eq("tecnico_asignado_id",t).order("fecha_programada",{ascending:!0});if(a)throw console.error("Error loading technician cirugias:",a),a;return console.log("\u2705 Cirug\xEDas del t\xE9cnico cargadas:",e),e||[]}catch(t){throw console.error("\u274C Error in getTechnicianCirugias:",t),t}})}getMyCirugiasForDateRange(t,e){return N(this.getTechnicianCirugiasForDateRange(t,e))}getTechnicianCirugiasForDateRange(t,e){return A(this,null,function*(){try{let a=yield this.supabase.getCurrentUserId();if(!a)throw new Error("Usuario no autenticado");let{data:r,error:s}=yield this.supabase.client.from("cirugias").select(`
          *,
          hospital_data:hospital_id(id, nombre, direccion, telefono, contacto_principal),
          tipo_cirugia_data:tipo_cirugia_id(id, nombre, descripcion, duracion_promedio),
          tecnico_asignado:tecnico_asignado_id(id, full_name, email, phone),
          usuario_creador:usuario_creador_id(id, full_name, email)
        `).eq("tecnico_asignado_id",a).gte("fecha_programada",t).lte("fecha_programada",e).order("fecha_programada",{ascending:!0});if(s)throw s;return r||[]}catch(a){throw console.error("\u274C Error getting cirugias for date range:",a),a}})}getTechnicianStats(){return A(this,null,function*(){try{let t=yield this.supabase.getCurrentUserId();if(!t)throw new Error("Usuario no autenticado");let e=new Date().toISOString().split("T")[0],{data:a,error:r}=yield this.supabase.client.from("cirugias").select("id",{count:"exact"}).eq("tecnico_asignado_id",t);if(r)throw r;let{data:s,error:E}=yield this.supabase.client.from("cirugias").select("id",{count:"exact"}).eq("tecnico_asignado_id",t).in("estado",["programada","en_curso"]);if(E)throw E;let{data:S,error:D}=yield this.supabase.client.from("cirugias").select("id",{count:"exact"}).eq("tecnico_asignado_id",t).eq("estado","completada");if(D)throw D;let{data:k,error:I}=yield this.supabase.client.from("cirugias").select("id",{count:"exact"}).eq("tecnico_asignado_id",t).gte("fecha_programada",e).lt("fecha_programada",`${e}T23:59:59`);if(I)throw I;return{totalCirugias:a?.length||0,cirugiasPendientes:s?.length||0,cirugiasCompletadas:S?.length||0,cirugiasHoy:k?.length||0}}catch(t){return console.error("\u274C Error getting technician stats:",t),{totalCirugias:0,cirugiasPendientes:0,cirugiasCompletadas:0,cirugiasHoy:0}}})}markCirugiaAsCompleted(t){return A(this,null,function*(){try{let e=yield this.supabase.getCurrentUserId();if(!e)throw new Error("Usuario no autenticado");let{data:a,error:r}=yield this.supabase.client.from("cirugias").select("id, tecnico_asignado_id").eq("id",t).eq("tecnico_asignado_id",e).single();if(r||!a)throw new Error("No tienes permisos para modificar esta cirug\xEDa");let{error:s}=yield this.supabase.client.from("cirugias").update({estado:"completada",updated_at:new Date().toISOString(),updated_by:e}).eq("id",t);if(s)throw s}catch(e){throw console.error("\u274C Error marking cirugia as completed:",e),e}})}addTechnicianNotes(t,e){return A(this,null,function*(){try{let a=yield this.supabase.getCurrentUserId();if(!a)throw new Error("Usuario no autenticado");let{data:r,error:s}=yield this.supabase.client.from("cirugias").select("id, tecnico_asignado_id, notas").eq("id",t).eq("tecnico_asignado_id",a).single();if(s||!r)throw new Error("No tienes permisos para modificar esta cirug\xEDa");let E=r.notas||"",S=`[T\xE9cnico - ${new Date().toLocaleDateString()}]: ${e}`,D=E?`${E}

${S}`:S,{error:k}=yield this.supabase.client.from("cirugias").update({notas:D,updated_at:new Date().toISOString(),updated_by:a}).eq("id",t);if(k)throw k}catch(a){throw console.error("\u274C Error adding technician notes:",a),a}})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=G({token:o,factory:o.\u0275fac,providedIn:"root"})};var Z=()=>["/internal"],Q=()=>["/internal/agenda"],ee=()=>({month:"short"}),te=(o,t)=>t.titulo,ie=(o,t)=>t.date.getTime(),L=(o,t)=>t.id,z=(o,t)=>t.getTime();function ne(o,t){o&1&&(i(0,"div",4)(1,"div",8)(2,"div",9),m(3,"div",10)(4,"div",11),n(),i(5,"p",12),c(6,"Cargando mis cirug\xEDas..."),n()()())}function ae(o,t){if(o&1){let e=T();i(0,"div",5)(1,"div",13)(2,"div",14),p(),i(3,"svg",15),m(4,"path",16),n(),x(),i(5,"p",17),c(6),n()(),i(7,"button",18),f("click",function(){h(e);let r=d();return v(r.refreshData())}),c(8," Reintentar "),n()()()}if(o&2){let e=d();l(6),g(e.error())}}function oe(o,t){o&1&&(p(),i(0,"svg",49),m(1,"path",54),n())}function re(o,t){o&1&&(p(),i(0,"svg",49),m(1,"path",55),n())}function le(o,t){o&1&&(p(),i(0,"svg",49),m(1,"path",55),n())}function ce(o,t){if(o&1&&(i(0,"div",47)(1,"div",48)(2,"div"),M(3,oe,2,0,":svg:svg",49)(4,re,2,0,":svg:svg",49)(5,le,2,0,":svg:svg",49),n(),i(6,"div",50)(7,"p",51),c(8),n(),i(9,"p",52),c(10),n()(),i(11,"span",53),c(12),n()()()),o&2){let e=t.$implicit;_(e.tipo==="urgente"?"bg-red-500/20 border-red-400/50":e.tipo==="advertencia"?"bg-yellow-500/20 border-yellow-400/50":"bg-blue-500/20 border-blue-400/50"),l(2),_(e.tipo==="urgente"?"text-red-300":e.tipo==="advertencia"?"text-yellow-300":"text-blue-300"),l(),b(e.tipo==="urgente"?3:e.tipo==="advertencia"?4:5),l(4),_((e.tipo==="urgente"||e.tipo==="advertencia","text-white font-semibold")),l(),u(" ",e.titulo," "),l(2),u(" ",e.mensaje," "),l(2),u(" ",e.tiempo," ")}}function de(o,t){if(o&1&&(i(0,"div",30)(1,"h3",44),c(2,"Mis Alertas"),n(),i(3,"div",45),C(4,ce,13,10,"div",46,te),n()()),o&2){let e=d(2);l(4),w(e.alerts())}}function se(o,t){if(o&1&&(i(0,"div",57)(1,"span",60),c(2),n()()),o&2){let e=t.$implicit;l(2),g(e)}}function me(o,t){if(o&1){let e=T();i(0,"button",65),f("click",function(){let r=h(e).$implicit,s=d(4);return v(s.selectEvent(r))}),i(1,"div",66),c(2),n(),i(3,"div",67),c(4),n()()}if(o&2){let e=t.$implicit,a=d(4);_(a.getTipoUrgencia(e)==="urgente"?"bg-red-500/30 text-white border-red-400/50 hover:bg-red-500/50":"bg-[#0098A8]/40 text-white border-[#0098A8]/60 hover:bg-[#0098A8]/60"),l(2),g(a.getClienteNombre(e)),l(2),g(a.formatHora(e.hora_inicio))}}function pe(o,t){if(o&1&&(i(0,"div",61)(1,"div",62),c(2),n(),i(3,"div",63),C(4,me,5,4,"button",64,L),n()()),o&2){let e=t.$implicit;_(e.isCurrentMonth?"bg-[#0098A8]/10":"bg-[#10284C]/50"),l(),_(e.isToday?"bg-[#C8D900] text-[#10284C] font-bold":e.isCurrentMonth?"text-white":"text-white/40"),l(),u(" ",e.date.getDate()," "),l(2),w(e.events)}}function ue(o,t){if(o&1&&(i(0,"div",40)(1,"div",56),C(2,se,3,1,"div",57,F),n(),i(4,"div",58),C(5,pe,6,5,"div",59,ie),n()()),o&2){let e=d(2);l(2),w(e.weekDays),l(3),w(e.calendarDays())}}function ge(o,t){if(o&1&&(i(0,"div",70)(1,"div"),c(2),n(),i(3,"div",75),c(4),n()()),o&2){let e=t.$implicit,a=t.$index,r=d(3);l(),_(r.isToday(e)?"text-[#C8D900]":"text-white"),l(),u(" ",r.weekDays[a]," "),l(),_(r.isToday(e)?"text-[#C8D900]":"text-white/60"),l(),u(" ",e.getDate()," ")}}function _e(o,t){if(o&1){let e=T();i(0,"button",79),f("click",function(){let r=h(e).$implicit,s=d(5);return v(s.selectEvent(r))}),i(1,"div",67),c(2),n(),i(3,"div",80),c(4),n()()}if(o&2){let e=t.$implicit,a=d(5);_(a.getTipoUrgencia(e)==="urgente"?"bg-[#E91E63]":e.estado==="en_curso"?"bg-[#FF9800]":e.estado==="completada"?"bg-[#4CAF50]":"bg-[#2196F3]"),l(2),g(a.getClienteNombre(e)),l(2),g(a.formatHora(e.hora_inicio))}}function xe(o,t){if(o&1&&(i(0,"div",77),C(1,_e,5,4,"button",78,L),n()),o&2){let e=t.$index,a=d().$implicit,r=d(3);l(),w(r.getEventsForDayHour(e,a))}}function he(o,t){if(o&1&&(i(0,"div",72)(1,"div",76),c(2),n(),C(3,xe,3,0,"div",77,z),n()),o&2){let e=t.$implicit,a=d(3);l(2),u(" ",a.formatHour(e)," "),l(),w(a.getWeekDays())}}function ve(o,t){o&1&&(i(0,"span",84),c(1," Hoy "),n())}function be(o,t){if(o&1){let e=T();i(0,"button",88),f("click",function(){let r=h(e).$implicit,s=d(5);return v(s.selectEvent(r))}),i(1,"div",89)(2,"h5",90),c(3),n(),i(4,"span",91),c(5),n()(),i(6,"div",92),p(),i(7,"svg",93),m(8,"path",94),n(),x(),i(9,"span"),c(10),n()()()}if(o&2){let e=t.$implicit,a=d(5);_(a.getTipoUrgencia(e)==="urgente"?"bg-[#E91E63]/20 border-l-[#E91E63]":e.estado==="en_curso"?"bg-[#FF9800]/20 border-l-[#FF9800]":e.estado==="completada"?"bg-[#4CAF50]/20 border-l-[#4CAF50]":"bg-[#2196F3]/20 border-l-[#2196F3]"),l(3),g(a.getClienteNombre(e)),l(),_(a.getTipoUrgencia(e)==="urgente"?"bg-[#E91E63]/30 text-[#E91E63]":e.estado==="en_curso"?"bg-[#FF9800]/30 text-[#FF9800]":e.estado==="completada"?"bg-[#4CAF50]/30 text-[#4CAF50]":"bg-[#2196F3]/30 text-[#2196F3]"),l(),u(" ",a.getStatusLabel(e.estado)," "),l(5),g(a.formatHora(e.hora_inicio))}}function fe(o,t){if(o&1&&C(0,be,11,7,"button",87,L),o&2){let e=t.$implicit,a=d().$index,r=d(3);w(r.getEventsForDayHour(a,e))}}function Ce(o,t){o&1&&(i(0,"p",86),c(1," Sin cirug\xEDas programadas "),n())}function we(o,t){if(o&1&&(i(0,"div",74)(1,"div",81)(2,"div")(3,"h4",82),c(4),n(),i(5,"p",83),c(6),n()(),M(7,ve,2,0,"span",84),n(),i(8,"div",85),C(9,fe,2,0,null,null,F,!1,Ce,2,0,"p",86),n()()),o&2){let e=t.$implicit,a=t.$index,r=d(3);l(3),_(r.isToday(e)?"text-[#C8D900]":"text-white"),l(),P(" ",r.weekDays[a]," ",e.getDate()," "),l(2),u(" ",e.toLocaleDateString("es-ES",V(7,ee))," "),l(),b(r.isToday(e)?7:-1),l(2),w(r.hours)}}function Ee(o,t){if(o&1&&(i(0,"div",68)(1,"div",69)(2,"div",70),c(3," Hora "),n(),C(4,ge,5,6,"div",70,z),n(),i(6,"div",71),C(7,he,5,1,"div",72,F),n()(),i(9,"div",73),C(10,we,12,8,"div",74,z),n()),o&2){let e=d(2);l(4),w(e.getWeekDays()),l(3),w(e.hours),l(3),w(e.getWeekDays())}}function De(o,t){if(o&1){let e=T();i(0,"button",102),f("click",function(){let r=h(e).$implicit,s=d(4);return v(s.selectEvent(r))}),i(1,"div",103)(2,"h4",104),c(3),n(),i(4,"span",105),c(5),n()(),i(6,"div",106)(7,"div",107),p(),i(8,"svg",108),m(9,"path",94),n(),x(),i(10,"span"),c(11),n()(),i(12,"div",107),p(),i(13,"svg",108),m(14,"path",109),n(),x(),i(15,"span"),c(16),n()(),i(17,"div",107),p(),i(18,"svg",108),m(19,"path",110),n(),x(),i(20,"span"),c(21),n()(),i(22,"div",107),p(),i(23,"svg",108),m(24,"path",111),n(),x(),i(25,"span"),c(26),n()(),i(27,"div",107),p(),i(28,"svg",108),m(29,"path",94),n(),x(),i(30,"span"),c(31),n()()()()}if(o&2){let e=t.$implicit,a=d(4);_(a.getTipoUrgencia(e)==="urgente"?"border-l-red-500 bg-red-500/20":"border-l-[#C8D900] bg-[#0098A8]/30"),l(3),g(a.getClienteNombre(e)),l(),_(a.getTipoUrgencia(e)==="urgente"?"bg-red-500/40 text-white":"bg-[#C8D900]/30 text-[#C8D900]"),l(),u(" ",a.getStatusLabel(e.estado)," "),l(6),P("",a.formatHora(e.hora_inicio)," - ",a.getHoraFin(e),""),l(5),g(a.getHospitalNombre(e)),l(5),u("Dr. ",e.medico_cirujano,""),l(5),g(a.getTipoCirugiaNombre(e)),l(5),u("Duraci\xF3n: ",a.getDuracionEstimada(e),"")}}function Se(o,t){o&1&&(i(0,"div",101),c(1," Sin cirug\xEDas asignadas "),n())}function ye(o,t){if(o&1&&(i(0,"div",97)(1,"div",98),c(2),n(),i(3,"div",99),C(4,De,32,12,"button",100,L,!1,Se,2,0,"div",101),n()()),o&2){let e=t.$implicit,a=d(3);l(2),u(" ",a.formatHour(e)," "),l(2),w(a.getEventsForHour(e))}}function Te(o,t){if(o&1&&(i(0,"div",41)(1,"div",95)(2,"h3",96),c(3),n(),i(4,"div",45),C(5,ye,7,2,"div",97,F),n()()()),o&2){let e=d(2);l(3),u(" ",e.getCurrentDayDate()," "),l(2),w(e.hours)}}function ke(o,t){o&1&&(i(0,"div",42)(1,"div",112)(2,"div",113),c(3,"\u{1F468}\u200D\u2695\uFE0F"),n(),i(4,"h3",114),c(5,"No tienes cirug\xEDas asignadas"),n(),i(6,"p",115),c(7,"Cuando se te asignen cirug\xEDas, aparecer\xE1n aqu\xED"),n(),i(8,"button",116),c(9," Ver Agenda General "),n()()()),o&2&&(l(8),$("routerLink",V(1,Q)))}function Me(o,t){if(o&1){let e=T();i(0,"main",6)(1,"div",19)(2,"div",20),m(3,"img",21),i(4,"div",22)(5,"button",23),p(),i(6,"svg",24),m(7,"path",25),n(),x(),i(8,"span",26),c(9,"Dashboard"),n()(),i(10,"button",23),p(),i(11,"svg",24),m(12,"path",27),n(),x(),i(13,"span",26),c(14,"Agenda General"),n()()()(),i(15,"div",8)(16,"h1",28),c(17,"Mi Agenda"),n(),i(18,"p",29),c(19,"Mis cirug\xEDas programadas"),n()(),i(20,"div",30)(21,"div",31)(22,"div",32)(23,"button",33),f("click",function(){h(e);let r=d();return v(r.previousPeriod())}),p(),i(24,"svg",34),m(25,"path",35),n()(),x(),i(26,"h2",36),c(27),n(),i(28,"button",33),f("click",function(){h(e);let r=d();return v(r.nextPeriod())}),p(),i(29,"svg",34),m(30,"path",37),n()()(),x(),i(31,"div",38)(32,"button",39),f("click",function(){h(e);let r=d();return v(r.setView("month"))}),c(33," Mes "),n(),i(34,"button",39),f("click",function(){h(e);let r=d();return v(r.setView("week"))}),c(35," Semana "),n(),i(36,"button",39),f("click",function(){h(e);let r=d();return v(r.setView("day"))}),c(37," D\xEDa "),n()()()(),M(38,de,6,0,"div",30)(39,ue,7,0,"div",40)(40,Ee,12,0)(41,Te,7,1,"div",41)(42,ke,10,2,"div",42),m(43,"div",43),n()()}if(o&2){let e=d();l(5),$("routerLink",V(14,Z)),l(5),$("routerLink",V(15,Q)),l(17),u(" ",e.getCurrentPeriodTitle()," "),l(5),_(e.currentView()==="month"?"bg-[#C8D900] text-[#10284C] shadow-lg":"text-white/70 hover:text-white"),l(2),_(e.currentView()==="week"?"bg-[#C8D900] text-[#10284C] shadow-lg":"text-white/70 hover:text-white"),l(2),_(e.currentView()==="day"?"bg-[#C8D900] text-[#10284C] shadow-lg":"text-white/70 hover:text-white"),l(2),b(e.alerts().length>0?38:-1),l(),b(e.currentView()==="month"?39:-1),l(),b(e.currentView()==="week"?40:-1),l(),b(e.currentView()==="day"?41:-1),l(),b(e.cirugias().length===0?42:-1)}}function Ae(o,t){if(o&1&&(i(0,"div",133)(1,"span",134),c(2,"Documento:"),n(),i(3,"span",135),c(4),n()()),o&2){let e=d(3);l(4),g(e.getClienteDocumento(e.selectedEventDetails()))}}function Fe(o,t){if(o&1&&(i(0,"div",133)(1,"span",134),c(2,"Tel\xE9fono:"),n(),i(3,"span",135),c(4),n()()),o&2){let e=d(3);l(4),g(e.getClienteTelefono(e.selectedEventDetails()))}}function Ve(o,t){if(o&1&&(i(0,"div",128)(1,"div",129)(2,"div",130),p(),i(3,"svg",131),m(4,"path",110),n()(),x(),i(5,"h5",104),c(6,"Cliente"),n()(),i(7,"div",132),M(8,Ae,5,1,"div",133)(9,Fe,5,1,"div",133),n()()),o&2){let e=d(2);l(8),b(e.getClienteDocumento(e.selectedEventDetails())?8:-1),l(),b(e.getClienteTelefono(e.selectedEventDetails())?9:-1)}}function Ie(o,t){if(o&1&&(i(0,"div",128)(1,"div",129)(2,"div",130),p(),i(3,"svg",131),m(4,"path",140),n()(),x(),i(5,"h5",104),c(6,"Notas"),n()(),i(7,"p",141),c(8),n()()),o&2){let e=d(2);l(8),u(" ",e.selectedEventDetails().notas," ")}}function He(o,t){if(o&1){let e=T();i(0,"div",117),f("click",function(){h(e);let r=d();return v(r.closeModal())}),i(1,"div",118),f("click",function(r){return h(e),v(r.stopPropagation())}),i(2,"div",119)(3,"div",120)(4,"h3",121),c(5," Mi Cirug\xEDa Asignada "),n(),i(6,"button",122),f("click",function(){h(e);let r=d();return v(r.closeModal())}),p(),i(7,"svg",34),m(8,"path",123),n()()()(),x(),i(9,"div",124)(10,"div",8)(11,"div",125),c(12),n(),i(13,"h4",126),c(14),n(),i(15,"p",127),c(16),n()(),i(17,"div",41)(18,"div",128)(19,"div",129)(20,"div",130),p(),i(21,"svg",131),m(22,"path",94),n()(),x(),i(23,"h5",104),c(24,"Programaci\xF3n"),n()(),i(25,"div",132)(26,"div",133)(27,"span",134),c(28,"Fecha:"),n(),i(29,"span",135),c(30),q(31,"date"),n()(),i(32,"div",133)(33,"span",134),c(34,"Hora inicio:"),n(),i(35,"span",135),c(36),n()(),i(37,"div",133)(38,"span",134),c(39,"Hora fin (est.):"),n(),i(40,"span",135),c(41),n()(),i(42,"div",133)(43,"span",134),c(44,"Duraci\xF3n:"),n(),i(45,"span",135),c(46),n()()()(),i(47,"div",128)(48,"div",129)(49,"div",130),p(),i(50,"svg",131),m(51,"path",110),n()(),x(),i(52,"h5",104),c(53,"Equipo M\xE9dico"),n()(),i(54,"div",132)(55,"div",133)(56,"span",134),c(57,"Cirujano:"),n(),i(58,"span",135),c(59),n()(),i(60,"div",133)(61,"span",134),c(62,"T\xE9cnico:"),n(),i(63,"span",135),c(64),n()()()(),i(65,"div",128)(66,"div",129)(67,"div",130),p(),i(68,"svg",131),m(69,"path",109),n()(),x(),i(70,"h5",104),c(71,"Ubicaci\xF3n"),n()(),i(72,"div",132)(73,"div",133)(74,"span",134),c(75,"Hospital:"),n(),i(76,"span",135),c(77),n()()()(),M(78,Ve,10,2,"div",128)(79,Ie,9,1,"div",128),n()(),i(80,"div",136)(81,"div",137)(82,"button",138),f("click",function(){h(e);let r=d();return v(r.navigateToEvent(r.selectedEventDetails()))}),c(83," Ver Detalles "),n(),i(84,"button",139),f("click",function(){h(e);let r=d();return v(r.closeModal())}),c(85," Cerrar "),n()()()()()}if(o&2){let e=d();l(11),_(e.getTipoUrgencia(e.selectedEventDetails())==="urgente"?"bg-red-500/30 text-white border-red-400/50":"bg-[#C8D900]/30 text-[#C8D900] border-[#C8D900]/50"),l(),u(" ",e.getStatusLabel(e.selectedEventDetails().estado)," "),l(2),u(" ",e.getClienteNombre(e.selectedEventDetails())," "),l(2),u(" ",e.getTipoCirugiaNombre(e.selectedEventDetails())," "),l(14),g(B(31,14,e.selectedEventDetails().fecha_programada,"dd/MM/yyyy")),l(6),g(e.formatHora(e.selectedEventDetails().hora_inicio)),l(5),g(e.getHoraFin(e.selectedEventDetails())),l(5),g(e.getDuracionEstimada(e.selectedEventDetails())),l(13),u("Dr. ",e.selectedEventDetails().medico_cirujano,""),l(5),g(e.getTecnicoNombre(e.selectedEventDetails())),l(13),g(e.getHospitalNombre(e.selectedEventDetails())),l(),b(e.getClienteDocumento(e.selectedEventDetails())||e.getClienteTelefono(e.selectedEventDetails())?78:-1),l(),b(e.selectedEventDetails().notas?79:-1)}}var K=class o{technicianAgendaService=H(j);currentView=y("month");currentDate=y(new Date);selectedEvent=y(null);loading=y(!1);error=y(null);cirugias=y([]);showModal=y(!1);selectedEventDetails=y(null);alerts=U(()=>{let t=[],e=new Date;return new Date(e).setDate(e.getDate()+1),this.cirugias().forEach(r=>{this.isToday(new Date(r.fecha_programada))&&(r.estado==="programada"?t.push({tipo:"info",titulo:"Cirug\xEDa Programada Hoy",mensaje:`${this.getClienteNombre(r)} - ${this.formatHora(r.hora_inicio)}`,tiempo:"Hoy"}):r.estado==="en_curso"&&t.push({tipo:"urgente",titulo:"Cirug\xEDa en Curso",mensaje:`${this.getClienteNombre(r)} - ${this.getTipoCirugiaNombre(r)}`,tiempo:"En curso"})),this.isTomorrow(r.fecha_programada)&&r.estado==="programada"&&t.push({tipo:"advertencia",titulo:"Cirug\xEDa Ma\xF1ana",mensaje:`${this.getClienteNombre(r)} - ${this.formatHora(r.hora_inicio)}`,tiempo:"Ma\xF1ana"}),r.prioridad==="urgencia"&&r.estado!=="completada"&&t.push({tipo:"urgente",titulo:"Cirug\xEDa Urgente Asignada",mensaje:`${this.getClienteNombre(r)} - ${this.getTipoCirugiaNombre(r)}`,tiempo:this.getTimeAgo(r.created_at||"")})}),t.slice(0,5)});weekDays=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];hours=Array.from({length:24},(t,e)=>e);ngOnInit(){this.loadMyCirugias()}loadMyCirugias(){this.loading.set(!0),this.error.set(null),this.technicianAgendaService.getMyCirugias().subscribe({next:t=>{console.log("\u2705 Mis cirug\xEDas cargadas:",t),this.cirugias.set(t),this.loading.set(!1)},error:t=>{console.error("\u274C Error loading my cirugias:",t),this.error.set("Error al cargar mis cirug\xEDas asignadas"),this.loading.set(!1)}})}calendarDays=U(()=>{let t=this.currentDate(),e=t.getFullYear(),a=t.getMonth(),r=new Date(e,a,1),s=new Date(e,a+1,0),E=new Date(r);E.setDate(E.getDate()-r.getDay());let S=[],D=new Date(E);for(let k=0;k<42;k++){let I=this.getEventsForDate(D);S.push({date:new Date(D),isCurrentMonth:D.getMonth()===a,isToday:this.isToday(D),events:I}),D.setDate(D.getDate()+1)}return S});getEventsForDate(t){return this.cirugias().filter(e=>new Date(e.fecha_programada).toDateString()===t.toDateString())}getEventsForHour(t){let e=this.currentDate();return this.cirugias().filter(a=>new Date(a.fecha_programada).toDateString()!==e.toDateString()||!a.hora_inicio?!1:parseInt(a.hora_inicio.split(":")[0])===t)}getEventsForDayHour(t,e){let r=this.getWeekDays()[t];return this.cirugias().filter(s=>new Date(s.fecha_programada).toDateString()!==r.toDateString()||!s.hora_inicio?!1:parseInt(s.hora_inicio.split(":")[0])===e)}getWeekDays(){let t=new Date(this.currentDate()),e=new Date(t);e.setDate(t.getDate()-t.getDay());let a=[];for(let r=0;r<7;r++){let s=new Date(e);s.setDate(e.getDate()+r),a.push(s)}return a}isToday(t){let e=new Date;return t.toDateString()===e.toDateString()}isTomorrow(t){let e=new Date;return e.setDate(e.getDate()+1),new Date(t).toDateString()===e.toDateString()}getCurrentPeriodTitle(){let t=this.currentDate();switch(this.currentView()){case"month":return t.toLocaleDateString("es-ES",{month:"long",year:"numeric"});case"week":let a=this.getWeekDays()[0],r=this.getWeekDays()[6];return`${a.toLocaleDateString("es-ES",{day:"numeric",month:"short"})} - ${r.toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"})}`;case"day":return t.toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"});default:return""}}getCurrentDayDate(){return this.currentDate().toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}getStatusLabel(t){return{programada:"Programada",en_curso:"En Curso",completada:"Completada",cancelada:"Cancelada",urgencia:"Urgencia"}[t]||t}formatHour(t){return`${t.toString().padStart(2,"0")}:00`}formatHora(t){return t?t.substring(0,5):"Sin hora"}setView(t){this.currentView.set(t)}previousPeriod(){let t=new Date(this.currentDate());switch(this.currentView()){case"month":t.setMonth(t.getMonth()-1);break;case"week":t.setDate(t.getDate()-7);break;case"day":t.setDate(t.getDate()-1);break}this.currentDate.set(t)}nextPeriod(){let t=new Date(this.currentDate());switch(this.currentView()){case"month":t.setMonth(t.getMonth()+1);break;case"week":t.setDate(t.getDate()+7);break;case"day":t.setDate(t.getDate()+1);break}this.currentDate.set(t)}selectEvent(t){this.selectedEventDetails.set(t),this.showModal.set(!0),console.log("Mi cirug\xEDa seleccionada:",t)}closeModal(){this.showModal.set(!1),this.selectedEventDetails.set(null)}navigateToEvent(t){this.closeModal()}getHospitalNombre(t){return t.hospital_data?.nombre||"Hospital no especificado"}getTipoCirugiaNombre(t){return t.tipo_cirugia_data?.nombre||"Tipo no especificado"}getTecnicoNombre(t){return t.tecnico_asignado?.full_name||"Sin asignar"}getDuracionEstimada(t){if(t.duracion_estimada){let e=Math.floor(t.duracion_estimada/60),a=t.duracion_estimada%60;return e>0?`${e}h ${a}m`:`${a}m`}return"No estimada"}getTimeAgo(t){if(!t)return"Reciente";let e=new Date,a=new Date(t),r=Math.floor((e.getTime()-a.getTime())/(1e3*60));return r<60?`${r} min`:r<1440?`${Math.floor(r/60)}h`:`${Math.floor(r/1440)}d`}getTipoUrgencia(t){return t.estado==="urgencia"||t.prioridad==="urgencia"?"urgente":"programada"}getHoraFin(t){if(!t.hora_inicio||!t.duracion_estimada)return"";let[e,a]=t.hora_inicio.split(":").map(Number),s=e*60+a+t.duracion_estimada,E=Math.floor(s/60),S=s%60;return`${E.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`}refreshData(){this.loadMyCirugias()}getClienteNombre(t){return t.cliente?`${t.cliente.nombre} ${t.cliente.apellido}`:"Cliente no especificado"}getClienteDocumento(t){return t.cliente?`${t.cliente.documento_tipo}: ${t.cliente.documento_numero}`:null}getClienteTelefono(t){return t.cliente&&t.cliente.telefono||null}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=O({type:o,selectors:[["app-agenda-tecnico"]],decls:8,vars:4,consts:[[1,"min-h-screen","relative","overflow-hidden"],[1,"absolute","inset-0","z-0"],["src","01.jpg","alt","Surgical background",1,"absolute","inset-0","w-full","h-full","object-cover"],[1,"absolute","inset-0","bg-[#10284C]/80"],[1,"relative","z-10","flex","items-center","justify-center","min-h-screen"],[1,"relative","z-10","flex","items-center","justify-center","min-h-screen","px-4"],[1,"relative","z-10","px-4","py-6"],[1,"fixed","inset-0","bg-black/70","backdrop-blur-sm","z-50","flex","items-end","sm:items-center","justify-center","p-4"],[1,"text-center"],[1,"animate-pulse","space-y-4"],[1,"h-4","bg-gray-200","rounded","w-64","mx-auto"],[1,"h-4","bg-gray-200","rounded","w-48","mx-auto"],[1,"text-sm","text-white/70","mt-4"],[1,"bg-white","rounded-xl","shadow-lg","p-8","max-w-md","text-center"],[1,"text-red-600"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-lg"],["type","button",1,"mt-6","w-full","bg-red-600","hover:bg-red-700","text-white","px-6","py-3","rounded-lg","font-medium",3,"click"],[1,"max-w-4xl","mx-auto","space-y-6"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","gap-4"],["src","https://www.implameq.com/wp-content/uploads/logotipo-impla-300x78.png.webp","alt","Implameq",1,"h-10","w-auto","brightness-0","invert"],[1,"flex","items-center","gap-3"],[1,"px-4","py-2","bg-[#C8D900]","text-[#10284C]","rounded-lg","hover:bg-[#d4e820]","transition-colors","font-medium","flex","items-center","gap-2","active:scale-95",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"],[1,"hidden","sm:inline"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-3xl","sm:text-4xl","font-bold","text-[#C8D900]","mb-2"],[1,"text-white/80","text-sm"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","p-6","shadow-xl"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-4"],[1,"flex","items-center","gap-4","justify-center","sm:justify-start"],[1,"p-2","text-white","hover:bg-white/10","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"text-2xl","font-bold","text-[#C8D900]","min-w-[200px]","text-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"flex","bg-[#0098A8]/30","backdrop-blur-sm","rounded-xl","p-1","border","border-white/20"],[1,"flex-1","px-4","py-2","text-sm","font-semibold","rounded-lg","transition-all",3,"click"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","shadow-xl","overflow-hidden"],[1,"space-y-4"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","shadow-xl","p-12","text-center"],[1,"h-6"],[1,"text-xl","font-bold","text-white","mb-4"],[1,"space-y-3"],[1,"p-4","rounded-xl","border","backdrop-blur-sm",3,"class"],[1,"p-4","rounded-xl","border","backdrop-blur-sm"],[1,"flex","items-start","space-x-3"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","mt-0.5"],[1,"flex-1"],[1,"text-sm"],[1,"text-white/80","text-xs","mt-1"],[1,"text-white/70","text-xs","font-medium"],["fill-rule","evenodd","d","M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule","evenodd"],[1,"grid","grid-cols-7","bg-[#0098A8]/40"],[1,"p-2","text-center"],[1,"grid","grid-cols-7"],[1,"min-h-[80px]","p-1","border-b","border-r","border-white/10",3,"class"],[1,"text-xs","font-semibold","text-white"],[1,"min-h-[80px]","p-1","border-b","border-r","border-white/10"],[1,"text-xs","mb-1","w-6","h-6","flex","items-center","justify-center","rounded"],[1,"space-y-1"],[1,"w-full","text-left","px-2","py-1","rounded","text-xs","border","truncate","transition-colors",3,"class"],[1,"w-full","text-left","px-2","py-1","rounded","text-xs","border","truncate","transition-colors",3,"click"],[1,"font-medium","truncate"],[1,"truncate"],[1,"hidden","sm:block","bg-[#0098A8]/20","backdrop-blur-sm","rounded-2xl","p-4","border","border-white/20","overflow-x-auto"],[1,"grid","grid-cols-8","gap-1","mb-3","min-w-[600px]"],[1,"text-center","text-white/80","text-xs","font-medium","py-2"],[1,"space-y-1","min-w-[600px]"],[1,"grid","grid-cols-8","gap-1"],[1,"sm:hidden","space-y-3"],[1,"bg-[#0098A8]/20","backdrop-blur-sm","rounded-2xl","p-3","border","border-white/20"],[1,"text-[10px]"],[1,"text-xs","text-white/60","py-2","text-center"],[1,"bg-[#0D5F6A]/50","rounded","p-1","min-h-[60px]"],[1,"w-full","text-white","text-[9px]","px-1","py-1","rounded","font-medium","hover:opacity-80","transition-opacity","mb-1",3,"class"],[1,"w-full","text-white","text-[9px]","px-1","py-1","rounded","font-medium","hover:opacity-80","transition-opacity","mb-1",3,"click"],[1,"text-[8px]","text-white/80"],[1,"flex","items-center","justify-between","mb-3","pb-2","border-b","border-white/20"],[1,"text-sm","font-bold"],[1,"text-white/60","text-xs"],[1,"bg-[#C8D900]","text-[#10284C]","text-xs","px-2","py-1","rounded-full","font-medium"],[1,"space-y-2"],[1,"text-white/40","text-sm","text-center","py-4","italic"],[1,"w-full","text-left","p-3","rounded-lg","border-l-4","backdrop-blur-sm","active:bg-white/10","transition-colors",3,"class"],[1,"w-full","text-left","p-3","rounded-lg","border-l-4","backdrop-blur-sm","active:bg-white/10","transition-colors",3,"click"],[1,"flex","justify-between","items-start","mb-2"],[1,"text-white","font-semibold","text-sm"],[1,"px-2","py-1","rounded-full","text-[10px]","font-medium"],[1,"flex","items-center","space-x-2","text-xs","text-white/80"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","shadow-xl","p-6"],[1,"text-2xl","font-bold","text-[#C8D900]","mb-4"],[1,"flex","items-start","space-x-4","pb-3","border-b","border-white/10","last:border-b-0"],[1,"text-sm","font-semibold","text-white/80","w-20"],[1,"flex-1","space-y-2"],[1,"w-full","text-left","p-4","rounded-xl","border-l-4","hover:bg-white/10","transition-all","backdrop-blur-sm",3,"class"],[1,"text-sm","text-white/60","italic","pl-4"],[1,"w-full","text-left","p-4","rounded-xl","border-l-4","hover:bg-white/10","transition-all","backdrop-blur-sm",3,"click"],[1,"flex","justify-between","items-start","mb-3"],[1,"font-bold","text-white","text-lg"],[1,"px-3","py-1","rounded-full","text-xs","font-semibold","border","border-white/20"],[1,"space-y-2","text-sm","text-white/90"],[1,"flex","items-center","space-x-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"text-white/80"],[1,"text-6xl","mb-6"],[1,"text-2xl","font-bold","text-white","mb-3"],[1,"text-white/70","text-lg","mb-6"],[1,"bg-[#C8D900]","hover:bg-[#d4e820]","text-[#10284C]","px-8","py-3","rounded-xl","font-bold","shadow-xl","transition-all","duration-200","active:scale-95",3,"routerLink"],[1,"fixed","inset-0","bg-black/70","backdrop-blur-sm","z-50","flex","items-end","sm:items-center","justify-center","p-4",3,"click"],[1,"bg-gradient-to-br","from-[#10284C]","via-[#1a4d5c]","to-[#0098A8]","rounded-t-2xl","sm:rounded-2xl","w-full","max-w-lg","max-h-[90vh]","overflow-y-auto","shadow-2xl","border-2","border-[#0098A8]",3,"click"],[1,"sticky","top-0","bg-[#10284C]/95","backdrop-blur-md","px-6","py-4","border-b","border-white/20","rounded-t-2xl","sm:rounded-t-2xl"],[1,"flex","items-center","justify-between"],[1,"text-xl","font-bold","text-[#C8D900]"],[1,"p-2","text-white/70","hover:text-white","rounded-lg","hover:bg-white/10","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"p-6","space-y-6"],[1,"inline-flex","px-4","py-2","rounded-full","text-sm","font-bold","mb-4","border-2"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-white/80","text-lg"],[1,"bg-[#0098A8]/20","backdrop-blur-sm","rounded-xl","p-4","border","border-white/20"],[1,"flex","items-center","space-x-3","mb-3"],[1,"bg-[#C8D900]","p-2","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-[#10284C]"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-white/70"],[1,"font-semibold","text-white"],[1,"sticky","bottom-0","bg-[#10284C]/95","backdrop-blur-md","px-6","py-4","border-t","border-white/20","rounded-b-2xl","sm:rounded-b-2xl"],[1,"flex","gap-3"],[1,"flex-1","bg-[#C8D900]","hover:bg-[#d4e820]","text-[#10284C]","px-6","py-3","rounded-xl","font-bold","shadow-xl","transition-all","duration-200","text-center","active:scale-95",3,"click"],[1,"px-6","py-3","text-white","bg-white/10","hover:bg-white/20","rounded-xl","font-bold","transition-colors","border","border-white/20",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-sm","text-white/80"]],template:function(e,a){e&1&&(i(0,"div",0)(1,"div",1),m(2,"img",2)(3,"div",3),n(),M(4,ne,7,0,"div",4)(5,ae,9,1,"div",5)(6,Me,44,16,"main",6)(7,He,86,17,"div",7),n()),e&2&&(l(4),b(a.loading()?4:-1),l(),b(!a.loading()&&a.error()?5:-1),l(),b(!a.loading()&&!a.error()?6:-1),l(),b(a.showModal()&&a.selectedEventDetails()?7:-1))},dependencies:[R,W,Y],styles:[".calendar-day[_ngcontent-%COMP%]{min-height:80px}.calendar-event[_ngcontent-%COMP%]{font-size:.75rem;padding:.25rem .5rem;margin-bottom:.25rem;border-radius:.375rem;border-width:1px;cursor:pointer;transition:all .15s ease-in-out}.calendar-event[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px #0000001a;transform:translateY(-1px)}.alert-urgent[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-red 2s infinite}@keyframes _ngcontent-%COMP%_pulse-red{0%,to{background-color:#ef44441a}50%{background-color:#ef444433}}@media (max-width: 640px){.calendar-day[_ngcontent-%COMP%]{min-height:70px;padding:.25rem}.calendar-event[_ngcontent-%COMP%]{font-size:.6875rem;padding:.125rem .375rem}}"]})};export{K as AgendaTecnicoComponent};
