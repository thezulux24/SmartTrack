import{a as j,b as A}from"./chunk-LMUUKZWU.js";import{a as V}from"./chunk-EL2KGOMZ.js";import"./chunk-WUZJU462.js";import{j as Q,p as I,u as M}from"./chunk-WKDYGGS7.js";import{$ as h,Ab as _,Ia as r,S as k,Sa as y,Wb as D,Xa as f,Y as x,Z as v,_ as E,cb as T,fb as b,hb as p,kb as L,la as g,lb as R,mb as t,nb as i,ob as u,pb as C,sb as c,tb as d,yb as o,zb as m}from"./chunk-D2JNWC2G.js";import"./chunk-X5YLR3NI.js";import{i as S}from"./chunk-ODN5LVDJ.js";var q=(l,n)=>n.id;function H(l,n){if(l&1&&(t(0,"div",23),o(1),i()),l&2){let e=d();r(),_(" ",e.error()," ")}}function $(l,n){l&1&&(t(0,"div",24),u(1,"div",28),t(2,"p",29),o(3,"Cargando env\xEDos..."),i()())}function N(l,n){l&1&&(t(0,"div",25)(1,"div",30),o(2,"\u{1F4ED}"),i(),t(3,"h3",31),o(4,"No hay env\xEDos activos"),i(),t(5,"p",32),o(6,"Los env\xEDos programados y en tr\xE1nsito aparecer\xE1n aqu\xED"),i()())}function z(l,n){if(l&1){let e=C();t(0,"button",49),c("click",function(){x(e);let s=d().$implicit,w=d(2);return v(w.iniciarEnvio(s))}),o(1," Iniciar Env\xEDo "),i()}}function P(l,n){if(l&1&&(t(0,"p",47),o(1),i()),l&2){let e=d().$implicit;r(),m(e.mensajero==null?null:e.mensajero.placa)}}function O(l,n){if(l&1&&(t(0,"div",48)(1,"p",45),o(2,"Observaciones"),i(),t(3,"p",32),o(4),i()()),l&2){let e=d().$implicit;r(4),m(e.observaciones)}}function B(l,n){if(l&1){let e=C();t(0,"div",33)(1,"div",34)(2,"div",35)(3,"span",36),o(4),i(),t(5,"div")(6,"h3",37),o(7),i(),t(8,"p",38),o(9),i()()(),t(10,"div",39)(11,"button",40),c("click",function(){let s=x(e).$implicit,w=d(2);return v(w.verQR(s))}),E(),t(12,"svg",15),u(13,"path",41),i(),o(14," Ver QR "),i(),f(15,z,2,0,"button",42),i()(),h(),t(16,"div",43)(17,"div",44)(18,"p",45),o(19,"Mensajero"),i(),t(20,"p",46),o(21),i(),t(22,"p",38),o(23),i(),f(24,P,2,1,"p",47),i(),t(25,"div",44)(26,"p",45),o(27,"Destino"),i(),t(28,"p",46),o(29),i(),t(30,"p",38),o(31),i()(),t(32,"div",44)(33,"p",45),o(34,"Contacto"),i(),t(35,"p",46),o(36),i(),t(37,"p",38),o(38),i()(),t(39,"div",44)(40,"p",45),o(41,"Fecha Programada"),i(),t(42,"p",46),o(43),i()(),t(44,"div",44)(45,"p",45),o(46,"Hora de Salida"),i(),t(47,"p",46),o(48),i()(),t(49,"div",44)(50,"p",45),o(51,"Hora de Llegada"),i(),t(52,"p",46),o(53),i()()(),f(54,O,5,1,"div",48),i()}if(l&2){let e=n.$implicit,a=d(2);r(3),b(a.getEstadoBadgeClass(e.estado)),r(),_(" ",a.getEstadoTexto(e.estado)," "),r(3),_(" Kit ",(e.kit==null?null:e.kit.numero_kit)||"N/A"," "),r(2),_(" Cirug\xEDa: ",(e.kit==null||e.kit.cirugia==null?null:e.kit.cirugia.numero_cirugia)||"N/A"," "),r(6),p(e.estado==="programado"?15:-1),r(6),m((e.mensajero==null?null:e.mensajero.nombre)||"N/A"),r(2),m((e.mensajero==null?null:e.mensajero.telefono)||""),r(),p(e.mensajero!=null&&e.mensajero.placa?24:-1),r(5),m((e.kit==null||e.kit.cirugia==null||e.kit.cirugia.hospital==null?null:e.kit.cirugia.hospital.nombre)||"N/A"),r(2),m(e.direccion_destino),r(5),m(e.contacto_destino||"N/A"),r(2),m(e.telefono_destino||""),r(5),m(a.formatearFecha(e.fecha_programada)),r(5),_(" ",e.hora_salida?a.formatearHora(e.hora_salida):"Pendiente"," "),r(5),_(" ",e.hora_llegada?a.formatearHora(e.hora_llegada):"Pendiente"," "),r(),p(e.observaciones?54:-1)}}function G(l,n){if(l&1&&(t(0,"div",26),L(1,B,55,17,"div",33,q),i()),l&2){let e=d();r(),R(e.enviosFiltrados())}}function U(l,n){if(l&1){let e=C();t(0,"div",50),c("click",function(){x(e);let s=d();return v(s.cerrarQR())}),t(1,"div",51),c("click",function(s){return x(e),v(s.stopPropagation())}),t(2,"div",52)(3,"h3",53),o(4,"C\xF3digo QR del Kit"),i(),t(5,"button",54),c("click",function(){x(e);let s=d();return v(s.cerrarQR())}),E(),t(6,"svg",55),u(7,"path",56),i()()(),h(),t(8,"div",57),u(9,"qrcode",58),i(),t(10,"div",59)(11,"p",60),o(12,"C\xF3digo:"),i(),t(13,"p",61),o(14),i(),t(15,"p",62),o(16,"URL de validaci\xF3n:"),i(),t(17,"p",63),o(18),i()(),t(19,"div",64)(20,"button",65),c("click",function(){x(e);let s=d();return v(s.descargarQR())}),o(21," Descargar QR "),i(),t(22,"button",66),c("click",function(){x(e);let s=d();return v(s.cerrarQR())}),o(23," Cerrar "),i()()()()}if(l&2){let e=d();r(9),T("qrdata",e.urlQR())("width",256)("errorCorrectionLevel","M")("elementType","canvas"),r(5),m(e.codigoQR()),r(4),m(e.urlQR())}}var F=class l{router=k(I);envioService=k(V);envios=g([]);cargando=g(!0);error=g(null);filtroEstado=g("todos");mostrarQR=g(null);codigoQR=g("");urlQR=g("");enviosFiltrados=D(()=>{let n=this.filtroEstado();return n==="todos"?this.envios():this.envios().filter(e=>e.estado===n)});ngOnInit(){this.cargarEnvios()}cargarEnvios(){this.cargando.set(!0),this.error.set(null),this.envioService.getEnviosActivos().subscribe({next:n=>{console.log("Env\xEDos activos:",n),this.envios.set(n),this.cargando.set(!1)},error:n=>{console.error("Error cargando env\xEDos:",n),this.error.set("Error al cargar env\xEDos activos"),this.cargando.set(!1)}})}iniciarEnvio(n){return S(this,null,function*(){if(confirm(`\xBFIniciar env\xEDo del kit ${n.kit?.numero_kit}?
El mensajero ${n.mensajero?.nombre} comenzar\xE1 el trayecto.`))try{let e=yield this.envioService.iniciarEnvio(n.id);e.exito?(alert("Env\xEDo iniciado exitosamente"),this.cargarEnvios()):alert(e.mensaje||"Error al iniciar env\xEDo")}catch(e){console.error("Error iniciando env\xEDo:",e),alert("Error al iniciar el env\xEDo")}})}volver(){this.router.navigate(["/internal/logistica"])}getEstadoBadgeClass(n){switch(n){case"programado":return"bg-yellow-500/20 text-yellow-300 border-yellow-500";case"en_transito":return"bg-blue-500/20 text-blue-300 border-blue-500";case"entregado":return"bg-green-500/20 text-green-300 border-green-500";default:return"bg-gray-500/20 text-gray-300 border-gray-500"}}getEstadoTexto(n){switch(n){case"programado":return"Programado";case"en_transito":return"En Tr\xE1nsito";case"entregado":return"Entregado";default:return n}}formatearFecha(n){return n?new Date(n).toLocaleDateString("es-CO"):"N/A"}formatearHora(n){return n?new Date(n).toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"}):"N/A"}verQR(n){if(!n.kit?.codigo_qr){alert("Este kit no tiene c\xF3digo QR asignado");return}this.mostrarQR.set(n.kit.id),this.codigoQR.set(n.kit.codigo_qr),this.urlQR.set(`${M.PUBLIC_URL}/qr/${n.kit.codigo_qr}`)}cerrarQR(){this.mostrarQR.set(null),this.codigoQR.set(""),this.urlQR.set("")}descargarQR(){let n=document.querySelector("qrcode canvas");if(n){let e=n.toDataURL("image/png"),a=document.createElement("a");a.download=`QR-${this.codigoQR()}.png`,a.href=e,a.click()}}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=y({type:l,selectors:[["app-envios-transito-list"]],decls:36,vars:11,consts:[[1,"min-h-screen","relative","overflow-hidden"],[1,"absolute","inset-0","z-0"],[1,"absolute","inset-0","bg-[#10284C]"],["xmlns","http://www.w3.org/2000/svg",1,"absolute","w-full","h-full"],["cx","10%","cy","15%","r","120","fill","#0098A8","opacity","0.1"],["cx","85%","cy","25%","r","180","fill","#C8D900","opacity","0.08"],["cx","50%","cy","80%","r","150","fill","#0098A8","opacity","0.12"],["x","60%","y","5%","width","200","height","200","fill","#0098A8","opacity","0.06","transform","rotate(45 70 15)"],["x","15%","y","65%","width","160","height","160","fill","#C8D900","opacity","0.08","transform","rotate(30 20 70)"],[1,"absolute","inset-0","bg-gradient-to-b","from-[#10284C]/50","via-[#10284C]/80","to-[#10284C]/95"],[1,"relative","z-10","px-4","py-6"],[1,"max-w-6xl","mx-auto","space-y-6"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","gap-4"],["src","https://www.implameq.com/wp-content/uploads/logotipo-impla-300x78.png.webp","alt","Implameq",1,"h-10","w-auto","brightness-0","invert"],[1,"px-4","py-2","bg-[#C8D900]","text-[#10284C]","rounded-lg","hover:bg-[#d4e820]","transition-colors","font-medium","flex","items-center","gap-2","active:scale-95",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"hidden","sm:inline"],[1,"text-center"],[1,"text-4xl","md:text-5xl","font-bold","text-white","mb-2"],[1,"text-gray-300","text-lg"],[1,"flex","justify-center","gap-3","flex-wrap"],[1,"px-4","py-2","rounded-lg","font-medium","transition-all",3,"click"],[1,"bg-red-500/20","border","border-red-500","text-red-100","p-4","rounded-lg","text-center"],[1,"text-center","py-12"],[1,"bg-white/5","backdrop-blur-sm","rounded-2xl","border","border-white/10","p-12","text-center"],[1,"grid","grid-cols-1","gap-6"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4","bg-black/70","backdrop-blur-sm"],[1,"inline-block","animate-spin","rounded-full","h-12","w-12","border-4","border-[#C8D900]","border-t-transparent"],[1,"text-white","mt-4"],[1,"text-6xl","mb-4"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-gray-300"],[1,"bg-white/5","backdrop-blur-sm","rounded-2xl","border","border-white/10","p-6","hover:border-[#0098A8]","transition-all"],[1,"flex","flex-col","lg:flex-row","lg:items-center","justify-between","gap-4","mb-4"],[1,"flex","items-center","gap-4"],[1,"px-3","py-1","rounded-full","text-sm","font-medium","border"],[1,"text-xl","font-bold","text-white"],[1,"text-gray-300","text-sm"],[1,"flex","gap-2"],[1,"px-4","py-2","bg-gradient-to-r","from-[#C8D900]","to-[#d4e820]","text-[#10284C]","rounded-lg","hover:shadow-lg","hover:shadow-[#C8D900]/50","transition-all","font-medium","flex","items-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"],[1,"px-4","py-2","bg-gradient-to-r","from-[#0098A8]","to-[#00b8c8]","text-white","rounded-lg","hover:shadow-lg","hover:shadow-[#0098A8]/50","transition-all","font-medium"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"bg-white/5","rounded-lg","p-4"],[1,"text-gray-400","text-sm","mb-1"],[1,"text-white","font-medium"],[1,"text-[#C8D900]","text-sm","font-mono"],[1,"mt-4","bg-white/5","rounded-lg","p-4"],[1,"px-4","py-2","bg-gradient-to-r","from-[#0098A8]","to-[#00b8c8]","text-white","rounded-lg","hover:shadow-lg","hover:shadow-[#0098A8]/50","transition-all","font-medium",3,"click"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4","bg-black/70","backdrop-blur-sm",3,"click"],[1,"bg-white","rounded-2xl","shadow-2xl","max-w-md","w-full","p-6","transform","transition-all",3,"click"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-[#10284C]"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"bg-white","p-6","rounded-xl","border-4","border-[#0098A8]","mb-4","flex","justify-center"],[3,"qrdata","width","errorCorrectionLevel","elementType"],[1,"bg-gray-50","rounded-lg","p-4","mb-4"],[1,"text-sm","text-gray-600","mb-2"],[1,"text-lg","font-mono","font-bold","text-[#10284C]","break-all"],[1,"text-sm","text-gray-600","mt-3","mb-1"],[1,"text-xs","text-gray-500","break-all"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-3","bg-gradient-to-r","from-[#C8D900]","to-[#d4e820]","text-[#10284C]","rounded-lg","hover:shadow-lg","transition-all","font-semibold",3,"click"],[1,"flex-1","px-4","py-3","bg-gray-200","text-gray-700","rounded-lg","hover:bg-gray-300","transition-all","font-semibold",3,"click"]],template:function(e,a){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),E(),t(3,"svg",3),u(4,"circle",4)(5,"circle",5)(6,"circle",6)(7,"rect",7)(8,"rect",8),i()(),h(),u(9,"div",9),i(),t(10,"main",10)(11,"div",11)(12,"div",12),u(13,"img",13),t(14,"button",14),c("click",function(){return a.volver()}),E(),t(15,"svg",15),u(16,"path",16),i(),h(),t(17,"span",17),o(18,"Volver"),i()()(),t(19,"div",18)(20,"h1",19),o(21," Env\xEDos en Tr\xE1nsito "),i(),t(22,"p",20),o(23,"Monitoreo de kits en proceso de entrega"),i()(),t(24,"div",21)(25,"button",22),c("click",function(){return a.filtroEstado.set("todos")}),o(26," Todos "),i(),t(27,"button",22),c("click",function(){return a.filtroEstado.set("programado")}),o(28," Programados "),i(),t(29,"button",22),c("click",function(){return a.filtroEstado.set("en_transito")}),o(30," En Tr\xE1nsito "),i()(),f(31,H,2,1,"div",23)(32,$,4,0,"div",24)(33,N,7,0,"div",25)(34,G,3,0,"div",26),i()(),f(35,U,24,6,"div",27),i()),e&2&&(r(25),b(a.filtroEstado()==="todos"?"bg-[#C8D900] text-[#10284C]":"bg-white/10 text-white hover:bg-white/20"),r(2),b(a.filtroEstado()==="programado"?"bg-[#C8D900] text-[#10284C]":"bg-white/10 text-white hover:bg-white/20"),r(2),b(a.filtroEstado()==="en_transito"?"bg-[#C8D900] text-[#10284C]":"bg-white/10 text-white hover:bg-white/20"),r(2),p(a.error()?31:-1),r(),p(a.cargando()?32:-1),r(),p(!a.cargando()&&a.enviosFiltrados().length===0?33:-1),r(),p(!a.cargando()&&a.enviosFiltrados().length>0?34:-1),r(),p(a.mostrarQR()?35:-1))},dependencies:[Q,A,j],encapsulation:2})};export{F as EnviosTransitoListComponent};
