import{a as Kt}from"./chunk-BKJ6I3FY.js";import{a as Tt,c as It,g as kt,i as Bt,j as At,o as Lt,p as Rt,q as qt,r as Nt,s as Dt,w as Vt,x as Ft,y as Ut}from"./chunk-DRTBTDHH.js";import{$ as _,Aa as we,B as ct,Ca as bt,E as T,G as m,Ga as _t,H as dt,I as Ae,J as pe,Ja as xt,K as ut,La as yt,Ma as vt,N as H,Oa as Et,Pa as St,Q as y,Sa as Mt,T as ft,Ta as Pt,U as R,X as Le,Y as Re,Z as c,_ as d,aa as ae,ba as Y,ca as v,da as ht,ea as mt,fa as pt,ha as u,ia as I,ja as ge,ka as qe,ma as $,na as Z,oa as X,r as st,sa as gt,ta as wt,u as W,v as lt,va as Ct,w as S,x as M,y as L,z as V}from"./chunk-IAYZCRTW.js";import"./chunk-LJ5XHLMQ.js";import{d as w,f as Wi,h as A}from"./chunk-FK42CRUA.js";var Ht=w((ar,zt)=>{"use strict";zt.exports=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}});var F=w(Q=>{"use strict";var Ne,Yi=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Q.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};Q.getSymbolTotalCodewords=function(e){return Yi[e]};Q.getBCHDigit=function(n){let e=0;for(;n!==0;)e++,n>>>=1;return e};Q.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Ne=e};Q.isKanjiModeEnabled=function(){return typeof Ne<"u"};Q.toSJIS=function(e){return Ne(e)}});var Ce=w(E=>{"use strict";E.L={bit:1};E.M={bit:0};E.Q={bit:3};E.H={bit:2};function $i(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return E.L;case"m":case"medium":return E.M;case"q":case"quartile":return E.Q;case"h":case"high":return E.H;default:throw new Error("Unknown EC Level: "+n)}}E.isValid=function(e){return e&&typeof e.bit<"u"&&e.bit>=0&&e.bit<4};E.from=function(e,t){if(E.isValid(e))return e;try{return $i(e)}catch{return t}}});var Ot=w((cr,jt)=>{"use strict";function Qt(){this.buffer=[],this.length=0}Qt.prototype={get:function(n){let e=Math.floor(n/8);return(this.buffer[e]>>>7-n%8&1)===1},put:function(n,e){for(let t=0;t<e;t++)this.putBit((n>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){let e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),n&&(this.buffer[e]|=128>>>this.length%8),this.length++}};jt.exports=Qt});var Jt=w((dr,Gt)=>{"use strict";function se(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}se.prototype.set=function(n,e,t,i){let r=n*this.size+e;this.data[r]=t,i&&(this.reservedBit[r]=!0)};se.prototype.get=function(n,e){return this.data[n*this.size+e]};se.prototype.xor=function(n,e,t){this.data[n*this.size+e]^=t};se.prototype.isReserved=function(n,e){return this.reservedBit[n*this.size+e]};Gt.exports=se});var Wt=w(be=>{"use strict";var Zi=F().getSymbolSize;be.getRowColCoords=function(e){if(e===1)return[];let t=Math.floor(e/7)+2,i=Zi(e),r=i===145?26:Math.ceil((i-13)/(2*t-2))*2,o=[i-7];for(let a=1;a<t-1;a++)o[a]=o[a-1]-r;return o.push(6),o.reverse()};be.getPositions=function(e){let t=[],i=be.getRowColCoords(e),r=i.length;for(let o=0;o<r;o++)for(let a=0;a<r;a++)o===0&&a===0||o===0&&a===r-1||o===r-1&&a===0||t.push([i[o],i[a]]);return t}});var Zt=w($t=>{"use strict";var Xi=F().getSymbolSize,Yt=7;$t.getPositions=function(e){let t=Xi(e);return[[0,0],[t-Yt,0],[0,t-Yt]]}});var Xt=w(C=>{"use strict";C.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var j={N1:3,N2:3,N3:40,N4:10};C.isValid=function(e){return e!=null&&e!==""&&!isNaN(e)&&e>=0&&e<=7};C.from=function(e){return C.isValid(e)?parseInt(e,10):void 0};C.getPenaltyN1=function(e){let t=e.size,i=0,r=0,o=0,a=null,s=null;for(let l=0;l<t;l++){r=o=0,a=s=null;for(let f=0;f<t;f++){let h=e.get(l,f);h===a?r++:(r>=5&&(i+=j.N1+(r-5)),a=h,r=1),h=e.get(f,l),h===s?o++:(o>=5&&(i+=j.N1+(o-5)),s=h,o=1)}r>=5&&(i+=j.N1+(r-5)),o>=5&&(i+=j.N1+(o-5))}return i};C.getPenaltyN2=function(e){let t=e.size,i=0;for(let r=0;r<t-1;r++)for(let o=0;o<t-1;o++){let a=e.get(r,o)+e.get(r,o+1)+e.get(r+1,o)+e.get(r+1,o+1);(a===4||a===0)&&i++}return i*j.N2};C.getPenaltyN3=function(e){let t=e.size,i=0,r=0,o=0;for(let a=0;a<t;a++){r=o=0;for(let s=0;s<t;s++)r=r<<1&2047|e.get(a,s),s>=10&&(r===1488||r===93)&&i++,o=o<<1&2047|e.get(s,a),s>=10&&(o===1488||o===93)&&i++}return i*j.N3};C.getPenaltyN4=function(e){let t=0,i=e.data.length;for(let o=0;o<i;o++)t+=e.data[o];return Math.abs(Math.ceil(t*100/i/5)-10)*j.N4};function en(n,e,t){switch(n){case C.Patterns.PATTERN000:return(e+t)%2===0;case C.Patterns.PATTERN001:return e%2===0;case C.Patterns.PATTERN010:return t%3===0;case C.Patterns.PATTERN011:return(e+t)%3===0;case C.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(t/3))%2===0;case C.Patterns.PATTERN101:return e*t%2+e*t%3===0;case C.Patterns.PATTERN110:return(e*t%2+e*t%3)%2===0;case C.Patterns.PATTERN111:return(e*t%3+(e+t)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}C.applyMask=function(e,t){let i=t.size;for(let r=0;r<i;r++)for(let o=0;o<i;o++)t.isReserved(o,r)||t.xor(o,r,en(e,o,r))};C.getBestMask=function(e,t){let i=Object.keys(C.Patterns).length,r=0,o=1/0;for(let a=0;a<i;a++){t(a),C.applyMask(a,e);let s=C.getPenaltyN1(e)+C.getPenaltyN2(e)+C.getPenaltyN3(e)+C.getPenaltyN4(e);C.applyMask(a,e),s<o&&(o=s,r=a)}return r}});var Ve=w(De=>{"use strict";var U=Ce(),_e=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],xe=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];De.getBlocksCount=function(e,t){switch(t){case U.L:return _e[(e-1)*4+0];case U.M:return _e[(e-1)*4+1];case U.Q:return _e[(e-1)*4+2];case U.H:return _e[(e-1)*4+3];default:return}};De.getTotalCodewordsCount=function(e,t){switch(t){case U.L:return xe[(e-1)*4+0];case U.M:return xe[(e-1)*4+1];case U.Q:return xe[(e-1)*4+2];case U.H:return xe[(e-1)*4+3];default:return}}});var ei=w(ve=>{"use strict";var le=new Uint8Array(512),ye=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)le[t]=e,ye[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)le[t]=le[t-255]})();ve.log=function(e){if(e<1)throw new Error("log("+e+")");return ye[e]};ve.exp=function(e){return le[e]};ve.mul=function(e,t){return e===0||t===0?0:le[ye[e]+ye[t]]}});var ti=w(ce=>{"use strict";var Fe=ei();ce.mul=function(e,t){let i=new Uint8Array(e.length+t.length-1);for(let r=0;r<e.length;r++)for(let o=0;o<t.length;o++)i[r+o]^=Fe.mul(e[r],t[o]);return i};ce.mod=function(e,t){let i=new Uint8Array(e);for(;i.length-t.length>=0;){let r=i[0];for(let a=0;a<t.length;a++)i[a]^=Fe.mul(t[a],r);let o=0;for(;o<i.length&&i[o]===0;)o++;i=i.slice(o)}return i};ce.generateECPolynomial=function(e){let t=new Uint8Array([1]);for(let i=0;i<e;i++)t=ce.mul(t,new Uint8Array([1,Fe.exp(i)]));return t}});var ri=w((wr,ni)=>{"use strict";var ii=ti();function Ue(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}Ue.prototype.initialize=function(e){this.degree=e,this.genPoly=ii.generateECPolynomial(this.degree)};Ue.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let i=ii.mod(t,this.genPoly),r=this.degree-i.length;if(r>0){let o=new Uint8Array(this.degree);return o.set(i,r),o}return i};ni.exports=Ue});var Ke=w(oi=>{"use strict";oi.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}});var ze=w(q=>{"use strict";var ai="[0-9]+",tn="[A-Z $%*+\\-./:]+",de="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";de=de.replace(/u/g,"\\u");var nn="(?:(?![A-Z0-9 $%*+\\-./:]|"+de+`)(?:.|[\r
]))+`;q.KANJI=new RegExp(de,"g");q.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");q.BYTE=new RegExp(nn,"g");q.NUMERIC=new RegExp(ai,"g");q.ALPHANUMERIC=new RegExp(tn,"g");var rn=new RegExp("^"+de+"$"),on=new RegExp("^"+ai+"$"),an=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");q.testKanji=function(e){return rn.test(e)};q.testNumeric=function(e){return on.test(e)};q.testAlphanumeric=function(e){return an.test(e)}});var K=w(x=>{"use strict";var sn=Ke(),He=ze();x.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]};x.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};x.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]};x.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]};x.MIXED={bit:-1};x.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!sn.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]};x.getBestModeForData=function(e){return He.testNumeric(e)?x.NUMERIC:He.testAlphanumeric(e)?x.ALPHANUMERIC:He.testKanji(e)?x.KANJI:x.BYTE};x.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")};x.isValid=function(e){return e&&e.bit&&e.ccBits};function ln(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return x.NUMERIC;case"alphanumeric":return x.ALPHANUMERIC;case"kanji":return x.KANJI;case"byte":return x.BYTE;default:throw new Error("Unknown mode: "+n)}}x.from=function(e,t){if(x.isValid(e))return e;try{return ln(e)}catch{return t}}});var ui=w(O=>{"use strict";var Ee=F(),cn=Ve(),si=Ce(),z=K(),Qe=Ke(),ci=7973,li=Ee.getBCHDigit(ci);function dn(n,e,t){for(let i=1;i<=40;i++)if(e<=O.getCapacity(i,t,n))return i}function di(n,e){return z.getCharCountIndicator(n,e)+4}function un(n,e){let t=0;return n.forEach(function(i){let r=di(i.mode,e);t+=r+i.getBitsLength()}),t}function fn(n,e){for(let t=1;t<=40;t++)if(un(n,t)<=O.getCapacity(t,e,z.MIXED))return t}O.from=function(e,t){return Qe.isValid(e)?parseInt(e,10):t};O.getCapacity=function(e,t,i){if(!Qe.isValid(e))throw new Error("Invalid QR Code version");typeof i>"u"&&(i=z.BYTE);let r=Ee.getSymbolTotalCodewords(e),o=cn.getTotalCodewordsCount(e,t),a=(r-o)*8;if(i===z.MIXED)return a;let s=a-di(i,e);switch(i){case z.NUMERIC:return Math.floor(s/10*3);case z.ALPHANUMERIC:return Math.floor(s/11*2);case z.KANJI:return Math.floor(s/13);case z.BYTE:default:return Math.floor(s/8)}};O.getBestVersionForData=function(e,t){let i,r=si.from(t,si.M);if(Array.isArray(e)){if(e.length>1)return fn(e,r);if(e.length===0)return 1;i=e[0]}else i=e;return dn(i.mode,i.getLength(),r)};O.getEncodedBits=function(e){if(!Qe.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;for(;Ee.getBCHDigit(t)-li>=0;)t^=ci<<Ee.getBCHDigit(t)-li;return e<<12|t}});var pi=w(mi=>{"use strict";var je=F(),hi=1335,hn=21522,fi=je.getBCHDigit(hi);mi.getEncodedBits=function(e,t){let i=e.bit<<3|t,r=i<<10;for(;je.getBCHDigit(r)-fi>=0;)r^=hi<<je.getBCHDigit(r)-fi;return(i<<10|r)^hn}});var wi=w((vr,gi)=>{"use strict";var mn=K();function ee(n){this.mode=mn.NUMERIC,this.data=n.toString()}ee.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};ee.prototype.getLength=function(){return this.data.length};ee.prototype.getBitsLength=function(){return ee.getBitsLength(this.data.length)};ee.prototype.write=function(e){let t,i,r;for(t=0;t+3<=this.data.length;t+=3)i=this.data.substr(t,3),r=parseInt(i,10),e.put(r,10);let o=this.data.length-t;o>0&&(i=this.data.substr(t),r=parseInt(i,10),e.put(r,o*3+1))};gi.exports=ee});var bi=w((Er,Ci)=>{"use strict";var pn=K(),Oe=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function te(n){this.mode=pn.ALPHANUMERIC,this.data=n}te.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};te.prototype.getLength=function(){return this.data.length};te.prototype.getBitsLength=function(){return te.getBitsLength(this.data.length)};te.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let i=Oe.indexOf(this.data[t])*45;i+=Oe.indexOf(this.data[t+1]),e.put(i,11)}this.data.length%2&&e.put(Oe.indexOf(this.data[t]),6)};Ci.exports=te});var xi=w((Sr,_i)=>{"use strict";_i.exports=function(e){for(var t=[],i=e.length,r=0;r<i;r++){var o=e.charCodeAt(r);if(o>=55296&&o<=56319&&i>r+1){var a=e.charCodeAt(r+1);a>=56320&&a<=57343&&(o=(o-55296)*1024+a-56320+65536,r+=1)}if(o<128){t.push(o);continue}if(o<2048){t.push(o>>6|192),t.push(o&63|128);continue}if(o<55296||o>=57344&&o<65536){t.push(o>>12|224),t.push(o>>6&63|128),t.push(o&63|128);continue}if(o>=65536&&o<=1114111){t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128);continue}t.push(239,191,189)}return new Uint8Array(t).buffer}});var vi=w((Mr,yi)=>{"use strict";var gn=xi(),wn=K();function ie(n){this.mode=wn.BYTE,typeof n=="string"&&(n=gn(n)),this.data=new Uint8Array(n)}ie.getBitsLength=function(e){return e*8};ie.prototype.getLength=function(){return this.data.length};ie.prototype.getBitsLength=function(){return ie.getBitsLength(this.data.length)};ie.prototype.write=function(n){for(let e=0,t=this.data.length;e<t;e++)n.put(this.data[e],8)};yi.exports=ie});var Si=w((Pr,Ei)=>{"use strict";var Cn=K(),bn=F();function ne(n){this.mode=Cn.KANJI,this.data=n}ne.getBitsLength=function(e){return e*13};ne.prototype.getLength=function(){return this.data.length};ne.prototype.getBitsLength=function(){return ne.getBitsLength(this.data.length)};ne.prototype.write=function(n){let e;for(e=0;e<this.data.length;e++){let t=bn.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),n.put(t,13)}};Ei.exports=ne});var Mi=w((Tr,Ge)=>{"use strict";var ue={single_source_shortest_paths:function(n,e,t){var i={},r={};r[e]=0;var o=ue.PriorityQueue.make();o.push(e,0);for(var a,s,l,f,h,b,p,P,N;!o.empty();){a=o.pop(),s=a.value,f=a.cost,h=n[s]||{};for(l in h)h.hasOwnProperty(l)&&(b=h[l],p=f+b,P=r[l],N=typeof r[l]>"u",(N||P>p)&&(r[l]=p,o.push(l,p),i[l]=s))}if(typeof t<"u"&&typeof r[t]>"u"){var D=["Could not find a path from ",e," to ",t,"."].join("");throw new Error(D)}return i},extract_shortest_path_from_predecessor_list:function(n,e){for(var t=[],i=e,r;i;)t.push(i),r=n[i],i=n[i];return t.reverse(),t},find_path:function(n,e,t){var i=ue.single_source_shortest_paths(n,e,t);return ue.extract_shortest_path_from_predecessor_list(i,t)},PriorityQueue:{make:function(n){var e=ue.PriorityQueue,t={},i;n=n||{};for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.queue=[],t.sorter=n.sorter||e.default_sorter,t},default_sorter:function(n,e){return n.cost-e.cost},push:function(n,e){var t={value:n,cost:e};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};typeof Ge<"u"&&(Ge.exports=ue)});var Ri=w(re=>{"use strict";var g=K(),Ii=wi(),ki=bi(),Bi=vi(),Ai=Si(),fe=ze(),Se=F(),_n=Mi();function Pi(n){return unescape(encodeURIComponent(n)).length}function he(n,e,t){let i=[],r;for(;(r=n.exec(t))!==null;)i.push({data:r[0],index:r.index,mode:e,length:r[0].length});return i}function Li(n){let e=he(fe.NUMERIC,g.NUMERIC,n),t=he(fe.ALPHANUMERIC,g.ALPHANUMERIC,n),i,r;return Se.isKanjiModeEnabled()?(i=he(fe.BYTE,g.BYTE,n),r=he(fe.KANJI,g.KANJI,n)):(i=he(fe.BYTE_KANJI,g.BYTE,n),r=[]),e.concat(t,i,r).sort(function(a,s){return a.index-s.index}).map(function(a){return{data:a.data,mode:a.mode,length:a.length}})}function Je(n,e){switch(e){case g.NUMERIC:return Ii.getBitsLength(n);case g.ALPHANUMERIC:return ki.getBitsLength(n);case g.KANJI:return Ai.getBitsLength(n);case g.BYTE:return Bi.getBitsLength(n)}}function xn(n){return n.reduce(function(e,t){let i=e.length-1>=0?e[e.length-1]:null;return i&&i.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)},[])}function yn(n){let e=[];for(let t=0;t<n.length;t++){let i=n[t];switch(i.mode){case g.NUMERIC:e.push([i,{data:i.data,mode:g.ALPHANUMERIC,length:i.length},{data:i.data,mode:g.BYTE,length:i.length}]);break;case g.ALPHANUMERIC:e.push([i,{data:i.data,mode:g.BYTE,length:i.length}]);break;case g.KANJI:e.push([i,{data:i.data,mode:g.BYTE,length:Pi(i.data)}]);break;case g.BYTE:e.push([{data:i.data,mode:g.BYTE,length:Pi(i.data)}])}}return e}function vn(n,e){let t={},i={start:{}},r=["start"];for(let o=0;o<n.length;o++){let a=n[o],s=[];for(let l=0;l<a.length;l++){let f=a[l],h=""+o+l;s.push(h),t[h]={node:f,lastCount:0},i[h]={};for(let b=0;b<r.length;b++){let p=r[b];t[p]&&t[p].node.mode===f.mode?(i[p][h]=Je(t[p].lastCount+f.length,f.mode)-Je(t[p].lastCount,f.mode),t[p].lastCount+=f.length):(t[p]&&(t[p].lastCount=f.length),i[p][h]=Je(f.length,f.mode)+4+g.getCharCountIndicator(f.mode,e))}}r=s}for(let o=0;o<r.length;o++)i[r[o]].end=0;return{map:i,table:t}}function Ti(n,e){let t,i=g.getBestModeForData(n);if(t=g.from(e,i),t!==g.BYTE&&t.bit<i.bit)throw new Error('"'+n+'" cannot be encoded with mode '+g.toString(t)+`.
 Suggested mode is: `+g.toString(i));switch(t===g.KANJI&&!Se.isKanjiModeEnabled()&&(t=g.BYTE),t){case g.NUMERIC:return new Ii(n);case g.ALPHANUMERIC:return new ki(n);case g.KANJI:return new Ai(n);case g.BYTE:return new Bi(n)}}re.fromArray=function(e){return e.reduce(function(t,i){return typeof i=="string"?t.push(Ti(i,null)):i.data&&t.push(Ti(i.data,i.mode)),t},[])};re.fromString=function(e,t){let i=Li(e,Se.isKanjiModeEnabled()),r=yn(i),o=vn(r,t),a=_n.find_path(o.map,"start","end"),s=[];for(let l=1;l<a.length-1;l++)s.push(o.table[a[l]].node);return re.fromArray(xn(s))};re.rawSplit=function(e){return re.fromArray(Li(e,Se.isKanjiModeEnabled()))}});var Ni=w(qi=>{"use strict";var Pe=F(),We=Ce(),En=Ot(),Sn=Jt(),Mn=Wt(),Pn=Zt(),Ze=Xt(),Xe=Ve(),Tn=ri(),Me=ui(),In=pi(),kn=K(),Ye=Ri();function Bn(n,e){let t=n.size,i=Pn.getPositions(e);for(let r=0;r<i.length;r++){let o=i[r][0],a=i[r][1];for(let s=-1;s<=7;s++)if(!(o+s<=-1||t<=o+s))for(let l=-1;l<=7;l++)a+l<=-1||t<=a+l||(s>=0&&s<=6&&(l===0||l===6)||l>=0&&l<=6&&(s===0||s===6)||s>=2&&s<=4&&l>=2&&l<=4?n.set(o+s,a+l,!0,!0):n.set(o+s,a+l,!1,!0))}}function An(n){let e=n.size;for(let t=8;t<e-8;t++){let i=t%2===0;n.set(t,6,i,!0),n.set(6,t,i,!0)}}function Ln(n,e){let t=Mn.getPositions(e);for(let i=0;i<t.length;i++){let r=t[i][0],o=t[i][1];for(let a=-2;a<=2;a++)for(let s=-2;s<=2;s++)a===-2||a===2||s===-2||s===2||a===0&&s===0?n.set(r+a,o+s,!0,!0):n.set(r+a,o+s,!1,!0)}}function Rn(n,e){let t=n.size,i=Me.getEncodedBits(e),r,o,a;for(let s=0;s<18;s++)r=Math.floor(s/3),o=s%3+t-8-3,a=(i>>s&1)===1,n.set(r,o,a,!0),n.set(o,r,a,!0)}function $e(n,e,t){let i=n.size,r=In.getEncodedBits(e,t),o,a;for(o=0;o<15;o++)a=(r>>o&1)===1,o<6?n.set(o,8,a,!0):o<8?n.set(o+1,8,a,!0):n.set(i-15+o,8,a,!0),o<8?n.set(8,i-o-1,a,!0):o<9?n.set(8,15-o-1+1,a,!0):n.set(8,15-o-1,a,!0);n.set(i-8,8,1,!0)}function qn(n,e){let t=n.size,i=-1,r=t-1,o=7,a=0;for(let s=t-1;s>0;s-=2)for(s===6&&s--;;){for(let l=0;l<2;l++)if(!n.isReserved(r,s-l)){let f=!1;a<e.length&&(f=(e[a]>>>o&1)===1),n.set(r,s-l,f),o--,o===-1&&(a++,o=7)}if(r+=i,r<0||t<=r){r-=i,i=-i;break}}}function Nn(n,e,t){let i=new En;t.forEach(function(l){i.put(l.mode.bit,4),i.put(l.getLength(),kn.getCharCountIndicator(l.mode,n)),l.write(i)});let r=Pe.getSymbolTotalCodewords(n),o=Xe.getTotalCodewordsCount(n,e),a=(r-o)*8;for(i.getLengthInBits()+4<=a&&i.put(0,4);i.getLengthInBits()%8!==0;)i.putBit(0);let s=(a-i.getLengthInBits())/8;for(let l=0;l<s;l++)i.put(l%2?17:236,8);return Dn(i,n,e)}function Dn(n,e,t){let i=Pe.getSymbolTotalCodewords(e),r=Xe.getTotalCodewordsCount(e,t),o=i-r,a=Xe.getBlocksCount(e,t),s=i%a,l=a-s,f=Math.floor(i/a),h=Math.floor(o/a),b=h+1,p=f-h,P=new Tn(p),N=0,D=new Array(a),ot=new Array(a),Ie=0,Ji=new Uint8Array(n.buffer);for(let J=0;J<a;J++){let Be=J<l?h:b;D[J]=Ji.slice(N,N+Be),ot[J]=P.encode(D[J]),N+=Be,Ie=Math.max(Ie,Be)}let ke=new Uint8Array(i),at=0,k,B;for(k=0;k<Ie;k++)for(B=0;B<a;B++)k<D[B].length&&(ke[at++]=D[B][k]);for(k=0;k<p;k++)for(B=0;B<a;B++)ke[at++]=ot[B][k];return ke}function Vn(n,e,t,i){let r;if(Array.isArray(n))r=Ye.fromArray(n);else if(typeof n=="string"){let f=e;if(!f){let h=Ye.rawSplit(n);f=Me.getBestVersionForData(h,t)}r=Ye.fromString(n,f||40)}else throw new Error("Invalid data");let o=Me.getBestVersionForData(r,t);if(!o)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=o;else if(e<o)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+o+`.
`);let a=Nn(e,t,r),s=Pe.getSymbolSize(e),l=new Sn(s);return Bn(l,e),An(l),Ln(l,e),$e(l,t,0),e>=7&&Rn(l,e),qn(l,a),isNaN(i)&&(i=Ze.getBestMask(l,$e.bind(null,l,t))),Ze.applyMask(i,l),$e(l,t,i),{modules:l,version:e,errorCorrectionLevel:t,maskPattern:i,segments:r}}qi.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let i=We.M,r,o;return typeof t<"u"&&(i=We.from(t.errorCorrectionLevel,We.M),r=Me.from(t.version),o=Ze.from(t.maskPattern),t.toSJISFunc&&Pe.setToSJISFunction(t.toSJISFunc)),Vn(e,r,i,o)}});var et=w(G=>{"use strict";function Di(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let e=n.slice().replace("#","").split("");if(e.length<3||e.length===5||e.length>8)throw new Error("Invalid hex color: "+n);(e.length===3||e.length===4)&&(e=Array.prototype.concat.apply([],e.map(function(i){return[i,i]}))),e.length===6&&e.push("F","F");let t=parseInt(e.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:t&255,hex:"#"+e.slice(0,6).join("")}}G.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=typeof e.margin>"u"||e.margin===null||e.margin<0?4:e.margin,i=e.width&&e.width>=21?e.width:void 0,r=e.scale||4;return{width:i,scale:i?4:r,margin:t,color:{dark:Di(e.color.dark||"#000000ff"),light:Di(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}};G.getScale=function(e,t){return t.width&&t.width>=e+t.margin*2?t.width/(e+t.margin*2):t.scale};G.getImageWidth=function(e,t){let i=G.getScale(e,t);return Math.floor((e+t.margin*2)*i)};G.qrToImageData=function(e,t,i){let r=t.modules.size,o=t.modules.data,a=G.getScale(r,i),s=Math.floor((r+i.margin*2)*a),l=i.margin*a,f=[i.color.light,i.color.dark];for(let h=0;h<s;h++)for(let b=0;b<s;b++){let p=(h*s+b)*4,P=i.color.light;if(h>=l&&b>=l&&h<s-l&&b<s-l){let N=Math.floor((h-l)/a),D=Math.floor((b-l)/a);P=f[o[N*r+D]?1:0]}e[p++]=P.r,e[p++]=P.g,e[p++]=P.b,e[p]=P.a}}});var Vi=w(Te=>{"use strict";var tt=et();function Fn(n,e,t){n.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=t,e.width=t,e.style.height=t+"px",e.style.width=t+"px"}function Un(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}Te.render=function(e,t,i){let r=i,o=t;typeof r>"u"&&(!t||!t.getContext)&&(r=t,t=void 0),t||(o=Un()),r=tt.getOptions(r);let a=tt.getImageWidth(e.modules.size,r),s=o.getContext("2d"),l=s.createImageData(a,a);return tt.qrToImageData(l.data,e,r),Fn(s,o,a),s.putImageData(l,0,0),o};Te.renderToDataURL=function(e,t,i){let r=i;typeof r>"u"&&(!t||!t.getContext)&&(r=t,t=void 0),r||(r={});let o=Te.render(e,t,r),a=r.type||"image/png",s=r.rendererOpts||{};return o.toDataURL(a,s.quality)}});var Ki=w(Ui=>{"use strict";var Kn=et();function Fi(n,e){let t=n.a/255,i=e+'="'+n.hex+'"';return t<1?i+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':i}function it(n,e,t){let i=n+e;return typeof t<"u"&&(i+=" "+t),i}function zn(n,e,t){let i="",r=0,o=!1,a=0;for(let s=0;s<n.length;s++){let l=Math.floor(s%e),f=Math.floor(s/e);!l&&!o&&(o=!0),n[s]?(a++,s>0&&l>0&&n[s-1]||(i+=o?it("M",l+t,.5+f+t):it("m",r,0),r=0,o=!1),l+1<e&&n[s+1]||(i+=it("h",a),a=0)):r++}return i}Ui.render=function(e,t,i){let r=Kn.getOptions(t),o=e.modules.size,a=e.modules.data,s=o+r.margin*2,l=r.color.light.a?"<path "+Fi(r.color.light,"fill")+' d="M0 0h'+s+"v"+s+'H0z"/>':"",f="<path "+Fi(r.color.dark,"stroke")+' d="'+zn(a,o,r.margin)+'"/>',h='viewBox="0 0 '+s+" "+s+'"',p='<svg xmlns="http://www.w3.org/2000/svg" '+(r.width?'width="'+r.width+'" height="'+r.width+'" ':"")+h+' shape-rendering="crispEdges">'+l+f+`</svg>
`;return typeof i=="function"&&i(null,p),p}});var Hi=w(me=>{"use strict";var Hn=Ht(),nt=Ni(),zi=Vi(),Qn=Ki();function rt(n,e,t,i,r){let o=[].slice.call(arguments,1),a=o.length,s=typeof o[a-1]=="function";if(!s&&!Hn())throw new Error("Callback required as last argument");if(s){if(a<2)throw new Error("Too few arguments provided");a===2?(r=t,t=e,e=i=void 0):a===3&&(e.getContext&&typeof r>"u"?(r=i,i=void 0):(r=i,i=t,t=e,e=void 0))}else{if(a<1)throw new Error("Too few arguments provided");return a===1?(t=e,e=i=void 0):a===2&&!e.getContext&&(i=t,t=e,e=void 0),new Promise(function(l,f){try{let h=nt.create(t,i);l(n(h,e,i))}catch(h){f(h)}})}try{let l=nt.create(t,i);r(null,n(l,e,i))}catch(l){r(l)}}me.create=nt.create;me.toCanvas=rt.bind(null,zi.render);me.toDataURL=rt.bind(null,zi.renderToDataURL);me.toString=rt.bind(null,function(n,e,t){return Qn.render(n,t)})});var oe=Wi(Hi(),1);var On=["qrcElement"],Qi=(()=>{class n{constructor(t,i){this.renderer=t,this.sanitizer=i,this.allowEmptyString=!1,this.colorDark="#000000ff",this.colorLight="#ffffffff",this.cssClass="qrcode",this.elementType="canvas",this.errorCorrectionLevel="M",this.margin=4,this.qrdata="",this.scale=4,this.width=10,this.qrCodeURL=new ct,this.context=null}ngOnChanges(){return A(this,null,function*(){yield this.createQRCode()})}isValidQrCodeText(t){return this.allowEmptyString===!1?!(typeof t>"u"||t===""||t==="null"||t===null):!(typeof t>"u")}toDataURL(t){return new Promise((i,r)=>{(0,oe.toDataURL)(this.qrdata,t,(o,a)=>{o?r(o):i(a)})})}toCanvas(t,i){return new Promise((r,o)=>{(0,oe.toCanvas)(t,this.qrdata,i,a=>{a?o(a):r("success")})})}toSVG(t){return new Promise((i,r)=>{(0,oe.toString)(this.qrdata,t,(o,a)=>{o?r(o):i(a)})})}renderElement(t){for(let i of this.qrcElement.nativeElement.childNodes)this.renderer.removeChild(this.qrcElement.nativeElement,i);this.renderer.appendChild(this.qrcElement.nativeElement,t)}createQRCode(){return A(this,null,function*(){this.version&&this.version>40?(console.warn("[angularx-qrcode] max value for `version` is 40"),this.version=40):this.version&&this.version<1?(console.warn("[angularx-qrcode]`min value for `version` is 1"),this.version=1):this.version!==void 0&&isNaN(this.version)&&(console.warn("[angularx-qrcode] version should be a number, defaulting to auto."),this.version=void 0);try{if(!this.isValidQrCodeText(this.qrdata))throw new Error("[angularx-qrcode] Field `qrdata` is empty, set 'allowEmptyString=\"true\"' to overwrite this behaviour.");this.isValidQrCodeText(this.qrdata)&&this.qrdata===""&&(this.qrdata=" ");let t={color:{dark:this.colorDark,light:this.colorLight},errorCorrectionLevel:this.errorCorrectionLevel,margin:this.margin,scale:this.scale,version:this.version,width:this.width},i=this.imageSrc,r=this.imageHeight||40,o=this.imageWidth||40;switch(this.elementType){case"canvas":{let a=this.renderer.createElement("canvas");this.context=a.getContext("2d"),this.toCanvas(a,t).then(()=>{if(this.ariaLabel&&this.renderer.setAttribute(a,"aria-label",`${this.ariaLabel}`),this.title&&this.renderer.setAttribute(a,"title",`${this.title}`),i&&this.context){this.centerImage=new Image(o,r),i!==this.centerImage.src&&(this.centerImage.src=i),r!==this.centerImage.height&&(this.centerImage.height=r),o!==this.centerImage.width&&(this.centerImage.width=o);let s=this.centerImage;s&&(s.onload=()=>{this.context?.drawImage(s,a.width/2-o/2,a.height/2-r/2,o,r)})}this.renderElement(a),this.emitQRCodeURL(a)}).catch(s=>{console.error("[angularx-qrcode] canvas error:",s)});break}case"svg":{let a=this.renderer.createElement("div");this.toSVG(t).then(s=>{this.renderer.setProperty(a,"innerHTML",s);let l=a.firstChild;this.renderer.setAttribute(l,"height",`${this.width}`),this.renderer.setAttribute(l,"width",`${this.width}`),this.renderElement(l),this.emitQRCodeURL(l)}).catch(s=>{console.error("[angularx-qrcode] svg error:",s)});break}case"url":case"img":default:{let a=this.renderer.createElement("img");this.toDataURL(t).then(s=>{this.alt&&a.setAttribute("alt",this.alt),this.ariaLabel&&a.setAttribute("aria-label",this.ariaLabel),a.setAttribute("src",s),this.title&&a.setAttribute("title",this.title),this.renderElement(a),this.emitQRCodeURL(a)}).catch(s=>{console.error("[angularx-qrcode] img/url error:",s)})}}}catch(t){console.error("[angularx-qrcode] Error generating QR Code:",t.message)}})}emitQRCodeURL(t){let i=t.constructor.name;if(i===SVGSVGElement.name){let o=t.outerHTML,a=new Blob([o],{type:"image/svg+xml"}),s=URL.createObjectURL(a),l=this.sanitizer.bypassSecurityTrustUrl(s);this.qrCodeURL.emit(l);return}let r="";i===HTMLCanvasElement.name&&(r=t.toDataURL("image/png")),i===HTMLImageElement.name&&(r=t.src),fetch(r).then(o=>o.blob()).then(o=>URL.createObjectURL(o)).then(o=>this.sanitizer.bypassSecurityTrustUrl(o)).then(o=>{this.qrCodeURL.emit(o)}).catch(o=>{console.error("[angularx-qrcode] Error when fetching image/png URL: "+o)})}static{this.\u0275fac=function(i){return new(i||n)(Ae(dt),Ae(yt))}}static{this.\u0275cmp=pe({type:n,selectors:[["qrcode"]],viewQuery:function(i,r){if(i&1&&ht(On,7),i&2){let o;mt(o=pt())&&(r.qrcElement=o.first)}},inputs:{allowEmptyString:"allowEmptyString",colorDark:"colorDark",colorLight:"colorLight",cssClass:"cssClass",elementType:"elementType",errorCorrectionLevel:"errorCorrectionLevel",imageSrc:"imageSrc",imageHeight:"imageHeight",imageWidth:"imageWidth",margin:"margin",qrdata:"qrdata",scale:"scale",version:"version",width:"width",alt:"alt",ariaLabel:"ariaLabel",title:"title"},outputs:{qrCodeURL:"qrCodeURL"},standalone:!1,features:[lt],decls:2,vars:2,consts:[["qrcElement",""]],template:function(i,r){i&1&&_(0,"div",null,0),i&2&&ft(r.cssClass)},encapsulation:2,changeDetection:0})}}return n})(),ji=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=ut({type:n})}static{this.\u0275inj=st({})}}return n})();var Jn=(n,e,t)=>({"bg-red-500/20 text-red-300":n,"bg-orange-500/20 text-orange-300":e,"bg-green-500/20 text-green-300":t}),Gi=(n,e)=>e.id;function Wn(n,e){n&1&&(c(0,"div",25),_(1,"div",28),d())}function Yn(n,e){if(n&1){let t=ae();c(0,"div",26)(1,"div",29)(2,"div",22)(3,"div",30),L(),c(4,"svg",31),_(5,"path",32),d()(),V(),c(6,"h2",33),u(7,"Kit Preparado!"),d(),c(8,"p",34),u(9,"El kit esta listo para despacho"),d(),c(10,"div",35)(11,"div",22),_(12,"qrcode",36),c(13,"p",37),u(14),d(),c(15,"p",38),u(16,"Escanea este c\xF3digo para validar la entrega"),d()()(),c(17,"div",39)(18,"button",40),Y("click",function(){S(t);let r=v();return M(r.imprimirQR())}),L(),c(19,"svg",19),_(20,"path",41),d(),u(21," Imprimir QR "),d(),V(),c(22,"button",42),Y("click",function(){S(t);let r=v();return M(r.volverAListado())}),u(23," Volver al Listado "),d()()()()()}if(n&2){let t=v();m(12),y("qrdata",t.qrUrl())("width",256)("errorCorrectionLevel","M")("elementType","canvas")("cssClass","mx-auto"),m(2),I(t.qrCode())}}function $n(n,e){if(n&1){let t=ae();c(0,"div",43)(1,"h2",60),L(),c(2,"svg",61),_(3,"path",62),d(),u(4," C\xF3digo QR de Validaci\xF3n "),d(),V(),c(5,"div",63)(6,"div",64),_(7,"qrcode",65),d(),c(8,"div",66)(9,"p",67),u(10,"Este c\xF3digo QR permite al cliente validar la recepci\xF3n del kit sin necesidad de iniciar sesi\xF3n."),d(),c(11,"div",68)(12,"p",45),u(13,"C\xF3digo:"),d(),c(14,"p",69),u(15),d()(),c(16,"div",68)(17,"p",45),u(18,"URL de validaci\xF3n:"),d(),c(19,"p",70),u(20),d()(),c(21,"button",71),Y("click",function(){S(t);let r=v(3);return M(r.imprimirQR())}),L(),c(22,"svg",19),_(23,"path",41),d(),u(24," Imprimir QR "),d()()()()}if(n&2){let t=v(3);m(7),y("qrdata",t.qrUrl())("width",256)("errorCorrectionLevel","M")("elementType","canvas"),m(8),I(t.qrCode()),m(5),I(t.qrUrl())}}function Zn(n,e){if(n&1&&(c(0,"div",54)(1,"div",55),L(),c(2,"svg",56),_(3,"path",57),d(),V(),c(4,"div")(5,"p",58),u(6,"Kit Preparado - Modo Solo Lectura"),d(),c(7,"p",59),u(8,"Este kit ya fue completamente preparado y esta listo para envio"),d()()()(),H(9,$n,25,6,"div",43)),n&2){let t=v(2);m(9),R(t.qrUrl()?9:-1)}}function Xn(n,e){n&1&&(c(0,"div",22),_(1,"p",72),c(2,"p",49),u(3,"Alertas Activas"),d()())}function er(n,e){if(n&1&&(c(0,"option",86),u(1),d()),n&2){let t=e.$implicit;y("value",t.ubicacion),m(),qe("",t.ubicacion," (",t.cantidad," unidades)")}}function tr(n,e){if(n&1){let t=ae();c(0,"div",43)(1,"div",73)(2,"div",74)(3,"h3",75),u(4),d(),c(5,"p",76),u(6),d(),c(7,"div",77)(8,"span",78),u(9),d()()(),c(10,"div",79)(11,"p",80),u(12,"Solicitado"),d(),c(13,"p",81),u(14),d()()(),c(15,"div",44)(16,"div")(17,"label",82),u(18,"Cantidad a Preparar *"),d(),c(19,"input",83),X("ngModelChange",function(r){let o=S(t).$implicit;return Z(o.cantidad_preparada,r)||(o.cantidad_preparada=r),M(r)}),Y("ngModelChange",function(){let r=S(t).$implicit,o=v(2);return M(o.validarCantidad(r))}),d(),c(20,"p",84),u(21),d()(),c(22,"div")(23,"label",82),u(24,"Ubicacion"),d(),c(25,"select",85),X("ngModelChange",function(r){let o=S(t).$implicit;return Z(o.ubicacion_seleccionada,r)||(o.ubicacion_seleccionada=r),M(r)}),Le(26,er,2,3,"option",86,Gi),d()(),c(28,"div")(29,"label",82),u(30,"Lote"),d(),c(31,"input",87),X("ngModelChange",function(r){let o=S(t).$implicit;return Z(o.lote,r)||(o.lote=r),M(r)}),d()(),c(32,"div")(33,"label",82),u(34,"Vencimiento"),d(),c(35,"input",88),X("ngModelChange",function(r){let o=S(t).$implicit;return Z(o.fecha_vencimiento,r)||(o.fecha_vencimiento=r),M(r)}),d()()(),c(36,"div",89)(37,"label",82),u(38,"Observaciones"),d(),c(39,"textarea",90),X("ngModelChange",function(r){let o=S(t).$implicit;return Z(o.observaciones,r)||(o.observaciones=r),M(r)}),d()()()}if(n&2){let t=e.$implicit,i=v(2);m(4),I(t.nombre),m(2),ge("Codigo: ",t.codigo,""),m(2),y("ngClass",gt(17,Jn,t.alerta_stock,t.alerta_vencimiento&&!t.alerta_stock,!t.alerta_stock&&!t.alerta_vencimiento)),m(),ge(" ",i.obtenerMensajeAlerta(t)," "),m(5),I(t.cantidad_solicitada),m(5),$("ngModel",t.cantidad_preparada),y("max",t.stock_disponible)("disabled",i.modoVista()),m(2),ge("Disponible: ",t.stock_disponible,""),m(4),$("ngModel",t.ubicacion_seleccionada),y("disabled",i.modoVista()),m(),Re(t.inventarios),m(5),$("ngModel",t.lote),y("disabled",i.modoVista()),m(4),$("ngModel",t.fecha_vencimiento),y("disabled",i.modoVista()),m(4),$("ngModel",t.observaciones),y("disabled",i.modoVista())}}function ir(n,e){n&1&&(_(0,"div",92),c(1,"span"),u(2,"Procesando..."),d())}function nr(n,e){n&1&&(L(),c(0,"svg",61),_(1,"path",57),d(),V(),c(2,"span"),u(3,"Finalizar Preparacion"),d())}function rr(n,e){if(n&1){let t=ae();c(0,"div",53)(1,"button",91),Y("click",function(){S(t);let r=v(2);return M(r.finalizarPreparacion())}),H(2,ir,3,0)(3,nr,4,0),d()()}if(n&2){let t=v(2);m(),y("disabled",t.procesando()),m(),R(t.procesando()?2:3)}}function or(n,e){if(n&1&&(H(0,Zn,10,1),c(1,"div",43)(2,"div",44)(3,"div")(4,"p",45),u(5,"Kit #"),d(),c(6,"p",46),u(7),d()(),c(8,"div")(9,"p",45),u(10,"Cirugia"),d(),c(11,"p",46),u(12),d()(),c(13,"div")(14,"p",45),u(15,"Hospital"),d(),c(16,"p",46),u(17),d()(),c(18,"div")(19,"p",45),u(20,"Fecha Cirugia"),d(),c(21,"p",46),u(22),wt(23,"date"),d()()(),c(24,"div",47)(25,"div",22)(26,"p",48),u(27),d(),c(28,"p",49),u(29,"Productos Completos"),d()(),H(30,Xn,4,0,"div",22),d()(),c(31,"div",50),Le(32,tr,40,21,"div",43,Gi),d(),c(34,"div",43)(35,"label",51),u(36,"Observaciones Generales del Kit"),d(),_(37,"textarea",52),d(),H(38,rr,4,2,"div",53)),n&2){let t,i,r,o,a=v();R(a.modoVista()?0:-1),m(7),I((t=a.kit())==null?null:t.numero_kit),m(5),I((i=a.kit())==null||i.cirugia==null?null:i.cirugia.numero_cirugia),m(5),I((r=a.kit())==null||r.cirugia==null||r.cirugia.hospital==null?null:r.cirugia.hospital.nombre),m(5),I(Ct(23,11,(o=a.kit())==null||o.cirugia==null?null:o.cirugia.fecha_programada,"dd/MM/yyyy")),m(5),qe("",a.productosCompletos(),"/",a.totalProductos(),""),m(3),R(a.tieneAlertas()?30:-1),m(2),Re(a.productos()),m(5),y("formControl",a.preparacionForm.controls.observaciones)("disabled",a.modoVista()),m(),R(a.modoVista()?-1:38)}}var Oi=class n{route=W(vt);router=W(Et);fb=W(Vt);kitService=W(Kt);supabase=W(Pt);kitId=T("");kit=T(null);productos=T([]);loading=T(!0);procesando=T(!1);mostrarQR=T(!1);qrCode=T("");qrUrl=T("");modoVista=T(!1);totalProductos=we(()=>this.productos().length);productosCompletos=we(()=>this.productos().filter(e=>e.cantidad_preparada>=e.cantidad_solicitada).length);tieneAlertas=we(()=>this.productos().some(e=>e.alerta_stock||e.alerta_vencimiento));preparacionForm=this.fb.group({observaciones:[""]});ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.kitId.set(e),this.route.queryParams.subscribe(t=>{t.modo==="ver"&&this.modoVista.set(!0)}),this.cargarKit(e))}cargarKit(e){return A(this,null,function*(){try{this.loading.set(!0);let{data:t,error:i}=yield this.supabase.client.from("kits_cirugia").select(`
          *,
          cirugia:cirugias(
            numero_cirugia,
            medico_cirujano,
            fecha_programada,
            hospital:hospitales(nombre),
            cliente:clientes(nombre, apellido)
          ),
          productos:kit_productos(
            *,
            producto:productos(
              id,
              codigo,
              nombre,
              categoria,
              inventario(
                id,
                cantidad,
                ubicacion,
                estado,
                fecha_vencimiento
              )
            )
          )
        `).eq("id",e).single();if(i)throw i;this.kit.set(t),t.qr_code&&(this.qrCode.set(t.qr_code),this.qrUrl.set(`https://thezulux24.github.io/SmartTrack/#/qr/${t.qr_code}`));let r=(t.productos||[]).map(o=>{let a=(o.producto?.inventario||[]).filter(b=>b.estado==="disponible"&&b.cantidad>0),s=a.reduce((b,p)=>b+p.cantidad,0),l=s<o.cantidad_solicitada,f=new Date,h=a.some(b=>{if(!b.fecha_vencimiento)return!1;let p=Math.ceil((new Date(b.fecha_vencimiento).getTime()-f.getTime())/(1e3*60*60*24));return p<=30&&p>=0});return{id:o.id,producto_id:o.producto.id,nombre:o.producto.nombre,codigo:o.producto.codigo,cantidad_solicitada:o.cantidad_solicitada,cantidad_preparada:o.cantidad_preparada||0,stock_disponible:s,lote:o.lote||"",fecha_vencimiento:o.fecha_vencimiento||"",ubicacion_seleccionada:a[0]?.ubicacion||"",observaciones:o.observaciones||"",alerta_stock:l,alerta_vencimiento:h,inventarios:a}});this.productos.set(r),this.loading.set(!1)}catch(t){console.error("Error cargando kit:",t),alert("Error al cargar el kit"),this.router.navigate(["/internal/logistica/kits-pendientes"])}})}validarCantidad(e){e.cantidad_preparada>e.stock_disponible&&(e.cantidad_preparada=e.stock_disponible,alert(`Stock insuficiente. M\xE1ximo disponible: ${e.stock_disponible}`)),e.cantidad_preparada<0&&(e.cantidad_preparada=0)}finalizarPreparacion(){return A(this,null,function*(){if(!this.productos().some(i=>i.cantidad_preparada>0)){alert("Debes preparar al menos un producto");return}let t=this.productos().filter(i=>i.cantidad_preparada<i.cantidad_solicitada);if(!(t.length>0&&!confirm(`Hay ${t.length} producto(s) con cantidad incompleta. \xBFDeseas continuar?`)))try{this.procesando.set(!0);let i=(yield this.supabase.client.auth.getUser()).data.user?.id;if(!i)throw new Error("Usuario no autenticado");for(let a of this.productos())if(a.cantidad_preparada>0){let{error:s}=yield this.supabase.client.from("kit_productos").update({cantidad_preparada:a.cantidad_preparada,lote:a.lote||null,fecha_vencimiento:a.fecha_vencimiento||null,observaciones:a.observaciones||null}).eq("id",a.id);if(s)throw s;yield this.registrarMovimientoInventario(a,i)}let r=yield this.generarQR(),{error:o}=yield this.supabase.client.from("kits_cirugia").update({estado:"listo_envio",fecha_preparacion:new Date().toISOString(),logistica_id:i,qr_code:r,ubicacion_actual:"bodega_principal",observaciones:this.preparacionForm.value.observaciones||null}).eq("id",this.kitId());if(o)throw o;yield this.registrarTrazabilidad("Listo para despacho","preparando","listo_envio",i),this.qrCode.set(r),this.qrUrl.set(`https://thezulux24.github.io/SmartTrack/#/qr/${r}`),this.mostrarQR.set(!0)}catch(i){console.error("Error finalizando preparaci\xF3n:",i),alert("Error al finalizar la preparaci\xF3n")}finally{this.procesando.set(!1)}})}registrarMovimientoInventario(e,t){return A(this,null,function*(){let i=e.inventarios?.find(l=>l.ubicacion===e.ubicacion_seleccionada);if(!i)return;let{error:r}=yield this.supabase.client.from("movimientos_inventario").insert({inventario_id:i.id,producto_id:e.producto_id,tipo:"salida",cantidad:e.cantidad_preparada,motivo:"Kit quir\xFArgico",usuario_id:t,ubicacion_origen:e.ubicacion_seleccionada,referencia:this.kit()?.numero_kit,lote:e.lote||null,fecha_vencimiento:e.fecha_vencimiento||null,observaciones:`Kit ${this.kit()?.numero_kit} - Preparaci\xF3n para cirug\xEDa`});if(r)throw r;let o=i.cantidad-e.cantidad_preparada,a=o<=0?"agotado":"disponible",{error:s}=yield this.supabase.client.from("inventario").update({cantidad:o,estado:a}).eq("id",i.id);if(s)throw s})}generarQR(){return A(this,null,function*(){let e=Date.now(),t=Math.random().toString(36).substring(2,8).toUpperCase(),i=`KIT-${this.kit()?.numero_kit}-${t}-${e}`,{error:r}=yield this.supabase.client.from("qr_codes").insert({codigo:i,tipo:"kit",referencia_id:this.kitId(),kit_id:this.kitId(),tipo_validacion:"entrega_cliente",es_activo:!0});if(r)throw r;return i})}registrarTrazabilidad(e,t,i,r){return A(this,null,function*(){let{error:o}=yield this.supabase.client.from("kit_trazabilidad").insert({kit_id:this.kitId(),accion:e,estado_anterior:t,estado_nuevo:i,usuario_id:r,ubicacion:"bodega_principal",observaciones:this.preparacionForm.value.observaciones||null});if(o)throw o})}imprimirQR(){window.print()}volverAListado(){this.router.navigate(["/internal/logistica/kits-pendientes"])}obtenerColorAlerta(e){return e.alerta_stock?"red":e.alerta_vencimiento?"orange":"green"}obtenerMensajeAlerta(e){return e.alerta_stock?`\u26A0\uFE0F Stock insuficiente (Disponible: ${e.stock_disponible})`:e.alerta_vencimiento?"\u26A0\uFE0F Producto pr\xF3ximo a vencer (< 30 d\xEDas)":"\u2713 Stock suficiente"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=pe({type:n,selectors:[["app-kit-preparacion"]],decls:32,vars:3,consts:[[1,"min-h-screen","relative","overflow-hidden"],[1,"absolute","inset-0","z-0"],[1,"absolute","inset-0","bg-[#10284C]"],["xmlns","http://www.w3.org/2000/svg",1,"absolute","w-full","h-full"],["cx","10%","cy","15%","r","120","fill","#0098A8","opacity","0.1"],["cx","85%","cy","25%","r","180","fill","#C8D900","opacity","0.08"],["cx","50%","cy","80%","r","150","fill","#0098A8","opacity","0.12"],["x","60%","y","5%","width","200","height","200","fill","#0098A8","opacity","0.06","transform","rotate(45 70 15)"],["x","15%","y","65%","width","160","height","160","fill","#C8D900","opacity","0.08","transform","rotate(30 20 70)"],["x1","0%","y1","30%","x2","100%","y2","35%","stroke","#0098A8","stroke-width","2","opacity","0.1"],["x1","0%","y1","60%","x2","100%","y2","55%","stroke","#C8D900","stroke-width","2","opacity","0.08"],["points","90,10 95,25 85,25","fill","#0098A8","opacity","0.1","transform","scale(8)"],["points","5,85 12,95 2,98","fill","#C8D900","opacity","0.09","transform","scale(10)"],[1,"absolute","inset-0","bg-gradient-to-b","from-[#10284C]/50","via-[#10284C]/80","to-[#10284C]/95"],[1,"relative","z-10","px-4","py-6"],[1,"max-w-6xl","mx-auto","space-y-6"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","gap-4"],["src","https://www.implameq.com/wp-content/uploads/logotipo-impla-300x78.png.webp","alt","Implameq",1,"h-10","w-auto","brightness-0","invert"],["routerLink","/internal/logistica/kits-pendientes",1,"px-4","py-2","bg-[#C8D900]","text-[#10284C]","rounded-lg","hover:bg-[#d4e820]","transition-colors","font-medium","flex","items-center","gap-2","active:scale-95"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"hidden","sm:inline"],[1,"text-center"],[1,"text-3xl","sm:text-4xl","font-bold","text-[#C8D900]","mb-2"],[1,"text-white/80","text-sm"],[1,"flex","justify-center","items-center","py-20"],[1,"fixed","inset-0","bg-black/80","backdrop-blur-sm","z-50","flex","items-center","justify-center","p-4"],[1,"h-6"],[1,"w-16","h-16","border-4","border-[#C8D900]","border-t-transparent","rounded-full","animate-spin"],[1,"bg-[#10284C]","border-2","border-[#C8D900]","rounded-2xl","p-8","max-w-md","w-full"],[1,"w-16","h-16","bg-[#C8D900]","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-[#10284C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-2xl","font-bold","text-[#C8D900]","mb-2"],[1,"text-white/70","mb-6"],[1,"bg-[#ffffff]","p-6","rounded-xl","mb-6"],[3,"qrdata","width","errorCorrectionLevel","elementType","cssClass"],[1,"text-xs","text-gray-600","mt-3","font-mono","break-all"],[1,"text-xs","text-gray-500","mt-1"],[1,"space-y-3"],[1,"w-full","px-6","py-3","bg-[#C8D900]","text-[#10284C]","rounded-lg","hover:bg-[#d4e820]","transition-all","font-bold","flex","items-center","justify-center","gap-2",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"],[1,"w-full","px-6","py-3","bg-white/10","text-white","rounded-lg","hover:bg-white/20","transition-all","font-bold","border","border-white/20",3,"click"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","p-6","shadow-xl"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"text-white/60","text-xs","mb-1"],[1,"text-white","font-bold"],[1,"mt-6","pt-6","border-t","border-white/10","flex","items-center","justify-center","gap-8"],[1,"text-3xl","font-bold","text-[#C8D900]"],[1,"text-white/60","text-xs","mt-1"],[1,"space-y-4"],[1,"block","text-white","font-bold","mb-3"],["rows","3","placeholder","Notas adicionales sobre la preparacion del kit...",1,"w-full","px-4","py-3","bg-[#10284C]/50","border","border-white/20","rounded-lg","text-white","placeholder-white/30","focus:outline-none","focus:border-[#C8D900]","resize-none","disabled:opacity-50","disabled:cursor-not-allowed",3,"formControl","disabled"],[1,"flex","justify-center","pt-6"],[1,"bg-green-500/20","backdrop-blur-md","rounded-2xl","border","border-green-400/30","p-4","shadow-xl"],[1,"flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-green-300","font-bold"],[1,"text-green-200/70","text-sm"],[1,"text-xl","font-bold","text-[#C8D900]","mb-4","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"],[1,"flex","flex-col","lg:flex-row","items-center","gap-6"],[1,"bg-[#ffffff]","p-6","rounded-xl"],[3,"qrdata","width","errorCorrectionLevel","elementType"],[1,"flex-1","space-y-3"],[1,"text-white/80"],[1,"bg-[#10284C]/50","p-4","rounded-lg"],[1,"text-white","font-mono","text-sm","break-all"],[1,"text-[#C8D900]","font-mono","text-xs","break-all"],[1,"px-4","py-2","bg-[#C8D900]","text-[#10284C]","rounded-lg","hover:bg-[#d4e820]","transition-all","font-bold","flex","items-center","gap-2",3,"click"],[1,"text-3xl","font-bold","text-orange-400"],[1,"flex","items-start","justify-between","mb-4"],[1,"flex-1"],[1,"text-lg","font-bold","text-white","mb-1"],[1,"text-white/60","text-sm"],[1,"mt-2"],[1,"text-xs","px-3","py-1","rounded-full",3,"ngClass"],[1,"text-right"],[1,"text-white/60","text-xs"],[1,"text-2xl","font-bold","text-[#C8D900]"],[1,"block","text-white/80","text-sm","mb-2"],["type","number","min","0",1,"w-full","px-4","py-2","bg-[#10284C]/50","border","border-white/20","rounded-lg","text-white","focus:outline-none","focus:border-[#C8D900]","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","max","disabled"],[1,"text-white/40","text-xs","mt-1"],[1,"w-full","px-4","py-2","bg-[#10284C]/50","border","border-white/20","rounded-lg","text-white","focus:outline-none","focus:border-[#C8D900]","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[3,"value"],["type","text","placeholder","Ej: LOTE-2025-001",1,"w-full","px-4","py-2","bg-[#10284C]/50","border","border-white/20","rounded-lg","text-white","placeholder-white/30","focus:outline-none","focus:border-[#C8D900]","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],["type","date",1,"w-full","px-4","py-2","bg-[#10284C]/50","border","border-white/20","rounded-lg","text-white","focus:outline-none","focus:border-[#C8D900]","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"mt-4"],["rows","2","placeholder","Notas sobre este producto...",1,"w-full","px-4","py-2","bg-[#10284C]/50","border","border-white/20","rounded-lg","text-white","placeholder-white/30","focus:outline-none","focus:border-[#C8D900]","resize-none","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"px-12","py-4","bg-[#C8D900]","text-[#10284C]","rounded-xl","hover:bg-[#d4e820]","disabled:opacity-50","disabled:cursor-not-allowed","transition-all","shadow-2xl","font-bold","text-lg","flex","items-center","gap-3","active:scale-95",3,"click","disabled"],[1,"w-5","h-5","border-3","border-[#10284C]","border-t-transparent","rounded-full","animate-spin"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"div",2),L(),c(3,"svg",3),_(4,"circle",4)(5,"circle",5)(6,"circle",6)(7,"rect",7)(8,"rect",8)(9,"line",9)(10,"line",10)(11,"polygon",11)(12,"polygon",12),d()(),V(),_(13,"div",13),d(),c(14,"main",14)(15,"div",15)(16,"div",16),_(17,"img",17),c(18,"a",18),L(),c(19,"svg",19),_(20,"path",20),d(),V(),c(21,"span",21),u(22,"Volver"),d()()(),c(23,"div",22)(24,"h1",23),u(25,"Preparacion de Kit"),d(),c(26,"p",24),u(27,"Proceso de picking y alistamiento"),d()(),H(28,Wn,2,0,"div",25)(29,Yn,24,6,"div",26)(30,or,39,14),_(31,"div",27),d()()()),t&2&&(m(28),R(i.loading()?28:-1),m(),R(i.mostrarQR()?29:-1),m(),R(!i.loading()&&i.kit()?30:-1))},dependencies:[xt,bt,_t,Mt,St,Ft,Rt,qt,Tt,Bt,Lt,It,Dt,Nt,kt,Ut,At,ji,Qi],encapsulation:2})};export{Oi as KitPreparacionComponent};
