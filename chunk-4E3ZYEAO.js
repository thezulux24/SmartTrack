import{a as F,b as k}from"./chunk-HTFQ2PAS.js";import"./chunk-AF4TJ6YQ.js";import{$ as c,D as f,Da as V,F as s,Ha as I,I as C,M as j,P as h,S as E,V as S,W as G,X as t,Y as e,Z as u,_ as v,aa as d,ca as o,da as g,ea as H,t as y,v as x,w as p,x as _,xa as L,y as b,za as T}from"./chunk-CV56RX3B.js";import"./chunk-LJ5XHLMQ.js";import"./chunk-FK42CRUA.js";var D=(l,n)=>n.id;function O(l,n){l&1&&(t(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21),u(4,"div",22)(5,"div",23)(6,"div",24),e(),t(7,"p",25),o(8,"Cargando hojas de gasto..."),e()()()())}function P(l,n){if(l&1){let i=v();t(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",26),_(),t(4,"svg",27),u(5,"path",28),e(),b(),t(6,"p",29),o(7),e()(),t(8,"button",30),c("click",function(){x(i);let r=d();return p(r.loadHojasGasto())}),o(9," Reintentar "),e()()()()}if(l&2){let i=d();s(7),g(i.error())}}function A(l,n){if(l&1){let i=v();t(0,"button",68),c("click",function(r){x(i);let m=d().$implicit;return d(2).editarHoja(m.id),p(r.stopPropagation())}),o(1," Editar "),e()}}function $(l,n){if(l&1){let i=v();t(0,"div",47),c("click",function(){let r=x(i).$implicit,m=d(2);return p(m.verDetalle(r.id))}),t(1,"div",48)(2,"div",49)(3,"div",50)(4,"div",51)(5,"h3",52),o(6),e(),t(7,"span",53),o(8),e()(),t(9,"p",54),o(10),e()(),t(11,"div",55)(12,"p",56),o(13),e(),t(14,"p",57),o(15,"Total"),e()()()(),t(16,"div",58)(17,"div",59)(18,"div")(19,"p",57),o(20,"T\xE9cnico"),e(),t(21,"p",60),o(22),e()(),t(23,"div")(24,"p",57),o(25,"Fecha Cirug\xEDa"),e(),t(26,"p",60),o(27),e()()(),t(28,"div",61)(29,"div",14)(30,"p",57),o(31,"Productos"),e(),t(32,"p",62),o(33),e()(),t(34,"div",14)(35,"p",57),o(36,"Transporte"),e(),t(37,"p",63),o(38),e()(),t(39,"div",14)(40,"p",57),o(41,"Otros"),e(),t(42,"p",64),o(43),e()()(),t(44,"div",65)(45,"button",66),c("click",function(r){let m=x(i).$implicit;return d(2).verDetalle(m.id),p(r.stopPropagation())}),o(46," Ver Detalle "),e(),j(47,A,2,0,"button",67),e()()()}if(l&2){let i=n.$implicit,a=d(2);s(6),g(i.numero_hoja),s(),h("ngClass",a.getEstadoInfo(i.estado).color),s(),H(" ",a.getEstadoInfo(i.estado).label," "),s(2),g(a.getClienteNombre(i)),s(3),g(a.formatMoneda(i.total_general)),s(9),g(a.getTecnicoNombre(i)),s(5),g(a.formatFecha(i.fecha_cirugia)),s(6),g(a.formatMoneda(i.total_productos)),s(5),g(a.formatMoneda(i.total_transporte)),s(5),g(a.formatMoneda(i.total_otros)),s(4),E(i.estado==="borrador"||i.estado==="revision"?47:-1)}}function B(l,n){if(l&1){let i=v();t(0,"div",46),_(),t(1,"svg",69),u(2,"path",70)(3,"path",71),e(),b(),t(4,"p",72),o(5,"No hay hojas de gasto disponibles"),e(),t(6,"button",73),c("click",function(){x(i);let r=d(2);return p(r.nuevaHoja())}),o(7," Crear primera hoja de gasto "),e()()}}function q(l,n){if(l&1){let i=v();t(0,"main",18)(1,"div",31)(2,"div",32)(3,"h3",33),o(4,"Filtros"),e(),t(5,"div",34)(6,"div")(7,"label",35),o(8,"Estado"),e(),t(9,"select",36),c("change",function(r){x(i);let m=d();return p(m.onFiltroEstadoChange(r.target.value))}),t(10,"option",37),o(11,"Todos los estados"),e(),t(12,"option",38),o(13,"Pendiente"),e(),t(14,"option",39),o(15,"En Proceso"),e(),t(16,"option",40),o(17,"Completada"),e(),t(18,"option",41),o(19,"Validada"),e(),t(20,"option",42),o(21,"Facturada"),e()()(),t(22,"button",43),c("click",function(){x(i);let r=d();return p(r.clearFiltros())}),o(23," Limpiar filtros "),e()()()(),t(24,"div",44),S(25,$,48,11,"div",45,D),j(27,B,8,0,"div",46),e()()}if(l&2){let i=d();s(9),h("value",i.filtroEstado()),s(16),G(i.hojasGasto()),s(2),E(i.hojasGasto().length===0?27:-1)}}var M=class l{router=y(I);hojaGastoService=y(F);loading=f(!1);error=f(null);hojasGasto=f([]);filtroEstado=f("");ESTADOS_CONFIG=k;ngOnInit(){console.log("\u{1F4CB} HojaGastoListComponent iniciando..."),this.loadHojasGasto()}loadHojasGasto(){this.loading.set(!0),this.error.set(null);let n={};this.filtroEstado()&&(n.estado=this.filtroEstado()),this.hojaGastoService.getHojasGasto(n).subscribe({next:i=>{this.hojasGasto.set(i),this.loading.set(!1),console.log("\u2705 Hojas de gasto cargadas:",i.length)},error:i=>{console.error("\u274C Error cargando hojas de gasto:",i),this.error.set("Error al cargar las hojas de gasto. Por favor, int\xE9ntelo de nuevo."),this.loading.set(!1)}})}onFiltroEstadoChange(n){this.filtroEstado.set(n),this.loadHojasGasto()}clearFiltros(){this.filtroEstado.set(""),this.loadHojasGasto()}nuevaHoja(){this.router.navigate(["/internal/hojas-gasto/new"])}verDetalle(n){this.router.navigate(["/internal/hojas-gasto/detail",n])}editarHoja(n){this.router.navigate(["/internal/hojas-gasto/edit",n])}volver(){this.router.navigate(["/internal"])}getEstadoInfo(n){return k[n]||{label:n,color:"bg-gray-100 text-gray-800"}}getClienteNombre(n){return"N/A"}getTecnicoNombre(n){return"N/A"}formatMoneda(n){return new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(n)}formatFecha(n){return new Date(n).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"})}cambiarEstado(n,i,a){a.stopPropagation(),this.hojaGastoService.cambiarEstado(n,i).subscribe({next:r=>{let m=this.hojasGasto(),w=m.findIndex(N=>N.id===n);w!==-1&&(m[w]=r,this.hojasGasto.set([...m]))},error:r=>{console.error("Error cambiando estado:",r),this.error.set("Error al cambiar el estado. Por favor, int\xE9ntelo de nuevo.")}})}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=C({type:l,selectors:[["app-hoja-gasto-list"]],decls:25,vars:3,consts:[[1,"bg-gray-50","dark:bg-gray-900","min-h-screen"],[1,"bg-gradient-to-r","from-green-600","to-emerald-700","text-white","shadow-lg"],[1,"px-4","py-4"],[1,"flex","justify-between","items-center","mb-3"],[1,"flex","items-center","space-x-3"],["src","https://www.implameq.com/wp-content/uploads/logotipo-impla-300x78.png.webp","alt","Implameq",1,"h-8","brightness-0","invert"],[1,"text-lg","font-semibold"],[1,"flex","items-center","space-x-2"],[1,"bg-white/20","hover:bg-white/30","text-white","px-3","py-2","rounded-lg","text-xs","font-medium","transition","duration-200","shadow-md","backdrop-blur-sm",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"bg-white/20","hover:bg-white/30","text-white","px-3","py-2","rounded-lg","text-sm","font-medium","transition","duration-200","shadow-md","backdrop-blur-sm",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"text-center"],[1,"text-2xl","font-bold","mb-1"],[1,"text-green-100","text-sm"],["class","px-4 py-6",4,"ngIf"],[1,"px-4","py-6"],[1,"max-w-lg","mx-auto"],[1,"bg-white","rounded-xl","shadow-md","dark:bg-gray-800","p-6","text-center"],[1,"animate-pulse","space-y-4"],[1,"h-4","bg-gray-200","rounded","w-3/4","mx-auto"],[1,"h-4","bg-gray-200","rounded","w-1/2","mx-auto"],[1,"h-4","bg-gray-200","rounded","w-2/3","mx-auto"],[1,"text-sm","text-gray-500","mt-4"],[1,"text-red-600","dark:text-red-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-sm"],["type","button",1,"mt-4","w-full","text-white","bg-red-600","hover:bg-red-700","focus:ring-4","focus:outline-none","focus:ring-red-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center",3,"click"],[1,"max-w-lg","mx-auto","mb-6"],[1,"bg-white","rounded-xl","shadow-md","dark:bg-gray-800","dark:border","dark:border-gray-700","p-4"],[1,"text-sm","font-medium","text-gray-900","dark:text-white","mb-3"],[1,"space-y-3"],[1,"block","text-xs","text-gray-500","dark:text-gray-400","mb-1"],[1,"w-full","px-3","py-2","text-sm","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-green-500","focus:border-transparent","dark:bg-gray-700","dark:border-gray-600","dark:text-white",3,"change","value"],["value",""],["value","pendiente"],["value","en_proceso"],["value","completada"],["value","validada"],["value","facturada"],[1,"w-full","text-xs","text-gray-600","hover:text-gray-900","dark:text-gray-400","dark:hover:text-white",3,"click"],[1,"max-w-lg","mx-auto","space-y-4"],[1,"bg-white","rounded-xl","shadow-md","dark:bg-gray-800","dark:border","dark:border-gray-700","hover:shadow-lg","transition-all","duration-200","border","border-gray-100","cursor-pointer"],[1,"bg-white","rounded-xl","shadow-md","dark:bg-gray-800","p-8","text-center"],[1,"bg-white","rounded-xl","shadow-md","dark:bg-gray-800","dark:border","dark:border-gray-700","hover:shadow-lg","transition-all","duration-200","border","border-gray-100","cursor-pointer",3,"click"],[1,"p-4","border-b","border-gray-200","dark:border-gray-700"],[1,"flex","justify-between","items-start","gap-3"],[1,"flex-1"],[1,"flex","items-center","gap-2","mb-1"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"inline-flex","px-2","py-1","text-xs","font-semibold","rounded-full",3,"ngClass"],[1,"text-sm","text-gray-600","dark:text-gray-300"],[1,"text-right"],[1,"text-lg","font-bold","text-gray-900","dark:text-white"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"p-4"],[1,"grid","grid-cols-2","gap-4","mb-3"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"grid","grid-cols-3","gap-2","pt-3","border-t","border-gray-200","dark:border-gray-700"],[1,"text-sm","font-semibold","text-blue-600"],[1,"text-sm","font-semibold","text-green-600"],[1,"text-sm","font-semibold","text-gray-600"],[1,"mt-4","flex","gap-2"],[1,"flex-1","bg-green-600","hover:bg-green-700","text-white","px-3","py-2","rounded-lg","text-xs","font-medium","transition","duration-200",3,"click"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-3","py-2","rounded-lg","text-xs","font-medium","transition","duration-200"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-3","py-2","rounded-lg","text-xs","font-medium","transition","duration-200",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-12","h-12","text-gray-300","mx-auto","mb-4"],["d","M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"],["fill-rule","evenodd","d","M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6.586A2 2 0 0117.414 13L16 14.414V17a2 2 0 01-2 2H6a2 2 0 01-2-2v-2.586L2.586 13A2 2 0 012 11.414V5z","clip-rule","evenodd"],[1,"text-gray-500","dark:text-gray-400"],[1,"mt-4","bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition","duration-200",3,"click"]],template:function(i,a){i&1&&(t(0,"section",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4),u(5,"img",5),t(6,"span",6),o(7,"Hojas de Gasto"),e()(),t(8,"div",7)(9,"button",8),c("click",function(){return a.nuevaHoja()}),_(),t(10,"svg",9),u(11,"path",10),e(),o(12," Nueva "),e(),b(),t(13,"button",11),c("click",function(){return a.volver()}),_(),t(14,"svg",12),u(15,"path",13),e(),o(16," Volver "),e()()(),b(),t(17,"div",14)(18,"h1",15),o(19,"Hojas de Gasto Digital"),e(),t(20,"p",16),o(21,"Registro de gastos quir\xFArgicos por t\xE9cnicos"),e()()()(),j(22,O,9,0,"div",17)(23,P,10,1,"div",17)(24,q,28,2,"main",17),e()),i&2&&(s(22),h("ngIf",a.loading()),s(),h("ngIf",!a.loading()&&a.error()),s(),h("ngIf",!a.loading()&&!a.error()))},dependencies:[V,L,T],encapsulation:2})};export{M as HojaGastoListComponent};
