import{a as d}from"./chunk-SJD6D2CV.js";import{p as i,v as c}from"./chunk-3OSVPALZ.js";import{S as s}from"./chunk-MBDN4FSM.js";import{i as o}from"./chunk-ODN5LVDJ.js";var w=(f,u)=>o(null,null,function*(){let t=s(c),e=s(i);try{let n=(yield t.getSession())?.user?.id;if(!n)return e.navigate(["/auth"]),!1;let r=yield t.getUserProfile(n);return r?r.role==="client"?!0:(e.navigate(["/internal"]),!1):(e.navigate(["/"]),!1)}catch(a){return console.error("Error en clientGuard:",a),e.navigate(["/auth"]),!1}}),G=(f,u)=>o(null,null,function*(){let t=s(c),e=s(i);try{let n=(yield t.getSession())?.user?.id;if(!n)return e.navigate(["/auth"]),!1;let r=yield t.getUserProfile(n);return r?["comercial","soporte_tecnico","logistica","admin"].includes(r.role)?!0:(e.navigate(["/client"]),!1):(e.navigate(["/"]),!1)}catch(a){return console.error("Error en internalGuard:",a),e.navigate(["/auth"]),!1}}),y=(f,u)=>o(null,null,function*(){let t=s(c),e=s(i);try{let n=(yield t.getSession())?.user?.id;if(!n)return console.warn("\u{1F512} roleBasedGuard: No hay sesi\xF3n, redirigiendo a /auth"),e.navigate(["/auth"]),!1;let r=yield t.getUserProfile(n);if(!r)return console.warn("\u{1F512} roleBasedGuard: No se encontr\xF3 perfil"),e.navigate(["/"]),!1;let l=u.url;return d(r.role,l)?!0:(console.warn(`\u{1F6AB} roleBasedGuard: ${r.role} NO tiene acceso a ${l}`),e.navigate(["/internal"]),!1)}catch(a){return console.error("\u274C Error en roleBasedGuard:",a),e.navigate(["/internal"]),!1}});export{w as a,G as b,y as c};
