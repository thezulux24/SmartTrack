import{a as W}from"./chunk-PZ7IRRMX.js";import{a as Q}from"./chunk-ZLOYEDAT.js";import{c as z,d as M,f as y,g as H,h as T}from"./chunk-W4BNGQYG.js";import{a as j}from"./chunk-WUZJU462.js";import{a as O}from"./chunk-FSUY2M33.js";import{c as L,j as P,p as D,q as J,t as K,v as R}from"./chunk-WKDYGGS7.js";import{$ as f,Ab as u,Ia as l,S as v,Sa as E,Xa as b,Y as x,Z as _,_ as d,bb as Z,cb as w,eb as I,hb as C,kb as V,la as S,lb as A,mb as t,nb as i,ob as c,pb as k,sb as p,tb as m,yb as a,zb as F}from"./chunk-D2JNWC2G.js";import"./chunk-X5YLR3NI.js";import{i as g}from"./chunk-ODN5LVDJ.js";var te=(o,n)=>n.id;function ie(o,n){if(o&1&&(t(0,"span",4),c(1,"span",5),t(2,"span",6),a(3),i()()),o&2){let e=m();l(3),u(" ",e.notificationService.unreadCount()>9?"9+":e.notificationService.unreadCount()," ")}}function ne(o,n){if(o&1&&(t(0,"span",13),a(1),i()),o&2){let e=m(2);l(),u(" (",e.notificationService.unreadCount()," nuevas) ")}}function oe(o,n){if(o&1){let e=k();t(0,"button",24),p("click",function(){x(e);let s=m(2);return _(s.markAllAsRead())}),t(1,"span",25),a(2,"Marcar todas"),i(),t(3,"span",26),a(4,"Marcar"),i()()}}function re(o,n){o&1&&(t(0,"div",22),d(),t(1,"svg",27),c(2,"path",3),i(),f(),t(3,"p",28),a(4,"No hay notificaciones"),i()())}function ae(o,n){o&1&&c(0,"span",36)}function le(o,n){if(o&1){let e=k();t(0,"div",30),p("click",function(){let s=x(e).$implicit,h=m(3);return _(h.handleNotificationClick(s))}),t(1,"div",31)(2,"div",32),a(3),i(),t(4,"div",33)(5,"div",34)(6,"h4",35),a(7),i(),b(8,ae,1,0,"span",36),i(),t(9,"p",37),a(10),i(),t(11,"p",38),a(12),i()(),t(13,"div",39)(14,"button",40),p("click",function(s){let h=x(e).$implicit,N=m(3);return _(N.deleteNotification(s,h.id))}),d(),t(15,"svg",41),c(16,"path",42),i()()()()()}if(o&2){let e=n.$implicit,r=m(3);I("bg-blue-50",!e.read),l(2),w("ngClass",e.icon_color),l(),u(" ",e.icon," "),l(3),I("text-gray-900",!e.read)("text-gray-600",e.read),l(),u(" ",e.title," "),l(),C(e.read?-1:8),l(2),u(" ",e.message," "),l(2),u(" ",r.formatDate(e.created_at)," ")}}function se(o,n){if(o&1&&V(0,le,17,12,"div",29,te),o&2){let e=m(2);A(e.displayedNotifications())}}function ce(o,n){if(o&1){let e=k();t(0,"div",23)(1,"button",43),p("click",function(){x(e);let s=m(2);return _(s.clearAll())}),a(2," Limpiar todas "),i()()}}function de(o,n){if(o&1){let e=k();t(0,"div",7),p("click",function(){x(e);let s=m();return _(s.togglePanel())}),i(),t(1,"div",8)(2,"div",9),c(3,"div",10),t(4,"div",11)(5,"h3",12),a(6," Notificaciones "),b(7,ne,2,1,"span",13),i(),t(8,"div",14),b(9,oe,5,0,"button",15),t(10,"button",16),p("click",function(){x(e);let s=m();return _(s.togglePanel())}),d(),t(11,"svg",17),c(12,"path",18),i()()()(),f(),t(13,"div",19)(14,"button",20),p("click",function(){x(e);let s=m();return _(s.activeTab.set("all"))}),a(15),i(),t(16,"button",20),p("click",function(){x(e);let s=m();return _(s.activeTab.set("unread"))}),a(17),i()()(),t(18,"div",21),b(19,re,5,0,"div",22)(20,se,2,0),i(),b(21,ce,3,0,"div",23),i()}if(o&2){let e=m();l(7),C(e.notificationService.unreadCount()>0?7:-1),l(2),C(e.notificationService.unreadCount()>0?9:-1),l(5),I("border-blue-500",e.activeTab()==="all")("text-blue-600",e.activeTab()==="all")("border-transparent",e.activeTab()!=="all")("text-gray-500",e.activeTab()!=="all"),l(),u(" Todas (",e.notificationService.allNotifications().length,") "),l(),I("border-blue-500",e.activeTab()==="unread")("text-blue-600",e.activeTab()==="unread")("border-transparent",e.activeTab()!=="unread")("text-gray-500",e.activeTab()!=="unread"),l(),u(" No le\xEDdas (",e.notificationService.unreadCount(),") "),l(2),C(e.displayedNotifications().length===0?19:20),l(2),C(e.notificationService.allNotifications().length>0?21:-1)}}var B=class o{notificationService=v(j);isPanelOpen=S(!1);activeTab=S("all");displayedNotifications=()=>this.activeTab()==="all"?this.notificationService.allNotifications():this.notificationService.unreadNotifications();togglePanel(){this.isPanelOpen.update(n=>!n)}closePanel(){this.isPanelOpen.set(!1)}handleNotificationClick(n){return g(this,null,function*(){yield this.notificationService.navigateToNotification(n),this.closePanel()})}markAllAsRead(){return g(this,null,function*(){yield this.notificationService.markAllAsRead()})}deleteNotification(n,e){return g(this,null,function*(){n.stopPropagation(),yield this.notificationService.deleteNotification(e)})}clearAll(){return g(this,null,function*(){confirm("\xBFEst\xE1s seguro de que quieres eliminar todas las notificaciones?")&&(yield this.notificationService.clearAll(),this.closePanel())})}formatDate(n){let e=new Date(n),s=new Date().getTime()-e.getTime(),h=Math.floor(s/6e4),N=Math.floor(s/36e5),Y=Math.floor(s/864e5);return h<1?"Ahora":h<60?`Hace ${h} min`:N<24?`Hace ${N} h`:Y<7?`Hace ${Y} d\xEDas`:e.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-notification-panel"]],decls:6,vars:4,consts:[[1,"relative"],[1,"relative","p-2","text-gray-600","hover:text-gray-900","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"],[1,"absolute","top-1","right-1","flex","h-4","w-4"],[1,"animate-ping","absolute","inline-flex","h-full","w-full","rounded-full","bg-red-400","opacity-75"],[1,"relative","inline-flex","rounded-full","h-4","w-4","bg-red-500","text-white","text-[10px]","items-center","justify-center","font-bold"],[1,"fixed","inset-0","bg-black/50","z-40","md:hidden",3,"click"],[1,"fixed","md:absolute","inset-x-0","bottom-0","md:inset-x-auto","md:bottom-auto","md:right-0","md:mt-2","w-full","md:w-96","bg-white","rounded-t-2xl","md:rounded-lg","shadow-2xl","border-t","md:border","border-gray-200","z-50","max-h-[80vh]","md:max-h-[600px]","flex","flex-col"],[1,"p-4","border-b","border-gray-200","sticky","top-0","bg-white","z-10"],[1,"md:hidden","w-12","h-1","bg-gray-300","rounded-full","mx-auto","mb-3"],[1,"flex","items-center","justify-between"],[1,"font-semibold","text-gray-900","text-base","md:text-lg"],[1,"ml-2","text-xs","md:text-sm","text-gray-500"],[1,"flex","gap-2","items-center"],[1,"text-xs","md:text-sm","text-blue-600","hover:text-blue-800","font-medium","whitespace-nowrap"],[1,"text-gray-400","hover:text-gray-600","p-1",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"flex","gap-3","md:gap-4","mt-3"],[1,"text-xs","md:text-sm","font-medium","pb-2","border-b-2","transition-colors",3,"click"],[1,"flex-1","overflow-y-auto"],[1,"p-8","text-center","text-gray-500"],[1,"p-3","border-t","border-gray-200","bg-gray-50","sticky","bottom-0"],[1,"text-xs","md:text-sm","text-blue-600","hover:text-blue-800","font-medium","whitespace-nowrap",3,"click"],[1,"hidden","md:inline"],[1,"md:hidden"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-4","text-gray-300"],[1,"text-sm"],[1,"p-3","md:p-4","border-b","border-gray-100","hover:bg-gray-50","active:bg-gray-100","cursor-pointer","transition-colors",3,"bg-blue-50"],[1,"p-3","md:p-4","border-b","border-gray-100","hover:bg-gray-50","active:bg-gray-100","cursor-pointer","transition-colors",3,"click"],[1,"flex","items-start","gap-2","md:gap-3"],[1,"text-xl","md:text-2xl","flex-shrink-0",3,"ngClass"],[1,"flex-1","min-w-0"],[1,"flex","items-start","justify-between","gap-2"],[1,"font-medium","text-xs","md:text-sm","leading-tight"],[1,"flex-shrink-0","w-2","h-2","bg-blue-500","rounded-full","mt-1"],[1,"text-[11px]","md:text-xs","text-gray-600","mt-1","line-clamp-2","leading-snug"],[1,"text-[10px]","md:text-xs","text-gray-400","mt-1.5","md:mt-2"],[1,"flex-shrink-0"],["title","Eliminar",1,"text-gray-400","hover:text-red-600","active:text-red-700","transition-colors","p-1","md:p-1.5",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3.5","h-3.5","md:w-4","md:h-4"],["fill-rule","evenodd","d","M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"w-full","text-xs","md:text-sm","text-red-600","hover:text-red-800","active:text-red-900","font-medium","py-2","md:py-2.5","rounded-lg","hover:bg-red-50","active:bg-red-100","transition-colors",3,"click"]],template:function(e,r){e&1&&(t(0,"div",0)(1,"button",1),p("click",function(){return r.togglePanel()}),d(),t(2,"svg",2),c(3,"path",3),i(),b(4,ie,4,1,"span",4),i(),b(5,de,22,22),i()),e&2&&(l(),I("bg-gray-100",r.isPanelOpen()),l(3),C(r.notificationService.unreadCount()>0?4:-1),l(),C(r.isPanelOpen()?5:-1))},dependencies:[P,L],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})};var me=(o,n)=>n.id;function pe(o,n){if(o&1){let e=k();t(0,"div",2),p("click",function(){let s=x(e).$implicit,h=m();return _(h.handleToastClick(s))}),t(1,"div",3)(2,"div",4),a(3),i(),t(4,"div",5)(5,"h4",6),a(6),i(),t(7,"p",7),a(8),i()(),t(9,"button",8),p("click",function(s){let h=x(e).$implicit,N=m();return _(N.closeToast(s,h.id))}),d(),t(10,"svg",9),c(11,"path",10),i()()(),f(),t(12,"div",11),c(13,"div",12),i()()}if(o&2){let e=n.$implicit,r=m();w("ngClass",r.getBorderColor(e.priority))("@slideIn",void 0),l(2),w("ngClass",e.icon_color),l(),u(" ",e.icon," "),l(3),u(" ",e.title," "),l(2),u(" ",e.message," "),l(5),w("ngClass",r.getProgressColor(e.priority))}}var G=class o{notificationService=v(j);router=v(D);getBorderColor(n){return{low:"border-gray-400",medium:"border-blue-500",high:"border-orange-500",urgent:"border-red-500"}[n]||"border-gray-400"}getProgressColor(n){return{low:"bg-gray-400",medium:"bg-blue-500",high:"bg-orange-500",urgent:"bg-red-500"}[n]||"bg-gray-400"}handleToastClick(n){return g(this,null,function*(){yield this.notificationService.navigateToNotification(n),this.notificationService.removeToast(n.id)})}closeToast(n,e){n.stopPropagation(),this.notificationService.removeToast(e)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-notification-toast"]],decls:3,vars:0,consts:[[1,"fixed","top-4","right-4","left-4","md:left-auto","z-50","space-y-2","max-w-md","md:max-w-md","mx-auto","md:mx-0"],[1,"bg-white","rounded-lg","shadow-2xl","border-l-4","overflow-hidden","transform","transition-all","duration-300","hover:scale-[1.02]","active:scale-100","cursor-pointer",3,"ngClass"],[1,"bg-white","rounded-lg","shadow-2xl","border-l-4","overflow-hidden","transform","transition-all","duration-300","hover:scale-[1.02]","active:scale-100","cursor-pointer",3,"click","ngClass"],[1,"p-3","md:p-4","flex","items-start","gap-2","md:gap-3"],[1,"text-xl","md:text-2xl","flex-shrink-0",3,"ngClass"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-gray-900","text-xs","md:text-sm","mb-1","truncate"],[1,"text-gray-600","text-[11px]","md:text-xs","line-clamp-2","leading-snug"],[1,"flex-shrink-0","text-gray-400","hover:text-gray-600","active:text-gray-700","transition-colors","p-1",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3.5","h-3.5","md:w-4","md:h-4"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"h-1","bg-gray-100"],[1,"h-full","transition-all","duration-[5000ms]","ease-linear",2,"width","0%","animation","progressBar 5s linear",3,"ngClass"]],template:function(e,r){e&1&&(t(0,"div",0),V(1,pe,14,7,"div",1,me),i()),e&2&&(l(),A(r.notificationService.activeToasts()))},dependencies:[P,L],styles:["@keyframes _ngcontent-%COMP%_progressBar{0%{width:100%}to{width:0%}}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"],data:{animation:[z("slideIn",[T(":enter",[y({transform:"translateX(400px)",opacity:0}),M("300ms ease-out",y({transform:"translateX(0)",opacity:1}))]),T(":leave",[M("200ms ease-in",y({transform:"translateX(400px)",opacity:0}))])])]}})};function ue(o,n){o&1&&c(0,"div",2)}function fe(o,n){if(o&1){let e=k();t(0,"div",53),p("click",function(){x(e);let s=m();return _(s.closeMenu())}),i()}o&2&&w("@fadeIn",void 0)}var U=class o{supabaseService=v(R);authService=v(O);router=v(D);isMenuOpen=S(!1);userProfile=S(null);ngOnInit(){return g(this,null,function*(){yield this.loadUserProfile()})}loadUserProfile(){return g(this,null,function*(){try{let n=yield this.supabaseService.getSession();if(n?.user?.id){let e=yield this.supabaseService.getUserProfile(n.user.id);e&&this.userProfile.set({full_name:e.full_name||"Usuario",email:n.user.email||"Sin email",role:e.role||"Sin rol"})}}catch(n){console.error("Error loading user profile:",n)}})}toggleMenu(){this.isMenuOpen.set(!this.isMenuOpen())}closeMenu(){this.isMenuOpen.set(!1)}getInitial(){return(this.userProfile()?.full_name||"U").charAt(0).toUpperCase()}getRoleDisplay(){let n=this.userProfile()?.role||"";return{admin:"Administrador",comercial:"Comercial",logistica:"Log\xEDstica",soporte_tecnico:"Soporte T\xE9cnico",client:"Cliente"}[n]||n}navigateTo(n){this.closeMenu(),this.router.navigate([n])}logout(){return g(this,null,function*(){this.closeMenu(),yield this.authService.logOut(),this.router.navigate(["/auth/log-in"])})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-profile-menu"]],decls:79,vars:8,consts:[[1,"relative","flex","items-center","justify-center","w-10","h-10","rounded-full","bg-gradient-to-br","from-[#C8D900]","to-[#0098A8]","hover:scale-105","transition-transform","duration-200","shadow-lg","ring-2","ring-white/30",3,"click"],[1,"text-[#10284C]","font-bold","text-lg"],[1,"absolute","-bottom-1","-right-1","w-3","h-3","bg-[#C8D900]","rounded-full","border-2","border-[#10284C]"],[1,"fixed","inset-0","bg-black/50","backdrop-blur-sm","z-40"],[1,"fixed","top-0","right-0","h-full","w-80","bg-white","shadow-2xl","z-50","flex","flex-col"],[1,"relative","bg-gradient-to-br","from-[#10284C]","via-[#0098A8]","to-[#0098A8]","p-6","pb-20"],[1,"absolute","top-4","right-4","text-white/80","hover:text-white","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","flex-col","items-center","mt-4"],[1,"w-20","h-20","rounded-full","bg-gradient-to-br","from-[#C8D900]","to-[#C8D900]/80","flex","items-center","justify-center","shadow-xl","ring-4","ring-white/30"],[1,"text-[#10284C]","font-bold","text-3xl"],[1,"bg-gradient-to-br","from-white","to-[#0098A8]/3","-mt-12","mx-4","rounded-2xl","shadow-lg","p-6","relative","z-10"],[1,"text-center"],[1,"text-xl","font-bold","text-[#10284C]","mb-1"],[1,"text-sm","text-gray-600","mb-3"],[1,"inline-flex","items-center","gap-2","px-4","py-2","bg-gradient-to-r","from-[#0098A8]","to-[#0098A8]/80","rounded-full","shadow-md"],[1,"w-2","h-2","bg-[#C8D900]","rounded-full","animate-pulse"],[1,"text-sm","font-bold","text-white"],[1,"flex-1","overflow-y-auto","p-4"],[1,"space-y-2"],[1,"w-full","flex","items-center","gap-3","p-3","rounded-xl","hover:bg-gradient-to-r","hover:from-[#0098A8]/5","hover:to-[#C8D900]/5","transition-all","duration-200","group","border","border-transparent","hover:border-[#0098A8]/20",3,"click"],[1,"w-10","h-10","rounded-lg","bg-gradient-to-br","from-[#0098A8]","to-[#0098A8]/80","flex","items-center","justify-center","shadow-md","group-hover:shadow-lg","transition-shadow"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"flex-1","text-left"],[1,"text-sm","font-bold","text-gray-900","group-hover:text-[#0098A8]","transition-colors"],[1,"text-xs","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","group-hover:text-[#0098A8]","group-hover:translate-x-1","transition-all"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"w-full","flex","items-center","gap-3","p-3","rounded-xl","hover:bg-gradient-to-r","hover:from-[#C8D900]/5","hover:to-[#0098A8]/5","transition-all","duration-200","group","border","border-transparent","hover:border-[#C8D900]/20",3,"click"],[1,"w-10","h-10","rounded-lg","bg-gradient-to-br","from-[#C8D900]","to-[#C8D900]/80","flex","items-center","justify-center","shadow-md","group-hover:shadow-lg","transition-shadow"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-[#10284C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"text-sm","font-bold","text-gray-900","group-hover:text-[#C8D900]","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","group-hover:text-[#C8D900]","group-hover:translate-x-1","transition-all"],[1,"w-full","flex","items-center","gap-3","p-3","rounded-xl","hover:bg-gradient-to-r","hover:from-[#10284C]/5","hover:to-[#0098A8]/5","transition-all","duration-200","group","border","border-transparent","hover:border-[#10284C]/20",3,"click"],[1,"w-10","h-10","rounded-lg","bg-gradient-to-br","from-[#10284C]","to-[#10284C]/80","flex","items-center","justify-center","shadow-md","group-hover:shadow-lg","transition-shadow"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"],[1,"text-sm","font-bold","text-gray-900","group-hover:text-[#10284C]","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-400","group-hover:text-[#10284C]","group-hover:translate-x-1","transition-all"],[1,"py-2"],[1,"border-t-2","border-[#C8D900]/20"],[1,"w-full","flex","items-center","gap-3","p-3","rounded-xl","hover:bg-gradient-to-r","hover:from-gray-50","hover:to-[#0098A8]/5","transition-all","duration-200","group","border","border-transparent","hover:border-gray-200",3,"click"],[1,"w-10","h-10","rounded-lg","bg-gradient-to-br","from-gray-100","to-gray-200","flex","items-center","justify-center","shadow-md","group-hover:shadow-lg","transition-shadow"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-gray-600","group-hover:text-[#0098A8]","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"p-4","border-t-2","border-[#10284C]/20","bg-gradient-to-b","from-gray-50","to-white"],[1,"w-full","flex","items-center","justify-center","gap-3","p-4","rounded-xl","bg-gradient-to-r","from-red-500","to-red-600","hover:from-red-600","hover:to-red-700","text-white","transition-all","duration-200","shadow-lg","hover:shadow-2xl","transform","hover:scale-[1.02]","border-2","border-red-700/20",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"],[1,"font-semibold"],[1,"fixed","inset-0","bg-black/50","backdrop-blur-sm","z-40",3,"click"]],template:function(e,r){if(e&1&&(t(0,"button",0),p("click",function(){return r.toggleMenu()}),t(1,"span",1),a(2),i(),b(3,ue,1,0,"div",2),i(),b(4,fe,1,1,"div",3),t(5,"div",4)(6,"div",5)(7,"button",6),p("click",function(){return r.closeMenu()}),d(),t(8,"svg",7),c(9,"path",8),i()(),f(),t(10,"div",9)(11,"div",10)(12,"span",11),a(13),i()()()(),t(14,"div",12)(15,"div",13)(16,"h3",14),a(17),i(),t(18,"p",15),a(19),i(),t(20,"div",16),c(21,"div",17),t(22,"span",18),a(23),i()()()(),t(24,"div",19)(25,"div",20)(26,"button",21),p("click",function(){return r.navigateTo("/internal/perfil")}),t(27,"div",22),d(),t(28,"svg",23),c(29,"path",24),i()(),f(),t(30,"div",25)(31,"p",26),a(32,"Mi Perfil"),i(),t(33,"p",27),a(34,"Editar informaci\xF3n"),i()(),d(),t(35,"svg",28),c(36,"path",29),i()(),f(),t(37,"button",30),p("click",function(){return r.navigateTo("/internal/configuracion")}),t(38,"div",31),d(),t(39,"svg",32),c(40,"path",33)(41,"path",34),i()(),f(),t(42,"div",25)(43,"p",35),a(44,"Configuraci\xF3n"),i(),t(45,"p",27),a(46,"Preferencias"),i()(),d(),t(47,"svg",36),c(48,"path",29),i()(),f(),t(49,"button",37),p("click",function(){return r.navigateTo("/internal/notificaciones")}),t(50,"div",38),d(),t(51,"svg",23),c(52,"path",39),i()(),f(),t(53,"div",25)(54,"p",40),a(55,"Notificaciones"),i(),t(56,"p",27),a(57,"Preferencias de alertas"),i()(),d(),t(58,"svg",41),c(59,"path",29),i()(),f(),t(60,"div",42),c(61,"div",43),i(),t(62,"button",44),p("click",function(){return r.navigateTo("/internal/ayuda")}),t(63,"div",45),d(),t(64,"svg",46),c(65,"path",47),i()(),f(),t(66,"div",25)(67,"p",26),a(68,"Ayuda y Soporte"),i(),t(69,"p",27),a(70,"Centro de ayuda"),i()(),d(),t(71,"svg",28),c(72,"path",29),i()()()(),f(),t(73,"div",48)(74,"button",49),p("click",function(){return r.logout()}),d(),t(75,"svg",50),c(76,"path",51),i(),f(),t(77,"span",52),a(78,"Cerrar Sesi\xF3n"),i()()()()),e&2){let s,h;l(2),u(" ",r.getInitial()," "),l(),C(r.isMenuOpen()?3:-1),l(),C(r.isMenuOpen()?4:-1),l(),w("@slideIn",r.isMenuOpen()?"open":"closed"),l(8),u(" ",r.getInitial()," "),l(4),u(" ",((s=r.userProfile())==null?null:s.full_name)||"Usuario"," "),l(2),u(" ",((h=r.userProfile())==null?null:h.email)||"Sin email"," "),l(4),u(" ",r.getRoleDisplay()," ")}},dependencies:[P],encapsulation:2,data:{animation:[z("slideIn",[H("closed",y({transform:"translateX(100%)",opacity:0})),H("open",y({transform:"translateX(0)",opacity:1})),T("closed => open",[M("300ms cubic-bezier(0.4, 0, 0.2, 1)")]),T("open => closed",[M("250ms cubic-bezier(0.4, 0, 0.2, 1)")])]),z("fadeIn",[T(":enter",[y({opacity:0}),M("200ms",y({opacity:1}))]),T(":leave",[M("150ms",y({opacity:0}))])])]}})};var ge=(o,n)=>n.route;function ve(o,n){if(o&1&&(t(0,"span",26),a(1),i()),o&2){let e=m(2);l(),u(" ",e.totalUnreadMessages()>99?"99+":e.totalUnreadMessages()," ")}}function he(o,n){if(o&1&&(t(0,"a",19)(1,"div",21)(2,"div",22)(3,"div",23),d(),t(4,"svg",24),c(5,"path",25),i(),b(6,ve,2,1,"span",26),i(),f(),t(7,"div")(8,"h2",27),a(9),i(),t(10,"p",28),a(11),i()()(),d(),t(12,"svg",29),c(13,"path",30),i()()()),o&2){let e=n.$implicit,r=m();w("routerLink",e.route),l(5),Z("d",r.getIconPath(e.icon)),l(),C(e.route==="/internal/chat"&&r.totalUnreadMessages()>0?6:-1),l(3),F(e.title),l(2),F(e.description)}}function xe(o,n){o&1&&(t(0,"div",20)(1,"div",31),d(),t(2,"svg",32),c(3,"path",33),i()(),f(),t(4,"h3",34),a(5,"Sin m\xF3dulos disponibles"),i(),t(6,"p",35),a(7,"No tienes permisos asignados. Contacta al administrador."),i()())}var X=class o{_authService=v(O);_router=v(D);_chatService=v(W);_supabaseService=v(R);notificationService=v(j);totalUnreadMessages=S(0);userRole=S("");menuItems=S([]);allMenuItems=[{route:"/internal/chat",title:"Mensajes",description:"Chat por cirug\xEDa",icon:"chat",roles:["admin","comercial","logistica","soporte_tecnico"]},{route:"/internal/agenda",title:"Agenda",description:"Gesti\xF3n de cirug\xEDas",icon:"calendar",roles:["admin","comercial","logistica"]},{route:"/internal/agenda/mi-agenda",title:"Mi Agenda",description:"Mis cirug\xEDas asignadas",icon:"calendar",roles:["soporte_tecnico"]},{route:"/internal/clientes",title:"Clientes",description:"Gesti\xF3n de clientes",icon:"users",roles:["admin","comercial","logistica"]},{route:"/internal/cotizaciones",title:"Cotizaciones",description:"Propuestas comerciales",icon:"currency",roles:["admin","comercial"]},{route:"/internal/logistica",title:"Log\xEDstica",description:"Gesti\xF3n de kits",icon:"clipboard",roles:["admin","logistica"]},{route:"/internal/inventario",title:"Inventario",description:"Control de stock",icon:"cube",roles:["admin","logistica","soporte_tecnico"]},{route:"/internal/tecnico",title:"Validaci\xF3n T\xE9cnica",description:"Recepci\xF3n de kits",icon:"check-circle",roles:["admin","soporte_tecnico"]},{route:"/internal/limpieza",title:"Recepci\xF3n de Limpieza",description:"Confirmar productos limpios",icon:"check",roles:["admin","soporte_tecnico"]},{route:"/internal/hojas-gasto",title:"Hojas de Gasto",description:"Registro de gastos",icon:"document",roles:["admin","comercial","soporte_tecnico"]},{route:"/internal/trazabilidad",title:"Trazabilidad",description:"Seguimiento completo",icon:"clock",roles:["admin","comercial","logistica","soporte_tecnico"]}];ngOnInit(){return g(this,null,function*(){yield this.loadUserRole(),yield this.loadUnreadMessagesCount(),yield this.initializeNotifications(),setInterval(()=>{this.loadUnreadMessagesCount()},3e4)})}loadUserRole(){return g(this,null,function*(){try{let n=yield this._supabaseService.getSession();if(n?.user?.id){let e=yield this._supabaseService.getUserProfile(n.user.id);e&&(this.userRole.set(e.role),this.filterMenuByRole(e.role))}}catch(n){console.error("Error loading user role:",n)}})}filterMenuByRole(n){let e=this.allMenuItems.filter(r=>r.roles.includes(n)?Q(n,r.route):!1);this.menuItems.set(e),console.log(`\u{1F4CB} Men\xFA filtrado para rol ${n}:`,e.length,"items")}initializeNotifications(){return g(this,null,function*(){try{let{data:n}=yield this._authService.session();n?.session?.user&&(yield this.notificationService.initialize(n.session.user.id))}catch(n){console.error("Error initializing notifications:",n)}})}loadUnreadMessagesCount(){return g(this,null,function*(){try{yield this._chatService.actualizarUnreadCounts(),this._chatService.unreadCounts$.subscribe(n=>{let e=Array.from(n.values()).reduce((r,s)=>r+s,0);this.totalUnreadMessages.set(e)})}catch(n){console.error("Error loading unread messages:",n)}})}getIconPath(n){let e={chat:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",calendar:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",users:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z",currency:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",clipboard:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4",cube:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4","check-circle":"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",check:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",document:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",clock:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"};return e[n]||e.check}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-internal-home"]],decls:45,vars:1,consts:[[1,"min-h-screen","relative","bg-white"],[1,"relative","overflow-hidden","bg-gradient-to-b","from-[#10284C]","via-[#0098A8]","to-[#0098A8]"],["src","05.jpg","alt","Medical background",1,"absolute","inset-0","w-full","h-full","object-cover","object-top","opacity-40","z-0"],[1,"relative","z-10"],[1,"px-4","py-6"],[1,"max-w-lg","mx-auto"],[1,"flex","justify-between","items-center","mb-8"],["src","https://www.implameq.com/wp-content/uploads/logotipo-impla-300x78.png.webp","alt","Implameq",1,"h-10","brightness-0","invert"],[1,"flex","items-center","gap-3"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold","text-[#C8D900]","mb-2"],[1,"text-white/90","text-sm"],[1,"grid","grid-cols-2","gap-5","pb-16"],[1,"bg-[#0098A8]/20","backdrop-blur-sm","rounded-2xl","border-2","border-[#C8D900]","p-5"],[1,"text-4xl","font-bold","text-white","mb-1"],["viewBox","0 0 1440 160","preserveAspectRatio","none","aria-hidden","true",1,"pointer-events-none","absolute","bottom-0","left-0","w-full","h-20","sm:h-24","md:h-28","lg:h-32","z-0"],["d","M0,96 C240,136 480,144 720,112 C960,80 1200,64 1440,104 L1440,160 L0,160 Z","fill","#ffffff"],[1,"bg-white","px-4","pt-6","pb-8"],[1,"max-w-lg","mx-auto","space-y-5"],[1,"block","bg-[#10284C]","rounded-2xl","p-5","hover:bg-[#10284C]/90","transition-all","duration-200","relative",3,"routerLink"],[1,"text-center","py-12"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"w-14","h-14","bg-[#C8D900]","rounded-xl","flex","items-center","justify-center","flex-shrink-0","relative"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-[#10284C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"absolute","-top-1","-right-1","min-w-[20px]","h-5","px-1","bg-red-500","text-white","text-xs","font-bold","rounded-full","flex","items-center","justify-center","animate-pulse"],[1,"text-lg","font-bold","text-white"],[1,"text-sm","text-white/70"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-[#0098A8]","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"inline-flex","items-center","justify-center","w-16","h-16","bg-[#C8D900]","rounded-full","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-[#10284C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],[1,"text-lg","font-semibold","text-[#10284C]","mb-2"],[1,"text-gray-600"]],template:function(e,r){e&1&&(t(0,"div",0),c(1,"app-notification-toast"),t(2,"div",1),c(3,"img",2),t(4,"div",3)(5,"header",4)(6,"div",5)(7,"div",6),c(8,"img",7),t(9,"div",8),c(10,"app-notification-panel")(11,"app-profile-menu"),i()(),t(12,"div",9)(13,"h1",10),a(14,"Dashboard Operativo"),i(),t(15,"p",11),a(16,"Panel de control para gesti\xF3n interna"),i()(),t(17,"div",12)(18,"div",13)(19,"div",14),a(20,"12"),i(),t(21,"div",11),a(22,"Cirug\xEDas Hoy"),i()(),t(23,"div",13)(24,"div",14),a(25,"03"),i(),t(26,"div",11),a(27,"Stock Cr\xEDtico"),i()(),t(28,"div",13)(29,"div",14),a(30,"07"),i(),t(31,"div",11),a(32,"Soporte pendiente"),i()(),t(33,"div",13)(34,"div",14),a(35,"85%"),i(),t(36,"div",11),a(37,"Facturaci\xF3n"),i()()()()()(),d(),t(38,"svg",15),c(39,"path",16),i()(),f(),t(40,"div",17)(41,"div",18),V(42,he,14,5,"a",19,ge),b(44,xe,8,0,"div",20),i()()()),e&2&&(l(42),A(r.menuItems()),l(2),C(r.menuItems().length===0?44:-1))},dependencies:[P,K,J,B,G,U],encapsulation:2})};export{X as default};
