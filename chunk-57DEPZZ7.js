import{a as d}from"./chunk-ZLOYEDAT.js";import{p as c,v as u}from"./chunk-WKDYGGS7.js";import{S as o}from"./chunk-D2JNWC2G.js";import{i}from"./chunk-ODN5LVDJ.js";var G=(f,l)=>i(null,null,function*(){let t=o(u),e=o(c);try{let n=(yield t.getSession())?.user?.id;if(!n)return e.navigate(["/auth"]),!1;let r=yield t.getUserProfile(n);return r?r.role==="client"?!0:(e.navigate(["/internal"]),!1):(e.navigate(["/"]),!1)}catch(a){return console.error("Error en clientGuard:",a),e.navigate(["/auth"]),!1}}),w=(f,l)=>i(null,null,function*(){let t=o(u),e=o(c);try{let n=(yield t.getSession())?.user?.id;if(!n)return e.navigate(["/auth"]),!1;let r=yield t.getUserProfile(n);return r?["comercial","soporte_tecnico","logistica","admin"].includes(r.role)?!0:(e.navigate(["/client"]),!1):(e.navigate(["/"]),!1)}catch(a){return console.error("Error en internalGuard:",a),e.navigate(["/auth"]),!1}}),y=(f,l)=>i(null,null,function*(){let t=o(u),e=o(c);try{let n=(yield t.getSession())?.user?.id;if(!n)return console.warn("\u{1F512} roleBasedGuard: No hay sesi\xF3n, redirigiendo a /auth"),e.navigate(["/auth"]),!1;let r=yield t.getUserProfile(n);if(!r)return console.warn("\u{1F512} roleBasedGuard: No se encontr\xF3 perfil"),e.navigate(["/"]),!1;let s=l.url;return d(r.role,s)?(console.log(`\u2705 roleBasedGuard: ${r.role} tiene acceso a ${s}`),!0):(console.warn(`\u{1F6AB} roleBasedGuard: ${r.role} NO tiene acceso a ${s}`),e.navigate(["/internal"]),!1)}catch(a){return console.error("\u274C Error en roleBasedGuard:",a),e.navigate(["/internal"]),!1}});export{G as a,w as b,y as c};
