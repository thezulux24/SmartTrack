import{a as V}from"./chunk-PZ7IRRMX.js";import"./chunk-WUZJU462.js";import{j as I,p as j,q as T}from"./chunk-WKDYGGS7.js";import{$ as x,Ab as p,Hb as D,Ia as o,S as C,Sa as y,Xa as f,Y as _,Z as v,_ as c,cb as w,gb as S,hb as u,kb as L,la as b,lb as M,mb as e,nb as t,ob as d,pb as k,sb as h,tb as m,yb as i,zb as E}from"./chunk-D2JNWC2G.js";import"./chunk-X5YLR3NI.js";import"./chunk-ODN5LVDJ.js";var F=()=>["/internal/agenda"],H=(a,r)=>r.cirugia_id;function z(a,r){a&1&&(e(0,"div",13)(1,"div",15),d(2,"div",16),e(3,"p",17),i(4,"Cargando chats..."),t()()())}function O(a,r){if(a&1){let n=k();e(0,"div",14)(1,"div",18),c(),e(2,"svg",19),d(3,"path",20),t(),x(),e(4,"h3",21),i(5,"Error"),t(),e(6,"p",22),i(7),t(),e(8,"button",23),h("click",function(){_(n);let s=m();return v(s.refrescar())}),i(9," Reintentar "),t()()()}if(a&2){let n=m();o(7),E(n.error())}}function B(a,r){a&1&&(e(0,"div",24)(1,"div",27),c(),e(2,"svg",28),d(3,"path",29),t(),x(),e(4,"h3",30),i(5,"No hay conversaciones activas"),t(),e(6,"p",31),i(7,"Los chats aparecen autom\xE1ticamente cuando se crean cirug\xEDas."),t(),e(8,"div",32)(9,"h4",33),i(10,"\u{1F4A1} \xBFC\xF3mo iniciar un chat?"),t(),e(11,"ol",34)(12,"li",35)(13,"span",36),i(14,"1."),t(),e(15,"span"),i(16,"Ve a "),e(17,"strong"),i(18,"Agenda"),t()()(),e(19,"li",35)(20,"span",36),i(21,"2."),t(),e(22,"span"),i(23,"Selecciona una cirug\xEDa"),t()(),e(24,"li",35)(25,"span",36),i(26,"3."),t(),e(27,"span"),i(28,"Haz clic en el bot\xF3n "),e(29,"strong"),i(30,"Chat"),t()()()()(),e(31,"button",37),c(),e(32,"svg",38),d(33,"path",39),t(),i(34," Ir a Agenda "),t()()()),a&2&&(o(31),w("routerLink",D(1,F)))}function G(a,r){if(a&1&&(e(0,"span",53),i(1),t()),a&2){let n=m().$implicit;o(),p(" ",n.mensajes_no_leidos," ")}}function P(a,r){if(a&1){let n=k();e(0,"button",40),h("click",function(){let s=_(n).$implicit,g=m(2);return v(g.abrirChat(s.cirugia_id))}),e(1,"div",41)(2,"div",42)(3,"div",43)(4,"h3",44),i(5),t(),e(6,"span"),i(7),t()(),e(8,"p",45)(9,"span",46),i(10),t(),i(11),t(),e(12,"div",47)(13,"div",48),c(),e(14,"svg",49),d(15,"path",50),t(),x(),e(16,"span"),i(17),t()()()(),e(18,"div",51)(19,"span",52),i(20),t(),f(21,G,2,1,"span",53),t()()()}if(a&2){let n=r.$implicit,l=m(2);o(5),E(n.numero_cirugia),o(),S("px-2 py-0.5 rounded-full text-xs font-medium border ",l.getEstadoColor(n.estado_cirugia),""),o(),p(" ",l.getEstadoLabel(n.estado_cirugia)," "),o(3),p("",n.ultimo_mensaje_usuario,":"),o(),p(" ",n.ultimo_mensaje," "),o(6),p("",n.participantes_count," participantes"),o(3),p(" ",l.formatearFecha(n.ultimo_mensaje_fecha)," "),o(),u(n.mensajes_no_leidos>0?21:-1)}}function R(a,r){if(a&1&&(e(0,"div",2),f(1,B,35,2,"div",24),e(2,"div",25),L(3,P,22,10,"button",26,H),t()()),a&2){let n=m();o(),u(n.chats().length===0?1:-1),o(2),M(n.chats())}}var A=class a{chatService=C(V);router=C(j);chats=b([]);loading=b(!0);error=b(null);ngOnInit(){this.cargarChats()}cargarChats(){this.loading.set(!0),this.error.set(null),this.chatService.getChatList().subscribe({next:r=>{this.chats.set(r),this.loading.set(!1)},error:r=>{console.error("Error al cargar chats:",r),this.error.set("Error al cargar los chats"),this.loading.set(!1)}})}abrirChat(r){this.router.navigate(["/internal/chat",r])}getEstadoColor(r){return{programada:"bg-blue-500/20 text-blue-300 border-blue-400/40",en_curso:"bg-green-500/20 text-green-300 border-green-400/40",completada:"bg-gray-500/20 text-gray-300 border-gray-400/40",cancelada:"bg-red-500/20 text-red-300 border-red-400/40",urgencia:"bg-red-500/30 text-red-200 border-red-400/50"}[r]||"bg-gray-500/20 text-gray-300"}getEstadoLabel(r){return{programada:"Programada",en_curso:"En Curso",completada:"Completada",cancelada:"Cancelada",urgencia:"Urgencia"}[r]||r}formatearFecha(r){let n=new Date(r),l=new Date,s=new Date(l);s.setDate(s.getDate()-1);let g=n.toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"});return n.toDateString()===l.toDateString()?g:n.toDateString()===s.toDateString()?`Ayer ${g}`:n.toLocaleDateString("es-CO",{day:"2-digit",month:"short"})}volver(){this.router.navigate(["/internal"])}refrescar(){this.cargarChats()}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=y({type:a,selectors:[["app-chat-list"]],decls:18,vars:7,consts:[[1,"min-h-screen","bg-gradient-to-br","from-[#10284C]","via-[#0e1f3a]","to-[#0a1628]","pb-safe"],[1,"sticky","top-0","z-50","bg-[#10284C]/95","backdrop-blur-md","border-b","border-white/10","shadow-xl"],[1,"px-4","py-4"],[1,"flex","items-center","justify-between","mb-3"],[1,"p-2","rounded-lg","bg-white/10","hover:bg-white/20","text-white","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"flex-1","text-center"],[1,"text-2xl","font-bold","text-[#C8D900]"],[1,"text-sm","text-white/60"],[1,"p-2","rounded-lg","bg-white/10","hover:bg-white/20","text-white","transition-colors","disabled:opacity-50",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"flex","items-center","justify-center","h-96"],[1,"p-4"],[1,"text-center"],[1,"w-12","h-12","border-4","border-[#C8D900]","border-t-transparent","rounded-full","animate-spin","mx-auto","mb-4"],[1,"text-white/70"],[1,"bg-red-500/20","border","border-red-500","rounded-xl","p-6","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-red-500","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-xl","font-bold","text-red-500","mb-2"],[1,"text-white"],[1,"mt-4","px-6","py-2","bg-[#C8D900]","text-[#10284C]","rounded-lg","font-semibold","hover:bg-[#b5c500]","transition-colors",3,"click"],[1,"max-w-md","mx-auto"],[1,"space-y-3"],[1,"w-full","bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","p-4","hover:bg-[#0098A8]/30","transition-all","shadow-lg","text-left"],[1,"bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","p-8","text-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-20","h-20","text-[#C8D900]","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"],[1,"text-xl","font-bold","text-white","mb-3"],[1,"text-white/70","mb-6"],[1,"bg-[#10284C]/50","rounded-xl","p-4","mb-6","text-left"],[1,"text-sm","font-bold","text-[#C8D900]","mb-2"],[1,"text-sm","text-white/80","space-y-2"],[1,"flex","items-start","gap-2"],[1,"text-[#C8D900]","font-bold"],[1,"w-full","bg-[#C8D900]","hover:bg-[#b5c500]","text-[#10284C]","font-bold","py-3","rounded-xl","transition-colors","flex","items-center","justify-center","gap-2",3,"routerLink"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"w-full","bg-[#0098A8]/20","backdrop-blur-md","rounded-2xl","border","border-white/20","p-4","hover:bg-[#0098A8]/30","transition-all","shadow-lg","text-left",3,"click"],[1,"flex","items-start","justify-between","gap-3"],[1,"flex-1","min-w-0"],[1,"flex","items-center","gap-2","mb-1"],[1,"text-lg","font-bold","text-white","truncate"],[1,"text-sm","text-white/70","truncate","mb-2"],[1,"font-medium"],[1,"flex","items-center","gap-3","text-xs","text-white/50"],[1,"flex","items-center","gap-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"flex","flex-col","items-end","gap-2","flex-shrink-0"],[1,"text-xs","text-white/40","whitespace-nowrap"],[1,"px-2","py-1","bg-[#C8D900]","text-[#10284C]","rounded-full","text-xs","font-bold","min-w-[24px]","text-center"]],template:function(n,l){n&1&&(e(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"button",4),h("click",function(){return l.volver()}),c(),e(5,"svg",5),d(6,"path",6),t()(),x(),e(7,"div",7)(8,"h1",8),i(9,"Mensajes"),t(),e(10,"p",9),i(11,"Chats por cirug\xEDa"),t()(),e(12,"button",10),h("click",function(){return l.refrescar()}),c(),e(13,"svg",11),d(14,"path",12),t()()()()(),f(15,z,5,0,"div",13)(16,O,10,1,"div",14)(17,R,5,1,"div",2),t()),n&2&&(o(12),w("disabled",l.loading()),o(),S("w-6 h-6 ",l.loading()?"animate-spin":"",""),o(2),u(l.loading()?15:-1),o(),u(l.error()&&!l.loading()?16:-1),o(),u(!l.loading()&&!l.error()?17:-1))},dependencies:[I,T],styles:["@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"]})};export{A as ChatListComponent};
