import{l as p}from"./chunk-U6NWDCIK.js";import{H as s,M as d,S as b,h as n}from"./chunk-D2JNWC2G.js";import{a as l,b as c}from"./chunk-ODN5LVDJ.js";var m=class a{supabase=b(p);getClientes(){return n(this.supabase.client.from("clientes").select("*").order("created_at",{ascending:!1}).then(({data:e,error:t})=>{if(t)throw t;return e||[]}))}getClienteById(e){return n(this.supabase.client.from("clientes").select("*").eq("id",e).single().then(({data:t,error:i})=>{if(i)throw i;return t}))}createCliente(e){return n(this.supabase.getCurrentUserId()).pipe(s(t=>{let i=c(l({},e),{estado:e.estado||"activo",pais:e.pais||"Ecuador",created_by:t,updated_by:t});return n(this.supabase.client.from("clientes").insert([i]).select().single().then(({data:o,error:r})=>{if(r)throw r;return o}))}))}updateCliente(e,t){return n(this.supabase.getCurrentUserId()).pipe(s(i=>{let o=c(l({},t),{updated_by:i});return n(this.supabase.client.from("clientes").update(o).eq("id",e).select().single().then(({data:r,error:u})=>{if(u)throw u;return r}))}))}deleteCliente(e){return n(this.supabase.client.from("clientes").delete().eq("id",e).then(({error:t})=>{if(t)throw t}))}searchClientes(e){return n(this.supabase.client.from("clientes").select("*").or(`nombre.ilike.%${e}%,apellido.ilike.%${e}%,documento_numero.ilike.%${e}%,email.ilike.%${e}%`).order("created_at",{ascending:!1}).then(({data:t,error:i})=>{if(i)throw i;return t||[]}))}getClientesActivos(){return n(this.supabase.client.from("clientes").select("*").eq("estado","activo").order("nombre",{ascending:!0}).then(({data:e,error:t})=>{if(t)throw t;return e||[]}))}buscarPorDocumento(e){return n(this.supabase.client.from("clientes").select("*").eq("documento_numero",e).maybeSingle().then(({data:t,error:i})=>{if(i)throw i;return t}))}buscarOCrear(e){return this.buscarPorDocumento(e.documento_numero).pipe(s(t=>t?n(Promise.resolve(t)):this.createCliente(e)))}static \u0275fac=function(t){return new(t||a)};static \u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"})};export{m as a};
