import{a as B,b as G,c as w}from"./chunk-CO5OMKAR.js";import"./chunk-KXFMV5OZ.js";import{$ as x,Aa as M,C as H,E,Fa as V,G as o,Ha as F,J as T,Ja as O,N as u,Q as m,X as j,Y as C,Z as a,_ as t,aa as b,ba as _,ca as s,ea as n,fa as d,ga as p,u as y,w as h,wa as S,x as f,y as g,ya as D,z as v}from"./chunk-6SF67QVY.js";import"./chunk-LJ5XHLMQ.js";import{h as I}from"./chunk-FK42CRUA.js";var k=(r,i)=>i.id;function A(r,i){if(r&1){let e=b();a(0,"button",16),_("click",function(){h(e);let c=s();return f(c.editarHoja())}),g(),a(1,"svg",17),x(2,"path",18),t(),n(3," Editar "),t()}}function L(r,i){r&1&&(a(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22),x(4,"div",23)(5,"div",24)(6,"div",25),t(),a(7,"p",26),n(8,"Cargando hoja de gasto..."),t()()()())}function P(r,i){if(r&1){let e=b();a(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",27),g(),a(4,"svg",28),x(5,"path",29),t(),v(),a(6,"p",30),n(7),t()(),a(8,"button",31),_("click",function(){h(e);let c=s();return f(c.loadHojaGasto())}),n(9," Reintentar "),t()()()()}if(r&2){let e=s();o(7),d(e.error())}}function z(r,i){if(r&1&&(a(0,"p",70),n(1),t()),r&2){let e=s().$implicit;o(),p(" ",e.observaciones," ")}}function $(r,i){if(r&1&&(a(0,"div",63)(1,"div",64)(2,"div",65)(3,"h4",66),n(4),t(),a(5,"div",67)(6,"span"),n(7),t(),a(8,"span"),n(9),t()(),u(10,z,2,1,"p",68),t(),a(11,"div",69)(12,"span",41),n(13),t()()()()),r&2){let e=i.$implicit,l=s(3);o(4),d(e.descripcion||e.nombre_producto),o(3),p("Cantidad: ",e.cantidad||e.cantidad_usada,""),o(2),p("Precio Unit.: ",l.formatMoneda(e.precio_unitario),""),o(),m("ngIf",e.observaciones),o(3),d(l.formatMoneda(e.precio_total||e.subtotal||0))}}function R(r,i){if(r&1&&(a(0,"div",33)(1,"div",57)(2,"h3",58),g(),a(3,"svg",59),x(4,"path",60)(5,"path",61),t(),n(6," Productos M\xE9dicos "),t(),v(),a(7,"span",62),n(8),t()(),a(9,"div",35),j(10,$,14,5,"div",63,k),t()()),r&2){let e=s(2);o(8),d(e.formatMoneda(e.getTotalByCategory("productos"))),o(2),C(e.getItemsByCategory("productos"))}}function U(r,i){if(r&1&&(a(0,"p",70),n(1),t()),r&2){let e=s().$implicit;o(),p(" ",e.observaciones," ")}}function q(r,i){if(r&1&&(a(0,"div",74)(1,"div",64)(2,"div",65)(3,"h4",66),n(4),t(),a(5,"div",67)(6,"span"),n(7),t(),a(8,"span"),n(9),t()(),u(10,U,2,1,"p",68),t(),a(11,"div",69)(12,"span",43),n(13),t()()()()),r&2){let e=i.$implicit,l=s(3);o(4),d(e.descripcion||e.nombre_producto),o(3),p("Cantidad: ",e.cantidad||e.cantidad_usada,""),o(2),p("Precio Unit.: ",l.formatMoneda(e.precio_unitario),""),o(),m("ngIf",e.observaciones),o(3),d(l.formatMoneda(e.precio_total||e.subtotal||0))}}function J(r,i){if(r&1&&(a(0,"div",33)(1,"div",57)(2,"h3",71),g(),a(3,"svg",59),x(4,"path",72),t(),n(5," Transporte "),t(),v(),a(6,"span",73),n(7),t()(),a(8,"div",35),j(9,q,14,5,"div",74,k),t()()),r&2){let e=s(2);o(7),d(e.formatMoneda(e.getTotalByCategory("transporte"))),o(2),C(e.getItemsByCategory("transporte"))}}function K(r,i){if(r&1&&(a(0,"p",70),n(1),t()),r&2){let e=s().$implicit;o(),p(" ",e.observaciones," ")}}function Q(r,i){if(r&1&&(a(0,"div",78)(1,"div",64)(2,"div",65)(3,"h4",66),n(4),t(),a(5,"div",67)(6,"span"),n(7),t(),a(8,"span"),n(9),t()(),u(10,K,2,1,"p",68),t(),a(11,"div",69)(12,"span",45),n(13),t()()()()),r&2){let e=i.$implicit,l=s(3);o(4),d(e.descripcion||e.nombre_producto),o(3),p("Cantidad: ",e.cantidad||e.cantidad_usada,""),o(2),p("Precio Unit.: ",l.formatMoneda(e.precio_unitario),""),o(),m("ngIf",e.observaciones),o(3),d(l.formatMoneda(e.precio_total||e.subtotal||0))}}function W(r,i){if(r&1&&(a(0,"div",33)(1,"div",57)(2,"h3",75),g(),a(3,"svg",59),x(4,"path",76),t(),n(5," Otros Gastos "),t(),v(),a(6,"span",77),n(7),t()(),a(8,"div",35),j(9,Q,14,5,"div",78,k),t()()),r&2){let e=s(2);o(7),d(e.formatMoneda(e.getTotalByCategory("otros"))),o(2),C(e.getItemsByCategory("otros"))}}function X(r,i){if(r&1&&(a(0,"div",33)(1,"h3",34),n(2,"Observaciones Generales"),t(),a(3,"p",37),n(4),t()()),r&2){let e=s(2);o(4),d(e.hojaGasto().observaciones)}}function Y(r,i){if(r&1){let e=b();a(0,"button",79),_("click",function(){h(e);let c=s(2);return f(c.cambiarEstado("aprobada"))}),n(1," Marcar como Aprobada "),t()}}function Z(r,i){if(r&1){let e=b();a(0,"button",80),_("click",function(){h(e);let c=s(2);return f(c.editarHoja())}),n(1," Editar Hoja de Gasto "),t()}}function ee(r,i){if(r&1&&(a(0,"main",19)(1,"div",32)(2,"div",33)(3,"h3",34),n(4,"Informaci\xF3n General"),t(),a(5,"div",35)(6,"div",36)(7,"span",37),n(8,"Estado:"),t(),a(9,"span",38),n(10),t()(),a(11,"div",36)(12,"span",37),n(13,"N\xFAmero de Hoja:"),t(),a(14,"span",39),n(15),t()(),a(16,"div",36)(17,"span",37),n(18,"Fecha Cirug\xEDa:"),t(),a(19,"span",39),n(20),t()(),a(21,"div",36)(22,"span",37),n(23,"Cliente:"),t(),a(24,"span",39),n(25),t()(),a(26,"div",36)(27,"span",37),n(28,"T\xE9cnico:"),t(),a(29,"span",39),n(30),t()(),a(31,"div",36)(32,"span",37),n(33,"Total Items:"),t(),a(34,"span",39),n(35),t()()()(),a(36,"div",33)(37,"h3",34),n(38,"Resumen de Totales"),t(),a(39,"div",35)(40,"div",36)(41,"span",40),n(42,"Productos M\xE9dicos:"),t(),a(43,"span",41),n(44),t()(),a(45,"div",36)(46,"span",42),n(47,"Transporte:"),t(),a(48,"span",43),n(49),t()(),a(50,"div",36)(51,"span",44),n(52,"Otros:"),t(),a(53,"span",45),n(54),t()(),x(55,"hr",46),a(56,"div",36)(57,"span",47),n(58,"Total General:"),t(),a(59,"span",47),n(60),t()()()(),a(61,"div",48),u(62,R,12,1,"div",49)(63,J,11,1,"div",49)(64,W,11,1,"div",49),t(),u(65,X,5,1,"div",49),a(66,"div",33)(67,"h3",34),n(68,"Acciones"),t(),a(69,"div",50),u(70,Y,2,0,"button",51)(71,Z,2,0,"button",52),t()(),a(72,"div",33)(73,"h3",34),n(74,"Informaci\xF3n de Fechas"),t(),a(75,"div",53)(76,"div",54)(77,"span",55),n(78,"Creada:"),t(),a(79,"span",56),n(80),t()(),a(81,"div",54)(82,"span",55),n(83,"\xDAltima actualizaci\xF3n:"),t(),a(84,"span",56),n(85),t()()()()()()),r&2){let e=s();o(9),m("ngClass",e.getEstadoInfo(e.hojaGasto().estado).color),o(),p(" ",e.getEstadoInfo(e.hojaGasto().estado).label," "),o(5),d(e.hojaGasto().numero_hoja),o(5),d(e.formatFechaCorta(e.hojaGasto().fecha_cirugia)),o(5),d(e.clienteNombre()),o(5),d(e.tecnicoNombre()),o(5),d(e.totalItems()),o(9),d(e.formatMoneda(e.hojaGasto().total_productos)),o(5),d(e.formatMoneda(e.hojaGasto().total_transporte)),o(5),d(e.formatMoneda(e.hojaGasto().total_otros)),o(6),d(e.formatMoneda(e.hojaGasto().total_general)),o(2),m("ngIf",e.getItemsByCategory("productos").length>0),o(),m("ngIf",e.getItemsByCategory("transporte").length>0),o(),m("ngIf",e.getItemsByCategory("otros").length>0),o(),m("ngIf",e.hojaGasto().observaciones),o(5),m("ngIf",e.canComplete()),o(),m("ngIf",e.canEdit()),o(9),d(e.formatFecha(e.hojaGasto().created_at)),o(5),d(e.formatFecha(e.hojaGasto().updated_at))}}var N=class r{router=y(O);route=y(F);hojaGastoService=y(B);loading=E(!1);error=E(null);hojaGasto=E(null);hojaId=H(null);totalItems=S(()=>(this.hojaGasto()?.items||this.hojaGasto()?.hoja_gasto_items||[]).length);clienteNombre=S(()=>"N/A");tecnicoNombre=S(()=>"N/A");ESTADOS_CONFIG=G;CATEGORIAS_CONFIG=w;ngOnInit(){this.loadHojaGasto()}loadHojaGasto(){return I(this,null,function*(){let i=this.route.snapshot.paramMap.get("id");if(!i){this.error.set("ID de hoja de gasto no v\xE1lido");return}this.loading.set(!0),this.error.set(null);try{this.hojaGastoService.getHojaGasto(i).subscribe({next:e=>{e?this.hojaGasto.set(e):this.error.set("Hoja de gasto no encontrada"),this.loading.set(!1)},error:e=>{console.error("Error cargando hoja de gasto:",e),this.error.set("Error al cargar la hoja de gasto. Por favor, int\xE9ntelo de nuevo."),this.loading.set(!1)}})}catch(e){console.error("Error in loadHojaGasto:",e),this.error.set("Error inesperado al cargar la hoja de gasto."),this.loading.set(!1)}})}cambiarEstado(i){return I(this,null,function*(){let e=this.hojaGasto();if(e)try{this.hojaGastoService.cambiarEstado(e.id,i).subscribe({next:l=>{this.hojaGasto.set(l)},error:l=>{console.error("Error cambiando estado:",l),this.error.set("Error al cambiar el estado. Por favor, int\xE9ntelo de nuevo.")}})}catch(l){console.error("Error in cambiarEstado:",l),this.error.set("Error inesperado al cambiar el estado.")}})}editarHoja(){let i=this.hojaGasto();i&&this.router.navigate(["/internal/hojas-gasto/edit",i.id])}volver(){this.router.navigate(["/internal/hojas-gasto"])}getEstadoInfo(i){return G[i]||{label:i,color:"bg-gray-100 text-gray-800"}}getCategoriaInfo(i){return w[i]||{label:i,color:"text-gray-600"}}formatMoneda(i){return new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(i)}formatFecha(i){return new Date(i).toLocaleDateString("es-CO",{year:"numeric",month:"long",day:"numeric"})}formatFechaCorta(i){return new Date(i).toLocaleDateString("es-CO",{year:"numeric",month:"2-digit",day:"2-digit"})}getItemsByCategory(i){return(this.hojaGasto()?.items||this.hojaGasto()?.hoja_gasto_items||[]).filter(l=>l.categoria===i)}getTotalByCategory(i){return this.getItemsByCategory(i).reduce((e,l)=>{let c=l.subtotal||l.precio_total||0;return e+c},0)}canEdit(){let i=this.hojaGasto();return i?.estado==="borrador"||i?.estado==="revision"}canValidate(){return this.hojaGasto()?.estado==="aprobada"}canComplete(){let i=this.hojaGasto();return i?.estado==="borrador"||i?.estado==="revision"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=T({type:r,selectors:[["app-hoja-gasto-detail"]],inputs:{hojaId:[1,"hojaId"]},decls:22,vars:5,consts:[[1,"bg-gray-50","dark:bg-gray-900","min-h-screen"],[1,"bg-gradient-to-r","from-green-600","to-emerald-700","text-white","shadow-lg"],[1,"px-4","py-4"],[1,"flex","justify-between","items-center","mb-3"],[1,"flex","items-center","space-x-3"],["src","https://www.implameq.com/wp-content/uploads/logotipo-impla-300x78.png.webp","alt","Implameq",1,"h-8","brightness-0","invert"],[1,"text-lg","font-semibold"],[1,"flex","items-center","space-x-2"],["class","bg-white/20 hover:bg-white/30 text-white px-3 py-2 rounded-lg text-xs font-medium transition duration-200 shadow-md backdrop-blur-sm",3,"click",4,"ngIf"],[1,"bg-white/20","hover:bg-white/30","text-white","px-3","py-2","rounded-lg","text-sm","font-medium","transition","duration-200","shadow-md","backdrop-blur-sm",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"text-center"],[1,"text-2xl","font-bold","mb-1"],[1,"text-green-100","text-sm"],["class","px-4 py-6",4,"ngIf"],[1,"bg-white/20","hover:bg-white/30","text-white","px-3","py-2","rounded-lg","text-xs","font-medium","transition","duration-200","shadow-md","backdrop-blur-sm",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"px-4","py-6"],[1,"max-w-lg","mx-auto"],[1,"bg-white","rounded-xl","shadow-md","dark:bg-gray-800","p-6","text-center"],[1,"animate-pulse","space-y-4"],[1,"h-4","bg-gray-200","rounded","w-3/4","mx-auto"],[1,"h-4","bg-gray-200","rounded","w-1/2","mx-auto"],[1,"h-4","bg-gray-200","rounded","w-2/3","mx-auto"],[1,"text-sm","text-gray-500","mt-4"],[1,"text-red-600","dark:text-red-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-sm"],["type","button",1,"mt-4","w-full","text-white","bg-red-600","hover:bg-red-700","focus:ring-4","focus:outline-none","focus:ring-red-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center",3,"click"],[1,"max-w-lg","mx-auto","space-y-6"],[1,"bg-white","rounded-xl","shadow-md","dark:bg-gray-800","p-4"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white","mb-4"],[1,"space-y-3"],[1,"flex","justify-between","items-center"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"inline-flex","px-2","py-1","text-xs","font-semibold","rounded-full",3,"ngClass"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-blue-600","font-medium"],[1,"font-semibold","text-blue-600"],[1,"text-sm","text-green-600","font-medium"],[1,"font-semibold","text-green-600"],[1,"text-sm","text-gray-600","font-medium"],[1,"font-semibold","text-gray-600"],[1,"border-gray-200","dark:border-gray-600"],[1,"text-lg","font-bold","text-gray-900","dark:text-white"],[1,"space-y-4"],["class","bg-white rounded-xl shadow-md dark:bg-gray-800 p-4",4,"ngIf"],[1,"flex","flex-col","space-y-2"],["class","w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition duration-200",3,"click",4,"ngIf"],["class","w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition duration-200",3,"click",4,"ngIf"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600","dark:text-gray-400"],[1,"text-gray-900","dark:text-white"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-lg","font-semibold","text-blue-600"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","inline","mr-2"],["d","M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"],["fill-rule","evenodd","d","M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6.586A2 2 0 0117.414 13L16 14.414V17a2 2 0 01-2 2H6a2 2 0 01-2-2v-2.586L2.586 13A2 2 0 012 11.414V5z","clip-rule","evenodd"],[1,"text-sm","font-semibold","text-blue-600"],[1,"p-3","bg-blue-50","dark:bg-blue-900/20","rounded-lg","border","border-blue-200","dark:border-blue-800"],[1,"flex","justify-between","items-start"],[1,"flex-1"],[1,"font-medium","text-gray-900","dark:text-white"],[1,"flex","items-center","space-x-4","mt-1","text-sm","text-gray-600","dark:text-gray-400"],["class","text-xs text-gray-500 dark:text-gray-400 mt-1",4,"ngIf"],[1,"text-right"],[1,"text-xs","text-gray-500","dark:text-gray-400","mt-1"],[1,"text-lg","font-semibold","text-green-600"],["fill-rule","evenodd","d","M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z","clip-rule","evenodd"],[1,"text-sm","font-semibold","text-green-600"],[1,"p-3","bg-green-50","dark:bg-green-900/20","rounded-lg","border","border-green-200","dark:border-green-800"],[1,"text-lg","font-semibold","text-gray-600"],["fill-rule","evenodd","d","M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"text-sm","font-semibold","text-gray-600"],[1,"p-3","bg-gray-50","dark:bg-gray-900/20","rounded-lg","border","border-gray-200","dark:border-gray-800"],[1,"w-full","bg-green-600","hover:bg-green-700","text-white","px-4","py-2","rounded-lg","font-medium","transition","duration-200",3,"click"],[1,"w-full","bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","font-medium","transition","duration-200",3,"click"]],template:function(e,l){if(e&1&&(a(0,"section",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4),x(5,"img",5),a(6,"span",6),n(7,"Detalle de Hoja de Gasto"),t()(),a(8,"div",7),u(9,A,4,0,"button",8),a(10,"button",9),_("click",function(){return l.volver()}),g(),a(11,"svg",10),x(12,"path",11),t(),n(13," Volver "),t()()(),v(),a(14,"div",12)(15,"h1",13),n(16),t(),a(17,"p",14),n(18,"Detalle completo de la hoja de gasto"),t()()()(),u(19,L,9,0,"div",15)(20,P,10,1,"div",15)(21,ee,86,19,"main",15),t()),e&2){let c;o(9),m("ngIf",l.canEdit()),o(7),d(((c=l.hojaGasto())==null?null:c.numero_hoja)||"Cargando..."),o(3),m("ngIf",l.loading()),o(),m("ngIf",!l.loading()&&l.error()),o(),m("ngIf",!l.loading()&&!l.error()&&l.hojaGasto())}},dependencies:[V,D,M],encapsulation:2})};export{N as HojaGastoDetailComponent};
